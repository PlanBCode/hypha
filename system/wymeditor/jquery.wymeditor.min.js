(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],function($){return factory($)})}else if(typeof module==="object"&&typeof module.exports==="object"){module.exports=factory(require("jquery"))}else{factory(window.jQuery)}})(function(jQuery){"use strict";function uaMatch(ua){if(ua===undefined){ua=window.navigator.userAgent}ua=ua.toLowerCase();var match=/(edge)\/([\w.]+)/.exec(ua)||/(opr)[\/]([\w.]+)/.exec(ua)||/(chrome)[ \/]([\w.]+)/.exec(ua)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];var platform_match=/(ipad)/.exec(ua)||/(ipod)/.exec(ua)||/(iphone)/.exec(ua)||/(kindle)/.exec(ua)||/(silk)/.exec(ua)||/(android)/.exec(ua)||/(windows phone)/.exec(ua)||/(win)/.exec(ua)||/(mac)/.exec(ua)||/(linux)/.exec(ua)||/(cros)/.exec(ua)||/(playbook)/.exec(ua)||/(bb)/.exec(ua)||/(blackberry)/.exec(ua)||[];var browser={},matched={browser:match[5]||match[3]||match[1]||"",version:match[2]||match[4]||"0",versionNumber:match[4]||match[2]||"0",platform:platform_match[0]||""};if(matched.browser){browser[matched.browser]=true;browser.version=matched.version;browser.versionNumber=parseInt(matched.versionNumber,10)}if(matched.platform){browser[matched.platform]=true}if(browser.android||browser.bb||browser.blackberry||browser.ipad||browser.iphone||browser.ipod||browser.kindle||browser.playbook||browser.silk||browser["windows phone"]){browser.mobile=true}if(browser.cros||browser.mac||browser.linux||browser.win){browser.desktop=true}if(browser.chrome||browser.opr||browser.safari){browser.webkit=true}if(browser.rv||browser.edge){var ie="msie";matched.browser=ie;browser[ie]=true}if(browser.safari&&browser.blackberry){var blackberry="blackberry";matched.browser=blackberry;browser[blackberry]=true}if(browser.safari&&browser.playbook){var playbook="playbook";matched.browser=playbook;browser[playbook]=true}if(browser.bb){var bb="blackberry";matched.browser=bb;browser[bb]=true}if(browser.opr){var opera="opera";matched.browser=opera;browser[opera]=true}if(browser.safari&&browser.android){var android="android";matched.browser=android;browser[android]=true}if(browser.safari&&browser.kindle){var kindle="kindle";matched.browser=kindle;browser[kindle]=true}if(browser.safari&&browser.silk){var silk="silk";matched.browser=silk;browser[silk]=true}browser.name=matched.browser;browser.platform=matched.platform;return browser}window.jQBrowser=uaMatch(window.navigator.userAgent);window.jQBrowser.uaMatch=uaMatch;if(jQuery){jQuery.browser=window.jQBrowser}return window.jQBrowser});if(typeof WYMeditor==="undefined"){var WYMeditor={}}(function(){if(typeof window.console==="undefined"&&typeof console==="undefined"){var names=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"],noOp=function(){},i;WYMeditor.console={};for(i=0;i<names.length;i+=1){WYMeditor.console[names[i]]=noOp}}else if(typeof console!=="undefined"){WYMeditor.console=console}else if(window.console.firebug){WYMeditor.console=window.console}else if(window.console){WYMeditor.console=window.console}})();jQuery.extend(WYMeditor,{A:"a",ALT:"alt",BLOCKQUOTE:"blockquote",BODY:"body",CLASS:"class",CLASSES:"{Wym_Classes}",CLASSES_ITEMS:"{Wym_Classes_Items}",CLASS_NAME:"{Wym_Class_Name}",CLASS_TITLE:"{Wym_Class_Title}",CONTAINERS:"{Wym_Containers}",CONTAINERS_ITEMS:"{Wym_Containers_Items}",CONTAINER_CLASS:"{Wym_Container_Class}",CONTAINER_NAME:"{Wym_Container_Name}",CONTAINER_TITLE:"{Wym_Containers_Title}",DIRECTION:"{Wym_Direction}",DIV:"div",H1:"h1",H2:"h2",H3:"h3",H4:"h4",H5:"h5",H6:"h6",HREF:"href",HTML:"{Wym_Html}",IFRAME:"{Wym_Iframe}",IFRAME_BASE_PATH:"{Wym_Iframe_Base_Path}",IFRAME_DEFAULT:"iframe/default/",IMG:"img",INSERT_HTML:"InsertHTML",INSTANCES:[],JQUERY_PATH:"{Wym_Jquery_Path}",LI:"li",LOGO:"{Wym_Logo}",NAME:"name",NBSP:"Â ",NEWLINE:"\n",OL:"ol",P:"p",PRE:"pre",REL:"rel",SKINS:[],SRC:"src",STATUS:"{Wym_Status}",STRING:"string",STRINGS:[],TABLE:"table",TD:"td",TH:"th",TITLE:"title",TOOLS:"{Wym_Tools}",TOOLS_ITEMS:"{Wym_Tools_Items}",TOOL_CLASS:"{Wym_Tool_Class}",TOOL_NAME:"{Wym_Tool_Name}",TOOL_TITLE:"{Wym_Tool_Title}",TR:"tr",UL:"ul",VERSION:"1.1.1",WYM_INDEX:"wym_index",WYM_PATH:"{Wym_Wym_Path}",EXEC_COMMANDS:{BOLD:"Bold",ITALIC:"Italic",SUPERSCRIPT:"Superscript",SUBSCRIPT:"Subscript",CREATE_LINK:"CreateLink",UNLINK:"Unlink",FORMAT_BLOCK:"FormatBlock",INSERT_IMAGE:"InsertImage",UNDO:"Undo",REDO:"Redo",INSERT_LINEBREAK:"InsertLineBreak",INSERT_ORDEREDLIST:"InsertOrderedList",INSERT_UNORDEREDLIST:"InsertUnorderedList",INDENT:"Indent",OUTDENT:"Outdent",TOGGLE_HTML:"ToggleHtml"},ROOT_CONTAINERS:["macro","blockquote","div","h1","h2","h3","h4","h5","h6","p","pre"],FORBIDDEN_ROOT_CONTAINERS:["a","b","em","i","span","strong","sub","sup"],BLOCKS:["macro","address","blockquote","dd","div","dl","dt","fieldset","form","h1","h2","h3","h4","h5","h6","hr","li","noscript","ol","p","pre","table","tbody","td","tfoot","th","thead","tr","ul"],BLOCKING_ELEMENTS:["blockquote","pre","table"],NON_CONTAINING_ELEMENTS:["macro","br","col","hr","img"],NO_CARET_ELEMENTS:["blockquote","br","col","colgroup","dl","hr","img","ol","table","tbody","tfoot","thead","tr","ul"],INLINE_ELEMENTS:["a","abbr","acronym","b","bdo","big","br","button","cite","code","dfn","em","i","img","input","kbd","label","map","object","q","samp","script","select","small","span","strong","sub","sup","textarea","tt","var"],NON_BLOCKING_ELEMENTS:["div","h1","h2","h3","h4","h5","h6","p"],LIST_TYPE_ELEMENTS:["ol","ul"],HEADING_ELEMENTS:["h1","h2","h3","h4","h5","h6"],POTENTIAL_LIST_ELEMENTS:["blockquote","div","h1","h2","h3","h4","h5","h6","p","pre","td"],POTENTIAL_TABLE_INSERT_ELEMENTS:["blockquote","div","h1","h2","h3","h4","h5","h6","li","p","pre"],INLINE_TABLE_INSERTION_ELEMENTS:["li"],SELECTABLE_TABLE_ELEMENTS:["caption","td","th"],BLOCKING_ELEMENT_SPACER_CLASS:"wym-blocking-element-spacer",EDITOR_ONLY_CLASS:"wym-editor-only",RESIZE_HANDLE_CLASS:"wym-resize-handle",CLASSES_REMOVED_BY_PARSER:["apple-style-span"],KEY_CODE:{B:66,BACKSPACE:8,COMMAND:224,CTRL:17,CURSOR:[37,38,39,40],DELETE:46,DOWN:40,END:35,ENTER:13,HOME:36,I:73,LEFT:37,R:82,RIGHT:39,TAB:9,UP:38},POTENTIAL_BLOCK_ELEMENT_CREATION_KEYS:[8,13,37,38,39,40,46],EVENTS:{postBlockMaybeCreated:"wym-postBlockMaybeCreated",postIframeInitialization:"wym-postIframeInitialization",postModification:"wym-postModification",postUndo:"wym-postUndo",postRedo:"wym-postRedo"},NODE_TYPE:{ELEMENT:1,ATTRIBUTE:2,TEXT:3},editor:function(elem,options){if(jQuery.getWymeditorByTextarea(elem[0])){throw"It seems that this textarea already belongs to a "+"WYMeditor instance."}var wym=this;wym._index=WYMeditor.INSTANCES.push(wym)-1;wym.element=elem;wym._options=options;wym._options.wymPath=wym._options.wymPath||WYMeditor._computeWymPath();wym._options.basePath=wym._options.basePath||WYMeditor._computeBasePath(wym._options.wymPath);wym._options.iframeBasePath=wym._options.iframeBasePath||wym._options.basePath+WYMeditor.IFRAME_DEFAULT;wym._init()},EXTERNAL_MODULES:{}});jQuery.fn.wymeditor=function(options){var $textareas=this;options=jQuery.extend({html:"",basePath:false,wymPath:false,iframeBasePath:false,jQueryPath:false,skin:"default",lang:"en",direction:"ltr",customCommands:[],structureRules:{defaultRootContainer:"p"},boxHtml:String()+"<div class='wym_box'>"+"<div class='wym_area_top'>"+WYMeditor.TOOLS+"</div>"+"<div class='wym_area_left'></div>"+"<div class='wym_area_right'>"+WYMeditor.CONTAINERS+WYMeditor.CLASSES+"</div>"+"<div class='wym_area_main'>"+WYMeditor.HTML+WYMeditor.IFRAME+WYMeditor.STATUS+"</div>"+"<div class='wym_area_bottom'>"+WYMeditor.LOGO+"</div>"+"</div>",logoHtml:String()+'<a class="wym_wymeditor_link" '+'href="http://www.wymeditor.org/">WYMeditor</a>',iframeHtml:String()+'<div class="wym_iframe wym_section">'+'<iframe src="'+WYMeditor.IFRAME_BASE_PATH+'wymiframe.html">'+"</iframe>"+"</div>",toolsHtml:String()+'<div class="wym_tools wym_section">'+"<h2>{Tools}</h2>"+"<ul>"+WYMeditor.TOOLS_ITEMS+"</ul>"+"</div>",toolsItemHtml:String()+'<li class="'+WYMeditor.TOOL_CLASS+'">'+'<a href="#" name="'+WYMeditor.TOOL_NAME+'" '+'title="'+WYMeditor.TOOL_TITLE+'">'+WYMeditor.TOOL_TITLE+"</a>"+"</li>",toolsItems:[{name:"Bold",title:"Strong",css:"wym_tools_strong"},{name:"Italic",title:"Emphasis",css:"wym_tools_emphasis"},{name:"Superscript",title:"Superscript",css:"wym_tools_superscript"},{name:"Subscript",title:"Subscript",css:"wym_tools_subscript"},{name:"InsertOrderedList",title:"Ordered_List",css:"wym_tools_ordered_list"},{name:"InsertUnorderedList",title:"Unordered_List",css:"wym_tools_unordered_list"},{name:"Indent",title:"Indent",css:"wym_tools_indent"},{name:"Outdent",title:"Outdent",css:"wym_tools_outdent"},{name:"Undo",title:"Undo",css:"wym_tools_undo"},{name:"Redo",title:"Redo",css:"wym_tools_redo"},{name:"CreateLink",title:"Link",css:"wym_tools_link wym_opens_dialog"},{name:"Unlink",title:"Unlink",css:"wym_tools_unlink"},{name:"InsertImage",title:"Image",css:"wym_tools_image wym_opens_dialog"},{name:"InsertTable",title:"Table",css:"wym_tools_table wym_opens_dialog"},{name:"Paste",title:"Paste_From_Word",css:"wym_tools_paste wym_opens_dialog"},{name:"ToggleHtml",title:"HTML",css:"wym_tools_html"},{name:"Preview",title:"Preview",css:"wym_tools_preview wym_opens_dialog"}],containersHtml:String()+'<div class="wym_containers wym_section">'+"<h2>{Containers}</h2>"+"<ul>"+WYMeditor.CONTAINERS_ITEMS+"</ul>"+"</div>",containersItemHtml:String()+'<li class="'+WYMeditor.CONTAINER_CLASS+'">'+'<a href="#" name="'+WYMeditor.CONTAINER_NAME+'">'+WYMeditor.CONTAINER_TITLE+"</a>"+"</li>",containersItems:[{name:"P",title:"Paragraph",css:"wym_containers_p"},{name:"H1",title:"Heading_1",css:"wym_containers_h1"},{name:"H2",title:"Heading_2",css:"wym_containers_h2"},{name:"H3",title:"Heading_3",css:"wym_containers_h3"},{name:"H4",title:"Heading_4",css:"wym_containers_h4"},{name:"H5",title:"Heading_5",css:"wym_containers_h5"},{name:"H6",title:"Heading_6",css:"wym_containers_h6"},{name:"PRE",title:"Preformatted",css:"wym_containers_pre"},{name:"BLOCKQUOTE",title:"Blockquote",css:"wym_containers_blockquote"},{name:"TH",title:"Table_Header",css:"wym_containers_th"}],classesHtml:String()+'<div class="wym_classes wym_section">'+"<h2>{Classes}</h2>"+"<ul>"+WYMeditor.CLASSES_ITEMS+"</ul>"+"</div>",classesItemHtml:String()+'<li class="wym_classes_'+WYMeditor.CLASS_NAME+'">'+'<a href="#" name="'+WYMeditor.CLASS_NAME+'">'+WYMeditor.CLASS_TITLE+"</a>"+"</li>",classesItems:[],statusHtml:String()+'<div class="wym_status wym_section">'+"<h2>{Status}</h2>"+"</div>",htmlHtml:String()+'<div class="wym_html wym_section">'+"<h2>{Source_Code}</h2>"+'<textarea class="wym_html_val"></textarea>'+"</div>",boxSelector:".wym_box",toolsSelector:".wym_tools",toolsListSelector:" ul",containersSelector:".wym_containers",classesSelector:".wym_classes",htmlSelector:".wym_html",iframeSelector:".wym_iframe iframe",iframeBodySelector:".wym_iframe",statusSelector:".wym_status",toolSelector:".wym_tools a",containerSelector:".wym_containers a",classSelector:".wym_classes a",htmlValSelector:".wym_html_val",updateSelector:".wymupdate",updateEvent:"click",stringDelimiterLeft:"{",stringDelimiterRight:"}",preInit:null,preBind:null,postInit:null},options);options=jQuery.extend(WYMeditor.DEFAULT_DIALOG_OPTIONS,options);return $textareas.each(function(){var textarea=this;textarea._wym=new WYMeditor.editor(jQuery(textarea),options)})};jQuery.extend({wymeditors:function(i){return WYMeditor.INSTANCES[i]}});jQuery.extend({getWymeditorByTextarea:function(textarea){var i;if(!(textarea&&textarea.tagName&&textarea.tagName.toLowerCase()==="textarea")){throw"jQuery.getWymeditorByTextarea requires a textarea element."}for(i=0;i<WYMeditor.INSTANCES.length;i++){if(textarea===WYMeditor.INSTANCES[i].element[0]){return WYMeditor.INSTANCES[i]}}return false}});jQuery.extend({copyPropsFromObjectToObject:function(origin,target,propNames){var i,propName,prop,props={};for(i=0;i<propNames.length;i++){propName=propNames[i];prop=origin[propName];props[propName]=prop}jQuery.extend(target,props)}});WYMeditor.isInternetExplorerPre11=function(){if(jQuery.browser.msie&&jQuery.browser.versionNumber<11){return true}return false};WYMeditor.isInternetExplorer11OrNewer=function(){if(jQuery.browser.msie&&jQuery.browser.versionNumber>=11){return true}return false};WYMeditor._computeWymPath=function(){var script=jQuery(jQuery.grep(jQuery("script"),function(s){if(!s.src){return null}return s.src.match(/jquery\.wymeditor(\.pack|\.min|\.packed)?\.js(\?.*)?$/)||s.src.match(/\/core\.js(\?.*)?$/)}));if(script.length>0){return script.attr("src")}WYMeditor.console.warn("Error determining wymPath. No base WYMeditor file located.");WYMeditor.console.warn("Assuming wymPath to be the current URL");WYMeditor.console.warn("Please pass a correct wymPath option");return""};WYMeditor._computeBasePath=function(wymPath){var lastSlashIndex=wymPath.lastIndexOf("/");return wymPath.substr(0,lastSlashIndex+1)};jQuery.fn.isPhantomNode=function(){var $nodes=this;if($nodes[0].nodeType===WYMeditor.NODE_TYPE.TEXT){return!/[^\t\n\r ]/.test($nodes[0].data)}return false};jQuery.fn.nextContentsUntil=function(selector,filter){var $nodes=this,matched=[],$matched,cur=$nodes.get(0);selector=selector?selector:"";filter=filter?filter:"";if(!cur){return jQuery()}cur=cur.nextSibling;while(cur){if(!jQuery(cur).is(selector)){matched.push(cur);cur=cur.nextSibling}else{break}}$matched=jQuery(matched);if(filter){return $matched.filter(filter)}return $matched};jQuery.fn.nextAllContents=function(){var $nodes=this;return jQuery($nodes).nextContentsUntil("","")};jQuery.fn.prevContentsUntil=function(selector,filter){var $nodes=this,matched=[],$matched,cur=$nodes.get(0);selector=selector?selector:"";filter=filter?filter:"";if(!cur){return jQuery()}cur=cur.previousSibling;while(cur){if(!jQuery(cur).is(selector)){matched.push(cur);cur=cur.previousSibling}else{break}}$matched=jQuery(matched);if(filter){return $matched.filter(filter)}return $matched};jQuery.fn.prevAllContents=function(){var $nodes=this;return jQuery($nodes).prevContentsUntil("","")};WYMeditor.isPhantomNode=function(n){if(n.nodeType===WYMeditor.NODE_TYPE.TEXT){return!/[^\t\n\r ]/.test(n.data)}return false};WYMeditor.isPhantomString=function(str){return!/[^\t\n\r ]/.test(str)};jQuery.fn.addBack=jQuery.fn.addBack?jQuery.fn.addBack:jQuery.fn.andSelf;jQuery.fn.parentsOrSelf=function(selector){var $n=this;if(selector){return $n.parents().addBack().filter(selector)}else{return $n.parents().addBack()}};WYMeditor.Helper={replaceAllInStr:function(str,old,rep){var rExp=new RegExp(old,"g");return str.replace(rExp,rep)},insertAt:function(str,inserted,pos){return str.substr(0,pos)+inserted+str.substring(pos)},trim:function(str){return str.replace(/^(\s*)|(\s*)$/gm,"")},arrayContains:function(arr,elem){var i;for(i=0;i<arr.length;i+=1){if(arr[i]===elem){return true}}return false},indexOf:function(arr,item){var ret=-1,i;for(i=0;i<arr.length;i+=1){if(arr[i]===item){ret=i;break}}return ret},_getFromArrayByName:function(arr,name){var i,item;for(i=0;i<arr.length;i+=1){item=arr[i];if(item.name===name){return item}}return null},getAllEventTypes:function(elem){var result=[];for(var key in elem){if(key.indexOf("on")===0&&key!=="onmousemove"){result.push(key.slice(2))}}return result.join(" ")}};WYMeditor._getWymClassForBrowser=function(){switch(jQuery.browser.name){case"msie":if(WYMeditor.isInternetExplorerPre11()){return WYMeditor.WymClassTridentPre7}else if(WYMeditor.isInternetExplorer11OrNewer()){return WYMeditor.WymClassTrident7}else{return false}break;case"mozilla":return WYMeditor.WymClassGecko;case"chrome":return WYMeditor.WymClassBlink;case"safari":return WYMeditor.WymClassSafari}if(jQuery.browser.webkit){return WYMeditor.WymClassWebKit}WYMeditor.console.warn("WYMeditor could not instantiate: this browser "+"is not supported");return false};"use strict";WYMeditor.editor.prototype._openPopupWindow=function(windowFeatures){var wym=this,popup,basePath=wym._options.basePath;popup=window.open(jQuery.browser.msie?basePath+"popup.html":"","wymPopupWindow",windowFeatures);return popup};WYMeditor.editor.prototype.dialog=function(dialog,pDialogWindowFeatures,pBodyHtml){var wym=this,i,DIALOGS=WYMeditor.DIALOGS,dialogObject,dialogWindowFeatures,wDialog,htmlStrReplacements,dialogHtml,doc,selectedContainer,options=wym._options;if(jQuery.isPlainObject(dialog)){dialogObject=dialog}else if(typeof dialog==="string"&&DIALOGS.hasOwnProperty(dialog)){WYMeditor.console.warn("DEPRECATION WARNING: `dialog` method "+"received a string dialog name. Please provide a dialog object "+"instead.");dialogObject=DIALOGS[dialog]}if(jQuery.isPlainObject(dialogObject)!==true&&typeof pBodyHtml!=="string"){throw"`dialog` method: No dialog provided"}if(dialogObject){if(dialogObject.hasOwnProperty("title")!==true||dialogObject.hasOwnProperty("shouldOpen")!==true||dialogObject.hasOwnProperty("getBodyHtml")!==true){throw"Expected the dialog object to contain at least `title`, "+"`shouldOpen` and `getbodyHtml`"}}if(dialogObject&&dialogObject.shouldOpen.call(wym)!==true){return false}if(wym.opened_dialog)wym.opened_dialog.close();dialogHtml=pBodyHtml||dialogObject.getBodyHtml.call(wym);dialogHtml=wym.replaceStrings(dialogHtml);dialogHtml='<div class="wym_dialog">'+dialogHtml+"</div>";dialog=jQuery(dialogHtml).insertAfter(wym.element);if(dialogObject&&dialogObject.getBodyClass){jQuery(dialog).addClass(dialogObject.getBodyClass.call(wym))}wDialog=wym.opened_dialog={close:function(){dialog.remove();wym.opened_dialog=undefined}};if(jQuery.isFunction(options.preInitDialog)){options.preInitDialog(wym,wDialog)}if(dialogObject&&dialogObject.initialize){dialogObject.initialize.call(wym,wDialog)}if(dialogObject&&dialogObject.submitHandler){jQuery("form.wym_dialog_submit",dialog).submit(function(){dialogObject.submitHandler.call(wym,wDialog)})}jQuery(options.cancelSelector,dialog).click(function(){wDialog.close();wym.focusOnDocument()});if(jQuery.isFunction(options.postInitDialog)){options.postInitDialog(wym,wDialog)}return wDialog};WYMeditor.DIALOGS={CreateLink:{title:"Link",shouldOpen:function(){var wym=this,selectedContainer;if(wym.hasSelection()!==true){return false}selectedContainer=wym.selectedContainer();if(selectedContainer===false){return false}if(wym.selection().isCollapsed&&selectedContainer.tagName.toLowerCase()!=="a"){return false}return true},getBodyHtml:function(){var wym=this;return wym._options.dialogLinkHtml||String()+'<form class="wym_dialog_submit">'+"<fieldset>"+'<input type="hidden" class="wym_dialog_type" '+'value="'+WYMeditor.DIALOG_LINK+'" />'+"<legend>{Link}</legend>"+'<div class="row">'+"<label>{URL}</label>"+'<input type="text" class="wym_href" '+'value="" size="40" '+'autofocus="autofocus" />'+"</div>"+'<div class="row">'+"<label>{Title}</label>"+'<input type="text" class="wym_title" '+'value="" size="40" />'+"</div>"+'<div class="row">'+"<label>{Relationship}</label>"+'<input type="text" class="wym_rel" '+'value="" size="40" />'+"</div>"+'<div class="row row-indent">'+'<input class="wym_submit" type="submit" '+'value="{Submit}" />'+'<input class="wym_cancel" type="button" '+'value="{Cancel}" />'+"</div>"+"</fieldset>"+"</form>"},getBodyClass:function(){var wym=this;return wym._options.dialogSelectorLink||"wym_dialog_link"},initialize:function(wDialog){var wym=this,doc=wDialog.document,options=wym._options,selectedContainer=wym.selectedContainer(),$hrefInput,$titleInput,$relInput,currentHref,currentTitle,currentRel;if(!selectedContainer){return}$hrefInput=jQuery(options.hrefSelector,doc);$titleInput=jQuery(options.titleSelector,doc);$relInput=jQuery(options.relSelector,doc);currentHref=jQuery(selectedContainer).attr(WYMeditor.HREF);currentTitle=jQuery(selectedContainer).attr(WYMeditor.TITLE);currentRel=jQuery(selectedContainer).attr(WYMeditor.REL);$hrefInput.val(currentHref);$titleInput.val(currentTitle);$relInput.val(currentRel)},submitHandler:function(wDialog){var wym=this,options=wym._options,href=jQuery(options.hrefSelector,wDialog.document).val(),title=jQuery(options.titleSelector,wDialog.document).val(),rel=jQuery(options.relSelector,wDialog.document).val();wym.link({href:href,title:title,rel:rel});wDialog.close()}},InsertImage:{title:"Image",shouldOpen:function(){var wym=this,selectedImage=wym.getSelectedImage();if(selectedImage&&selectedImage.tagName&&selectedImage.tagName.toLowerCase()==="img"){return true}return wym.hasSelection()},getBodyHtml:function(){var wym=this;return wym._options.dialogImageHtml||String()+'<form class="wym_dialog_submit">'+"<fieldset>"+'<input type="hidden" class="wym_dialog_type" '+'value="'+WYMeditor.DIALOG_IMAGE+'" />'+"<legend>{Image}</legend>"+'<div class="row">'+"<label>{URL}</label>"+'<input type="text" class="wym_src" '+'value="" size="40" '+'autofocus="autofocus" />'+"</div>"+'<div class="row">'+"<label>{Alternative_Text}</label>"+'<input type="text" class="wym_alt" '+'value="" size="40" />'+"</div>"+'<div class="row">'+"<label>{Title}</label>"+'<input type="text" class="wym_title" '+'value="" size="40" />'+"</div>"+'<div class="row row-indent">'+'<input class="wym_submit" type="submit" '+'value="{Submit}" />'+'<input class="wym_cancel" type="button" '+'value="{Cancel}" />'+"</div>"+"</fieldset>"+"</form>"},getBodyClass:function(){var wym=this;return wym._options.dialogImageSelector||"wym_dialog_image"},initialize:function(wDialog){var wym=this,doc=wDialog.document,options=wym._options,selectedImage=wym.getSelectedImage(),$srcInput,$titleInput,$altInput,currentSrc,currentTitle,currentAlt;if(!selectedImage){return}$srcInput=jQuery(options.srcSelector,doc);$titleInput=jQuery(options.titleSelector,doc);$altInput=jQuery(options.altSelector,doc);currentSrc=jQuery(selectedImage).attr(WYMeditor.SRC);currentTitle=jQuery(selectedImage).attr(WYMeditor.TITLE);currentAlt=jQuery(selectedImage).attr(WYMeditor.ALT);$srcInput.val(currentSrc);$titleInput.val(currentTitle);$altInput.val(currentAlt)},submitHandler:function(wDialog){var wym=this,options=wym._options,imgAttrs,selectedImage=wym.getSelectedImage();imgAttrs={src:jQuery(options.srcSelector,wDialog.document).val(),title:jQuery(options.titleSelector,wDialog.document).val(),alt:jQuery(options.altSelector,wDialog.document).val()};wym.focusOnDocument();if(selectedImage){wym._updateImageAttrs(selectedImage,imgAttrs);wym.registerModification()}else{wym.insertImage(imgAttrs)}wDialog.close()}},InsertTable:{title:"Table",shouldOpen:function(){var wym=this;if(wym.hasSelection()!==true||wym.selection().isCollapsed!==true){return false}return true},getBodyHtml:function(){var wym=this;return wym._options.dialogTableHtml||String()+'<form class="wym_dialog_submit">'+"<fieldset>"+'<input type="hidden" class="wym_dialog_type" '+'value="'+WYMeditor.DIALOG_TABLE+'" />'+"<legend>{Table}</legend>"+'<div class="row">'+"<label>{Caption}</label>"+'<input type="text" class="wym_caption" '+'value="" size="40" />'+"</div>"+'<div class="row">'+"<label>{Summary}</label>"+'<input type="text" class="wym_summary" '+'value="" size="40" />'+"</div>"+'<div class="row">'+"<label>{Number_Of_Rows}</label>"+'<input type="text" class="wym_rows" '+'value="3" size="3" />'+"</div>"+'<div class="row">'+"<label>{Number_Of_Cols}</label>"+'<input type="text" class="wym_cols" '+'value="2" size="3" />'+"</div>"+'<div class="row row-indent">'+'<input class="wym_submit" type="submit" '+'value="{Submit}" />'+'<input class="wym_cancel" type="button" '+'value="{Cancel}" />'+"</div>"+"</fieldset>"+"</form>"},getBodyClass:function(){var wym=this;return wym._options.dialogTableSelector||"wym_dialog_table"},submitHandler:function(wDialog){var wym=this,options=wym._options,doc=wDialog.document,numRows=jQuery(options.rowsSelector,doc).val(),numColumns=jQuery(options.colsSelector,doc).val(),caption=jQuery(options.captionSelector,doc).val(),summary=jQuery(options.summarySelector,doc).val();wym.insertTable(numRows,numColumns,caption,summary);wDialog.close()}},Paste:{title:"Paste_From_Word",shouldOpen:function(){var wym=this;return wym.hasSelection()},getBodyHtml:function(){var wym=this;return wym._options.dialogPasteHtml||String()+'<form class="wym_dialog_submit">'+'<input type="hidden" class="wym_dialog_type" '+'value="'+WYMeditor.DIALOG_PASTE+'" />'+"<fieldset>"+"<legend>{Paste_From_Word}</legend>"+'<div class="row">'+'<textarea class="wym_text" rows="10" '+'cols="50" autofocus="autofocus">'+"</textarea>"+"</div>"+'<div class="row">'+'<input class="wym_submit" type="submit" '+'value="{Submit}" />'+'<input class="wym_cancel" type="button" '+'value="{Cancel}" />'+"</div>"+"</fieldset>"+"</form>"},getBodyClass:function(){var wym=this;return wym._options.dialogPasteSelector||"wym_dialog_paste"},submitHandler:function(wDialog){var wym=this,sText;sText=jQuery(wym._options.textSelector,wDialog.document).val();wym.paste(sText);wDialog.close()}},Preview:{title:"Preview",shouldOpen:function(){return true},getBodyHtml:function(){var wym=this;return wym._options.dialogPreviewHtml||wym.html()},getWindowFeatures:function(){return["menubar=no","titlebar=no","toolbar=no","resizable=no","width=560","height=300","top=0","left=0","scrollbars=yes"].join(",")},getBodyClass:function(){var wym=this;return wym._options.dialogPreviewSelector||"wym_dialog_preview"}}};WYMeditor.DIALOG_TITLE="{Wym_Dialog_Title}";WYMeditor.DIALOG_BODY="{Wym_Dialog_Body}";WYMeditor.DIALOG_BUTTON_SELECTOR=".wym_opens_dialog a";WYMeditor.DEFAULT_DIALOG_OPTIONS={hrefSelector:".wym_href",srcSelector:".wym_src",titleSelector:".wym_title",relSelector:".wym_rel",altSelector:".wym_alt",textSelector:".wym_text",rowsSelector:".wym_rows",colsSelector:".wym_cols",captionSelector:".wym_caption",summarySelector:".wym_summary",submitSelector:"form",cancelSelector:".wym_cancel",previewSelector:"",dialogLinkSelector:".wym_dialog_link",dialogImageSelector:".wym_dialog_image",dialogTableSelector:".wym_dialog_table",dialogPasteSelector:".wym_dialog_paste",dialogPreviewSelector:".wym_dialog_preview"};"use strict";WYMeditor.editor.prototype._init=function(){var wym=this,WymClass,browserInstance,SaxListener,prop,h,iframeHtml,boxHtml,aTools,sTools,oTool,sTool,i,aClasses,sClasses,oClass,sClass,aContainers,sContainers,sContainer,oContainer;WymClass=WYMeditor._getWymClassForBrowser();if(!WymClass){return}browserInstance=new WymClass(wym);if(jQuery.isFunction(wym._options.preInit)){wym._options.preInit(wym)}wym.parser=null;wym.helper=null;SaxListener=new WYMeditor.XhtmlSaxListener;wym.parser=new WYMeditor.XhtmlParser(SaxListener);wym.helper=new WYMeditor.XmlHelper;for(prop in browserInstance){wym[prop]=browserInstance[prop]}wym._box=jQuery(wym.element).hide().after(wym._options.boxHtml).next().addClass("wym_box_"+wym._index);if(jQuery.isFunction(jQuery.fn.data)){jQuery.data(wym._box.get(0),WYMeditor.WYM_INDEX,wym._index);jQuery.data(wym.element.get(0),WYMeditor.WYM_INDEX,wym._index)}h=WYMeditor.Helper;iframeHtml=wym._options.iframeHtml;iframeHtml=h.replaceAllInStr(iframeHtml,WYMeditor.IFRAME_BASE_PATH,wym._options.iframeBasePath);boxHtml=jQuery(wym._box).html();boxHtml=h.replaceAllInStr(boxHtml,WYMeditor.LOGO,wym._options.logoHtml);boxHtml=h.replaceAllInStr(boxHtml,WYMeditor.TOOLS,wym._options.toolsHtml);boxHtml=h.replaceAllInStr(boxHtml,WYMeditor.CONTAINERS,wym._options.containersHtml);boxHtml=h.replaceAllInStr(boxHtml,WYMeditor.CLASSES,wym._options.classesHtml);boxHtml=h.replaceAllInStr(boxHtml,WYMeditor.HTML,wym._options.htmlHtml);boxHtml=h.replaceAllInStr(boxHtml,WYMeditor.IFRAME,iframeHtml);boxHtml=h.replaceAllInStr(boxHtml,WYMeditor.STATUS,wym._options.statusHtml);aTools=eval(wym._options.toolsItems);sTools="";for(i=0;i<aTools.length;i+=1){oTool=aTools[i];sTool="";if(oTool.name&&oTool.title){sTool=wym._options.toolsItemHtml}sTool=h.replaceAllInStr(sTool,WYMeditor.TOOL_NAME,oTool.name);sTool=h.replaceAllInStr(sTool,WYMeditor.TOOL_TITLE,wym._options.stringDelimiterLeft+oTool.title+wym._options.stringDelimiterRight);sTool=h.replaceAllInStr(sTool,WYMeditor.TOOL_CLASS,oTool.css);sTools+=sTool}boxHtml=h.replaceAllInStr(boxHtml,WYMeditor.TOOLS_ITEMS,sTools);aClasses=eval(wym._options.classesItems);sClasses="";for(i=0;i<aClasses.length;i+=1){oClass=aClasses[i];sClass="";if(oClass.name&&oClass.title){sClass=wym._options.classesItemHtml}sClass=h.replaceAllInStr(sClass,WYMeditor.CLASS_NAME,oClass.name);sClass=h.replaceAllInStr(sClass,WYMeditor.CLASS_TITLE,oClass.title);sClasses+=sClass}boxHtml=h.replaceAllInStr(boxHtml,WYMeditor.CLASSES_ITEMS,sClasses);aContainers=eval(wym._options.containersItems);sContainers="";for(i=0;i<aContainers.length;i+=1){oContainer=aContainers[i];sContainer="";if(oContainer.name&&oContainer.title){sContainer=wym._options.containersItemHtml}sContainer=h.replaceAllInStr(sContainer,WYMeditor.CONTAINER_NAME,oContainer.name);sContainer=h.replaceAllInStr(sContainer,WYMeditor.CONTAINER_TITLE,wym._options.stringDelimiterLeft+oContainer.title+wym._options.stringDelimiterRight);sContainer=h.replaceAllInStr(sContainer,WYMeditor.CONTAINER_CLASS,oContainer.css);sContainers+=sContainer}boxHtml=h.replaceAllInStr(boxHtml,WYMeditor.CONTAINERS_ITEMS,sContainers);boxHtml=wym.replaceStrings(boxHtml);jQuery(wym._box).html(boxHtml);jQuery(wym._box).find(wym._options.htmlSelector).hide();wym.documentStructureManager=new WYMeditor.DocumentStructureManager(wym,wym._options.structureRules.defaultRootContainer);wym.iframeInitialized=false;wym._iframe=jQuery(wym._box).find("iframe")[0];jQuery(wym._iframe).on("load",function(){wym._onEditorIframeLoad(wym)});wym.element.attr("data-wym-initialized","yes");wym._initSkin()};WYMeditor.editor.prototype._assignWymDoc=function(){var wym=this;wym._doc=wym._iframe.contentDocument};WYMeditor.editor.prototype._isDesignModeOn=function(){var wym=this;if(typeof wym._doc.designMode==="string"&&wym._doc.designMode.toLowerCase()==="on"){return true}return false};WYMeditor.editor.prototype._onEditorIframeLoad=function(wym){wym._setBaseUrl();wym._assignWymDoc();wym._enableDesignModeOnDocument();wym._afterDesignModeOn()};WYMeditor.editor.prototype.get$Buttons=function(){var wym=this,buttonsSelector,$buttons;buttonsSelector=[wym._options.toolSelector,wym._options.containerSelector,wym._options.classSelector].join(", ");$buttons=jQuery(wym._box).find(buttonsSelector);return $buttons};WYMeditor.editor.prototype.focusOnDocument=function(){var wym=this,doc=wym._iframe.contentWindow;doc.focus()};WYMeditor.editor.prototype.registerModification=function(isNativeEdit){var wym=this;wym.undoRedo._add();if(!isNativeEdit){wym.nativeEditRegistration.edited.reset()}jQuery(wym.element).trigger(WYMeditor.EVENTS.postModification)};WYMeditor.editor.prototype._bindFocusOnDocumentToButtons=function(){var wym=this,$buttons=wym.get$Buttons();$buttons=$buttons.parent().not(".wym_opens_dialog").children("a");$buttons.click(function(){wym.focusOnDocument()})};WYMeditor.editor.prototype._uiQuirks=function(){return};WYMeditor.editor.prototype._setBaseUrl=function(){var wym=this;var base_url=$('<img src="">')[0].src;var base=wym._iframe.contentDocument.createElement("base");base.setAttribute("href",base_url);wym._iframe.contentDocument.getElementsByTagName("head")[0].appendChild(base)};WYMeditor.editor.prototype._afterDesignModeOn=function(){var wym=this;if(wym.iframeInitialized===true){return}wym._assignWymDoc();wym.$body().addClass("wym_iframe combokeys");wym._doc.title=wym._index;jQuery("html",wym._doc).attr("dir",wym._options.direction);wym.keyboard=new WYMeditor.Keyboard(wym);wym.keyboard._attachDefaultKeyboardShortcuts();wym._docEventQuirks();wym._initializeDocumentContent();if(jQuery.isFunction(wym._options.preBind)){wym._options.preBind(wym)}wym._bindUIEvents();wym.iframeInitialized=true;if(jQuery.isFunction(wym._options.postInit)){wym._options.postInit(wym)}wym._bindFocusOnDocumentToButtons();wym._uiQuirks();wym._listen();wym.undoRedo=new WYMeditor.UndoRedo(wym);wym.nativeEditRegistration=new WYMeditor.NativeEditRegistration(wym);wym.ih=new WYMeditor.ImageHandler(wym);jQuery(wym.element).trigger(WYMeditor.EVENTS.postIframeInitialization,wym)};WYMeditor.editor.prototype._initializeDocumentContent=function(){var wym=this;if(wym._options.html){wym.html(wym._options.html)}else{wym.html(wym.element[0].value)}};WYMeditor.editor.prototype._docEventQuirks=function(){return};WYMeditor.editor.prototype._bindUIEvents=function(){var wym=this,$toolbarButtons=jQuery(wym._box).find(wym._options.toolSelector),dialogButtonSelector=WYMeditor.DIALOG_BUTTON_SELECTOR,$html_val;$toolbarButtons.not(dialogButtonSelector).click(function(){var button=this;wym.exec(jQuery(button).attr(WYMeditor.NAME));return false});$toolbarButtons.filter(dialogButtonSelector).click(function(){var button=this,dialogName=jQuery(button).attr(WYMeditor.NAME),dialog=WYMeditor.DIALOGS[dialogName];wym.dialog(dialog);return false});jQuery(wym._box).find(wym._options.containerSelector).click(function(){var containerButton=this;wym.setRootContainer(jQuery(containerButton).attr(WYMeditor.NAME));return false});$html_val=jQuery(wym._box).find(wym._options.htmlValSelector);$html_val.keyup(function(){var valTextarea=this;wym.$body().html(jQuery(valTextarea).val())});$html_val.focus(function(){var valTextarea=this;jQuery(valTextarea).toggleClass("hasfocus")});$html_val.blur(function(){var valTextarea=this;jQuery(valTextarea).toggleClass("hasfocus")});jQuery(wym._box).find(wym._options.classSelector).click(function(){var classButton=this,aClasses=eval(wym._options.classesItems),sName=jQuery(classButton).attr(WYMeditor.NAME),oClass=WYMeditor.Helper._getFromArrayByName(aClasses,sName),jqexpr;if(oClass){jqexpr=oClass.expr;wym.toggleClass(sName,jqexpr)}return false});jQuery(wym._options.updateSelector).bind(wym._options.updateEvent,function(){wym.update()});wym.$body().bind("focus",function(){if(wym._isDesignModeOn()!==true){wym._enableDesignModeOnDocument()}})};WYMeditor.editor.prototype._enableDesignModeOnDocument=function(){var wym=this;if(wym._isDesignModeOn()){throw"Expected `designMode` to be off."}try{wym._doc.designMode="On"}catch(e){}if(typeof wym._designModeQuirks==="function"){wym._designModeQuirks()}};WYMeditor.editor.prototype.get$WymBox=function(){var wym=this;return wym._box};WYMeditor.editor.prototype.vanish=function(){var wym=this,instances=WYMeditor.INSTANCES,i;wym._box.remove();wym.element.removeAttr("data-wym-initialized").attr("data-wym-vanished","").show();instances.splice(wym._index,1);for(i=0;i<instances.length;i++){instances[i]._index=i}};WYMeditor.editor.prototype._exec=function(cmd,param){var wym=this,$span;if(typeof cmd!=="string"){throw"`_exec` expected a String `cmd`"}if(param&&typeof param!=="string"){throw"`_exec` expected a String `param`"}if(wym.selectedContainer()===wym.body()&&cmd!==WYMeditor.EXEC_COMMANDS.INSERT_IMAGE&&cmd!==WYMeditor.EXEC_COMMANDS.FORMAT_BLOCK){return false}wym._doc.execCommand(cmd,false,param);$span=jQuery(wym.selectedContainer()).filter("span").not("[id]");if($span.length===0){return true}if($span.attr("class")===""&&$span.attr("style")==="font-weight: normal;"||$span.attr("class").toLowerCase()==="apple-style-span"){$span.contents().unwrap()}return true};WYMeditor.editor.prototype.rawHtml=function(html){var wym=this;if(typeof html==="string"){wym.$body().html(html);wym.update()}else{return wym.$body().html()}};WYMeditor.editor.prototype.html=function(html){var wym=this;if(typeof html==="string"){wym.rawHtml(wym.parser.parse(html));wym.prepareDocForEditing()}else{return wym.parser.parse(wym.rawHtml())}};WYMeditor.editor.prototype.exec=function(cmd){var wym=this,custom_run;switch(cmd){case WYMeditor.EXEC_COMMANDS.TOGGLE_HTML:wym.update();wym.toggleHtml();break;case WYMeditor.EXEC_COMMANDS.INSERT_ORDEREDLIST:wym._insertOrderedList();break;case WYMeditor.EXEC_COMMANDS.INSERT_UNORDEREDLIST:wym._insertUnorderedList();break;case WYMeditor.EXEC_COMMANDS.INDENT:wym.indent();break;case WYMeditor.EXEC_COMMANDS.OUTDENT:wym.outdent();break;case WYMeditor.EXEC_COMMANDS.UNDO:wym.undoRedo.undo();break;case WYMeditor.EXEC_COMMANDS.REDO:wym.undoRedo.redo();break;default:custom_run=false;jQuery.each(wym._options.customCommands,function(){var customCommand=this;if(cmd===customCommand.name){custom_run=true;customCommand.run.apply(wym);return false}});if(!custom_run){if(wym._exec(cmd)===true){wym.registerModification()}}break}};WYMeditor.editor.prototype.selection=function(){var wym=this,iframe=wym._iframe,sel;if(window.rangy&&!rangy.initialized){rangy.init()}sel=rangy.getIframeSelection(iframe);return sel};WYMeditor.editor.prototype.nodeAfterSel=function(){var wym=this,sel=wym.selection();if(sel.anchorNode.tagName&&jQuery.inArray(sel.anchorNode.tagName.toLowerCase(),WYMeditor.NON_CONTAINING_ELEMENTS)===-1){if(sel.anchorNode.childNodes.length===0){return}return sel.anchorNode.childNodes[sel.anchorOffset]}if(sel.focusNode.nodeType===WYMeditor.NODE_TYPE.TEXT&&sel.focusNode.data.length===sel.focusOffset){if(!sel.focusNode.nextSibling){return}return sel.focusNode.nextSibling}return sel.focusNode};WYMeditor.editor.prototype.get$CommonParent=function(one,two){if(typeof one!=="object"||typeof one.nodeType!=="number"||typeof two!=="object"||typeof two.nodeType!=="number"){throw"`one` and `two` must be DOM nodes."}if(one.nodeType===WYMeditor.NODE_TYPE.TEXT){one=one.parentNode}if(two.nodeType===WYMeditor.NODE_TYPE.TEXT){two=two.parentNode}if(one===two){return jQuery(one)}var $one=jQuery(one),$two=jQuery(two),$commonParent;$commonParent=$one.parents().addBack().has($two).last();if($commonParent.length===0){throw"Couldn't find common parent. This shouldn't happen."}return $commonParent};WYMeditor.editor.prototype.selectedContainer=function(){var wym=this,selection,$anchor,$focus,$selectedContainer;if(wym.hasSelection()!==true){return false}selection=wym.selection();$anchor=jQuery(selection.anchorNode);$focus=jQuery(selection.focusNode);if($anchor[0].nodeType===WYMeditor.NODE_TYPE.TEXT){$anchor=$anchor.parent()}if($focus[0].nodeType===WYMeditor.NODE_TYPE.TEXT){$focus=$focus.parent()}if($anchor[0]===$focus[0]){return $anchor[0]}$selectedContainer=$anchor.has($focus);if($selectedContainer.length===0){$selectedContainer=$focus.has($anchor)}if($selectedContainer.length===0){return false}return $selectedContainer[0]};WYMeditor.editor.prototype.selected=function(){var wym=this;WYMeditor.console.warn("The function WYMeditor.editor.selected() is "+"deprecated. Use WYMeditor.editor.selectedContainer");return wym.selectedContainer()};WYMeditor.editor.prototype.isBlockNode=function(node){if(node.tagName&&jQuery.inArray(node.tagName.toLowerCase(),WYMeditor.BLOCKS)>-1){return true}return false};WYMeditor.editor.prototype.isInlineNode=function(node){if(node.nodeType===WYMeditor.NODE_TYPE.TEXT||jQuery.inArray(node.tagName.toLowerCase(),WYMeditor.INLINE_ELEMENTS)>-1){return true}return false};WYMeditor.editor.prototype.isListNode=function(node){if(node.tagName&&jQuery.inArray(node.tagName.toLowerCase(),WYMeditor.LIST_TYPE_ELEMENTS)>-1){return true}return false};WYMeditor.editor.prototype.unwrapIfMeaninglessSpan=function(element){var $element=jQuery(element),i=0,attrName,meaninglessAttrNames=["_wym_visited","length","ie8_length"];if(!element||typeof element.tagName==="undefined"||element.tagName.toLowerCase()!=="span"){return false}while(i<element.attributes.length){attrName=element.attributes[i].nodeName;if(jQuery.inArray(attrName,meaninglessAttrNames)===-1){return false}i++}$element.before($element.contents());$element.remove();return true};WYMeditor.editor.prototype.getRootContainer=function(){var wym=this;return jQuery(wym.selectedContainer()).parentsOrSelf().not("html, body, blockquote").last()[0]};WYMeditor.editor.prototype.setRootContainer=function(sType){var wym=this,container=null,aTypes,newNode,blockquote,nodes,lgt,firstNode,x;if(sType.toLowerCase()===WYMeditor.TH){container=wym.selectedContainer();switch(container.tagName.toLowerCase()){case WYMeditor.TD:case WYMeditor.TH:break;default:aTypes=[WYMeditor.TD,WYMeditor.TH];container=wym.findUp(wym.selectedContainer(),aTypes);break}if(container!==null){sType=WYMeditor.TD;if(container.tagName.toLowerCase()===WYMeditor.TD){sType=WYMeditor.TH}wym.restoreSelectionAfterManipulation(function(){wym.switchTo(container,sType,false);return true});wym.update();wym.registerModification()}}else{aTypes=[WYMeditor.P,WYMeditor.DIV,WYMeditor.H1,WYMeditor.H2,WYMeditor.H3,WYMeditor.H4,WYMeditor.H5,WYMeditor.H6,WYMeditor.PRE,WYMeditor.BLOCKQUOTE];container=wym.findUp(wym.selectedContainer(),aTypes);if(container){if(sType.toLowerCase()===WYMeditor.BLOCKQUOTE){blockquote=wym.findUp(wym.selectedContainer(),WYMeditor.BLOCKQUOTE);if(blockquote===null){newNode=wym._doc.createElement(sType);container.parentNode.insertBefore(newNode,container);newNode.appendChild(container);wym.setCaretIn(newNode.firstChild)}else{nodes=blockquote.childNodes;lgt=nodes.length;if(lgt>0){firstNode=nodes.item(0)}for(x=0;x<lgt;x+=1){blockquote.parentNode.insertBefore(nodes.item(0),blockquote)}blockquote.parentNode.removeChild(blockquote);if(firstNode){wym.setCaretIn(firstNode)}}}else{wym.restoreSelectionAfterManipulation(function(){wym.switchTo(container,sType,false);return true})}wym.update();wym.registerModification()}}return false};WYMeditor.editor.prototype.isForbiddenRootContainer=function(tagName){return jQuery.inArray(tagName.toLowerCase(),WYMeditor.FORBIDDEN_ROOT_CONTAINERS)>-1};WYMeditor.editor.prototype.keyCanCreateBlockElement=function(keyCode){return jQuery.inArray(keyCode,WYMeditor.POTENTIAL_BLOCK_ELEMENT_CREATION_KEYS)>-1};WYMeditor.editor.prototype.toggleClass=function(sClass,jqexpr){var wym=this,$element;$element=jQuery(wym.getSelectedImage());if($element.length!==1){$element=jQuery(wym.selectedContainer()).parentsOrSelf(jqexpr).last()}$element.toggleClass(sClass);if(!$element.attr(WYMeditor.CLASS)){$element.removeAttr(wym._class)}wym.registerModification()};WYMeditor.editor.prototype.getSelectedImage=function(){var wym=this,selectedNodes,selectedNode;if(wym.hasSelection()!==true){return false}if(wym.selection().isCollapsed!==false){return false}selectedNodes=wym._getSelectedNodes();if(selectedNodes.length!==1){return false}selectedNode=selectedNodes[0];if(!selectedNode.tagName||selectedNode.tagName.toLowerCase()!=="img"){return false}return selectedNode};WYMeditor.editor.prototype.findUp=function(node,filter){if(typeof node==="undefined"||node===null){return null}if(node.nodeName==="#text"){node=node.parentNode}var tagname=node.tagName.toLowerCase(),bFound,i;if(typeof filter===WYMeditor.STRING){while(tagname!==filter&&tagname!==WYMeditor.BODY){node=node.parentNode;tagname=node.tagName.toLowerCase()}}else{bFound=false;while(!bFound&&tagname!==WYMeditor.BODY){for(i=0;i<filter.length;i+=1){if(tagname===filter[i]){bFound=true;break}}if(!bFound){node=node.parentNode;if(node===null){return null}tagname=node.tagName.toLowerCase()}}}if(tagname===WYMeditor.BODY){return null}return node};WYMeditor.editor.prototype.switchTo=function(element,sType,stripAttrs){var wym=this,$element=jQuery(element),newElement,i,attrs=element.attributes;if(!element.tagName){throw"This must be an element."}if(element.tagName.toLowerCase()==="img"){throw"Will not change the type of an 'img' element."}newElement=wym._doc.createElement(sType);jQuery(newElement).append(element.childNodes);$element.replaceWith(newElement);if(!stripAttrs){for(i=0;i<attrs.length;++i){newElement.setAttribute(attrs.item(i).nodeName,attrs.item(i).value)}}return newElement};WYMeditor.editor.prototype.replaceStrings=function(sVal){var wym=this,key;if(!WYMeditor.STRINGS[wym._options.lang]){WYMeditor.console.error("WYMeditor: language '"+wym._options.lang+"' not found.");WYMeditor.console.error("Unable to perform i10n.");return sVal}for(key in WYMeditor.STRINGS[wym._options.lang]){if(WYMeditor.STRINGS[wym._options.lang].hasOwnProperty(key)){sVal=WYMeditor.Helper.replaceAllInStr(sVal,wym._options.stringDelimiterLeft+key+wym._options.stringDelimiterRight,WYMeditor.STRINGS[wym._options.lang][key])}}return sVal};WYMeditor.editor.prototype._encloseString=function(sVal){var wym=this;return wym._options.stringDelimiterLeft+sVal+wym._options.stringDelimiterRight};WYMeditor.editor.prototype.getCurrentState=function(){var wym=this,state={},selection,wymIframeWindow=wym._iframe.contentWindow;if(wym.hasSelection()){selection=wym.selection()}if(selection&&selection.anchorNode===wym.body()&&selection.anchorOffset===0&&selection.isCollapsed){selection=false}if(selection){state.savedSelection=rangy.saveSelection(wymIframeWindow)}state.html=wym.rawHtml();if(state.savedSelection){rangy.restoreSelection(state.savedSelection);state.savedSelection.restored=false;delete state.savedSelection.win;delete state.savedSelection.doc}return state};WYMeditor.editor.prototype.hasSelection=function(){var wym=this;if(rangy.isSelectionValid(wym._iframe.contentWindow)!==true){return false}if(wym.selection().rangeCount===0){return false}return true};WYMeditor.editor.prototype._setSingleSelectionRange=function(range){var wym=this,selection;selection=wym.selection();selection.setSingleRange(range)};WYMeditor.editor.prototype.status=function(sMessage){var wym=this;jQuery(wym._box).find(wym._options.statusSelector).html(sMessage)};WYMeditor.editor.prototype.update=function(){var wym=this,html;html=wym.html();jQuery(wym.element).val(html);jQuery(wym._box).find(wym._options.htmlValSelector).not(".hasfocus").val(html)};WYMeditor.editor.prototype.prepareDocForEditing=function(){var wym=this,$body;wym._spaceBlockingElements();wym._fixDoubleBr();$body=wym.$body();if($body.children().length===0){wym.$body().append("<br />")}jQuery(wym.element).trigger(WYMeditor.EVENTS.postBlockMaybeCreated,wym)};WYMeditor.editor.prototype._spaceBlockingElements=function(){var wym=this,blockingSelector=WYMeditor.DocumentStructureManager.CONTAINERS_BLOCKING_NAVIGATION.join(", "),$body=wym.$body(),children=$body.children(),placeholderNode,$firstChild,$lastChild,blockSepSelector,blockInListSepSelector,$blockInList;if(jQuery.browser.mozilla){placeholderNode="<br "+'class="'+WYMeditor.BLOCKING_ELEMENT_SPACER_CLASS+" "+WYMeditor.EDITOR_ONLY_CLASS+'" '+'_moz_editor_bogus_node="TRUE" '+'_moz_dirty=""'+"/>"}else{placeholderNode="<br "+'class="'+WYMeditor.BLOCKING_ELEMENT_SPACER_CLASS+" "+WYMeditor.EDITOR_ONLY_CLASS+'"'+"/>"}if(children.length>0){$firstChild=jQuery(children[0]);$lastChild=jQuery(children[children.length-1]);if($firstChild.is(blockingSelector)){$firstChild.before(placeholderNode)}if($lastChild.is(blockingSelector)){$lastChild.after(placeholderNode)}}blockSepSelector=wym._getBlockSepSelector();$body.find(blockSepSelector).before(placeholderNode);blockInListSepSelector=wym._getBlockInListSepSelector();$blockInList=$body.find(blockInListSepSelector);$blockInList.each(function(){var block=this,$block=jQuery(block);if(!$block.next(blockingSelector).length&&!$block.next("br").length){$block.after(placeholderNode)}})};WYMeditor.editor.prototype._getBlockSepSelector=function(){var wym=this,blockCombo=[],containersBlockingNav=WYMeditor.DocumentStructureManager.CONTAINERS_BLOCKING_NAVIGATION,containersNotBlockingNav;if(typeof wym._blockSpacersSel!=="undefined"){return wym._blockSpacersSel}containersNotBlockingNav=jQuery.grep(wym.documentStructureManager.structureRules.validRootContainers,function(item){return jQuery.inArray(item,containersBlockingNav)===-1});jQuery.each(containersBlockingNav,function(indexO,elementO){jQuery.each(containersBlockingNav,function(indexI,elementI){blockCombo.push(elementO+" + "+elementI)})});jQuery.each(containersBlockingNav,function(indexO,elementO){jQuery.each(containersNotBlockingNav,function(indexI,elementI){blockCombo.push(elementO+" + "+elementI);blockCombo.push(elementI+" + "+elementO)})});wym._blockSpacersSel=blockCombo.join(", ");return wym._blockSpacersSel};WYMeditor.editor.prototype._getBlockInListSepSelector=function(){var wym=this,blockCombo=[];if(typeof wym._blockInListSpacersSel!=="undefined"){return wym._blockInListSpacersSel}jQuery.each(WYMeditor.LIST_TYPE_ELEMENTS,function(indexO,elementO){jQuery.each(WYMeditor.BLOCKING_ELEMENTS,function(indexI,elementI){blockCombo.push(elementO+" "+elementI)})});wym._blockInListSpacersSel=blockCombo.join(", ");return wym._blockInListSpacersSel};WYMeditor.editor.prototype._fixDoubleBr=function(){var wym=this,$body=wym.$body(),$last_br;$body.children("br + br").filter(":not(pre br)").remove();$body.find("p + br").next("p").prev("br").remove();$last_br=$body.find("p + br").slice(-1);if($last_br.length>0){if($last_br.next().length===0){$last_br.remove()}}};WYMeditor.editor.prototype.link=function(attrs){var wym=this,$selected,uniqueStamp,$a;if(jQuery.isPlainObject(attrs)!==true){throw"Expected a plain object."}if(attrs.hasOwnProperty("href")!==true||typeof attrs.href!=="string"||attrs.href.length===0){return}$selected=jQuery(wym.selectedContainer());if($selected.is("a")){$a=$selected}else{uniqueStamp=wym.uniqueStamp();wym._exec(WYMeditor.EXEC_COMMANDS.CREATE_LINK,uniqueStamp);$a=jQuery("a[href="+uniqueStamp+"]",wym.body())}if($a.length===0){return}$a.attr(attrs);wym.registerModification()};WYMeditor.editor.prototype.insertImage=function(attrs){var wym=this,uniqueStamp,$img;if(jQuery.isPlainObject(attrs)!==true){throw"Expected a plain object."}if(attrs.hasOwnProperty("src")!==true||typeof attrs.src!=="string"||attrs.src.length===0){return}uniqueStamp=wym.uniqueStamp();wym._exec(WYMeditor.EXEC_COMMANDS.INSERT_IMAGE,uniqueStamp);$img=jQuery("img[src="+uniqueStamp+"]",wym.body());if($img.length===0){return}$img.attr(attrs);wym.$body().find(".Apple-style-span").children().unwrap();wym.registerModification()};WYMeditor.editor.prototype._updateImageAttrs=function(img,attrs){var $img=jQuery(img);if(attrs.src!==$img.attr("src")){$img.data("DimensionsRatio",null);$img.removeAttr("height").removeAttr("width")}$img.attr(attrs)};WYMeditor.editor.prototype.toggleHtml=function(){var wym=this;jQuery(wym._box).find(wym._options.htmlSelector).toggle()};WYMeditor.editor.prototype.uniqueStamp=function(){var now=new Date;return"wym"+now.getTime()};WYMeditor.editor.prototype._handleMultilineBlockContainerPaste=function(wym,$container,range,paragraphStrings){var i,$insertAfter,html,blockSplitter,leftSide,rightSide,rangeNodeComparison,$splitRightParagraph,firstParagraphString,firstParagraphHtml,blockParent,blockParentType;$insertAfter=jQuery(blockParent);blockSplitter="p";if($container.is("li")){blockSplitter="li"}range.splitBoundaries();blockParent=wym.findUp(range.startContainer,["p","h1","h2","h3","h4","h5","h6","li"]);blockParentType=blockParent.tagName;leftSide=[];rightSide=[];jQuery(blockParent).contents().each(function(index,element){rangeNodeComparison=range.compareNode(element);if(rangeNodeComparison===range.NODE_BEFORE||rangeNodeComparison===range.NODE_BEFORE_AND_AFTER&&range.startOffset===range.startContainer.length){leftSide.push(element)}else{rightSide.push(element)}});for(i=0;i<leftSide.length;i++){jQuery(leftSide[i]).remove()}for(i=0;i<rightSide.length;i++){jQuery(rightSide[i]).remove()}if(leftSide.length>0){jQuery(blockParent).prepend(leftSide)}if(rightSide.length>0){$splitRightParagraph=jQuery("<"+blockParentType+">"+"</"+blockParentType+">",wym._doc);$splitRightParagraph.insertAfter(jQuery(blockParent));$splitRightParagraph.append(rightSide)}firstParagraphString=paragraphStrings.splice(0,1)[0];firstParagraphHtml=firstParagraphString.split(WYMeditor.NEWLINE).join("<br />");jQuery(blockParent).html(jQuery(blockParent).html()+firstParagraphHtml);$insertAfter=jQuery(blockParent);for(i=0;i<paragraphStrings.length;i++){html="<"+blockSplitter+">"+paragraphStrings[i].split(WYMeditor.NEWLINE).join("<br />")+"</"+blockSplitter+">";$insertAfter=jQuery(html,wym._doc).insertAfter($insertAfter)}};WYMeditor.editor.prototype.paste=function(str){var wym=this,container=wym.selectedContainer(),paragraphStrings,j,textNodesToInsert,blockSplitter,$container=jQuery(container),html="",paragraphs,i,isSingleLine=false,sel=wym.selection(),textNode,range=sel.getRangeAt(0),insertionNodes;range.collapse(true);paragraphStrings=str.split(new RegExp(WYMeditor.NEWLINE+"{2,}","g"));if(paragraphStrings.length===1){isSingleLine=true}if(typeof container==="undefined"||container&&container.tagName.toLowerCase()===WYMeditor.BODY){if(isSingleLine){paragraphs=jQuery("<p>"+paragraphStrings[0]+"</p>",wym._doc).appendTo(wym._doc.body)}else{blockSplitter="p";for(i=paragraphStrings.length-1;i>=0;i-=1){html="<"+blockSplitter+">"+paragraphStrings[i].split(WYMeditor.NEWLINE).join("<br />")+"</"+blockSplitter+">";insertionNodes=jQuery(html,wym._doc);for(j=insertionNodes.length-1;j>=0;j--){range.insertNode(insertionNodes[j])}}}}else{if(isSingleLine||$container.is("pre")){textNode=wym._doc.createTextNode(str);range.insertNode(textNode)}else if($container.is("p,h1,h2,h3,h4,h5,h6,li")){wym._handleMultilineBlockContainerPaste(wym,$container,range,paragraphStrings)}else{textNodesToInsert=str.split(WYMeditor.NEWLINE);for(i=textNodesToInsert.length-1;i>=0;i-=1){textNode=wym._doc.createTextNode(textNodesToInsert[i]);range.insertNode(textNode);if(i>0){range.insertNode(jQuery("<br />",wym._doc).get(0))}}}}wym.registerModification()};WYMeditor.editor.prototype.insert=function(html){var wym=this,selection=wym.hasSelection()?wym.selection():false,range,node;if(selection){range=selection.getRangeAt(0);node=range.createContextualFragment(html);range.deleteContents();range.insertNode(node)}};WYMeditor.editor.prototype.canSetCaretBefore=function(node){var wym=this;if(node.nodeType===WYMeditor.NODE_TYPE.TEXT){return true}if(node.tagName&&node.tagName.toLowerCase()==="br"){if(!node.previousSibling){return true}else if(node.previousSibling.tagName&&node.previousSibling.tagName.toLowerCase()==="br"){return true}else if(wym.isBlockNode(node.previousSibling)){return true}else if(node.previousSibling.nodeType===WYMeditor.NODE_TYPE.TEXT){return true}}return false};WYMeditor.editor.prototype.setCaretBefore=function(node){var wym=this,range=rangy.createRange(wym._doc),selection=wym.selection();if(!wym.canSetCaretBefore(node)){throw"Can't set caret before this node."}range.selectNode(node);range.collapse(true);selection.setSingleRange(range)};WYMeditor.editor.prototype.canSetCaretIn=function(node){var wym=this;if(node.nodeType===WYMeditor.NODE_TYPE.TEXT||node.tagName&&jQuery.inArray(node.tagName.toLowerCase(),WYMeditor.NO_CARET_ELEMENTS)>-1){return false}if(wym.isInlineNode(node)){if(node.childNodes.length===0){return false}WYMeditor.console.warn("Can set a non-collapsed selection. Rangy issue #209.")}return true};WYMeditor.editor.prototype.setCaretIn=function(element){var wym=this,range=rangy.createRange(wym._doc),selection=wym.selection();if(!wym.canSetCaretIn(element)){throw"The element must be able to contain other elements. Perhaps "+" you would like to use `setCaretBefore`, instead."}range.selectNodeContents(element);if(wym.isInlineNode(element)){WYMeditor.console.warn("Can't set a collapsed selection. Setting "+"a non-collapsed selection, instead. Rangy issue #209.")}else{range.collapse(true)}selection.setSingleRange(range)};WYMeditor.editor.prototype._splitListItemContents=function($listItem){var $allContents,i,elmnt,hitSublist=false,splitObject={itemContents:[],sublistContents:[]};$allContents=$listItem.contents();for(i=0;i<$allContents.length;i++){elmnt=$allContents.get(i);if(hitSublist||jQuery(elmnt).is("ol,ul")){hitSublist=true;splitObject.sublistContents.push(elmnt)}else{splitObject.itemContents.push(elmnt)}}return splitObject};WYMeditor.editor.prototype._joinAdjacentLists=function(listOne,listTwo){var $listTwoContents;if(typeof listOne==="undefined"||typeof listTwo==="undefined"){return}if(listOne.nextSibling!==listTwo||listOne.tagName.toLowerCase()!==listTwo.tagName.toLowerCase()){return}$listTwoContents=jQuery(listTwo).contents();$listTwoContents.unwrap();$listTwoContents.detach();jQuery(listOne).append($listTwoContents)};WYMeditor.editor.prototype._indentSingleItem=function(listItem){var wym=this,$liToIndent,listType,spacerHtml,containerHtml,splitContent,$itemContents,$sublistContents,$prevLi,$prevSublist,$firstSublist,$spacer,$spacerContents;$liToIndent=jQuery(listItem);listType=$liToIndent.parent()[0].tagName.toLowerCase();splitContent=wym._splitListItemContents($liToIndent);$sublistContents=jQuery(splitContent.sublistContents);$itemContents=jQuery(splitContent.itemContents);$prevLi=$liToIndent.prev().filter("li");if($prevLi.length===0){spacerHtml='<li class="spacer_li"></li>';$liToIndent.before(spacerHtml);$prevLi=$liToIndent.prev()}$prevSublist=$prevLi.contents().last().filter("ol,ul");if($prevSublist.length>0){$prevSublist.append($liToIndent);$sublistContents.detach();$prevLi.append($sublistContents);$firstSublist=$sublistContents.first();wym._joinAdjacentLists($prevSublist.get(0),$firstSublist.get(0))}else{if($sublistContents.length>0){$sublistContents.detach();$prevLi.append($sublistContents);$prevSublist=$sublistContents.first()}else{containerHtml="<"+listType+"></"+listType+">";$prevLi.append(containerHtml);$prevSublist=$prevLi.contents().last()}$prevSublist.prepend($liToIndent)}if($liToIndent.next().is(".spacer_li")){$spacer=$liToIndent.next(".spacer_li");$spacerContents=$spacer.contents();$spacerContents.detach();$liToIndent.append($spacerContents);$spacer.remove()}};WYMeditor.editor.prototype._outdentSingleItem=function(listItem){var wym=this,$liToOutdent,listType,spacerListHtml,splitContent,$itemContents,$sublistContents,$parentLi,$parentList,$subsequentSiblingContent,$subsequentParentListSiblingContent,$sublist;$liToOutdent=jQuery(listItem);listType=$liToOutdent.parent()[0].tagName.toLowerCase();if(!$liToOutdent.parent().parent().is("ol,ul,li")){return}if(!$liToOutdent.parent().parent().is("li")){WYMeditor.console.log("Attempting to fix invalid list nesting before outdenting.");wym._fixInvalidListNesting(listItem)}splitContent=wym._splitListItemContents($liToOutdent);$sublistContents=jQuery(splitContent.sublistContents);$itemContents=jQuery(splitContent.itemContents);$parentLi=$liToOutdent.parent().parent("li");if($parentLi.length===0){WYMeditor.console.error("Invalid list. No parentLi found, so aborting outdent");return}$parentList=$liToOutdent.parent();$subsequentSiblingContent=$liToOutdent.nextAllContents();$subsequentParentListSiblingContent=$parentList.nextAllContents();$liToOutdent.detach();$parentLi.after($liToOutdent);if($sublistContents.length>0){spacerListHtml="<"+listType+">"+'<li class="spacer_li"></li>'+"</"+listType+">";$liToOutdent.append(spacerListHtml);$sublist=$liToOutdent.children().last();$sublistContents.detach();$sublist.children("li").append($sublistContents)}if($subsequentSiblingContent.length>0){if(typeof $sublist==="undefined"){spacerListHtml="<"+listType+"></"+listType+">";$liToOutdent.append(spacerListHtml);$sublist=$liToOutdent.children().last()}$subsequentSiblingContent.detach();$sublist.append($subsequentSiblingContent)}if($subsequentParentListSiblingContent.length>0){$subsequentParentListSiblingContent.detach();if($liToOutdent.contents().length>0&&$liToOutdent.contents().last()[0].nodeType===WYMeditor.NODE_TYPE.TEXT&&$subsequentParentListSiblingContent[0].nodeType===WYMeditor.NODE_TYPE.TEXT){$liToOutdent.append("<br />")}$liToOutdent.append($subsequentParentListSiblingContent)}if($parentList.contents().length===0){$parentList.remove()}if($parentLi.contents().length===0){$parentLi.remove()}};WYMeditor.editor.prototype._fixInvalidListNesting=function(listItem,alreadyCorrected){var wym=this,currentNode=listItem,parentNode,tagName;if(typeof alreadyCorrected==="undefined"){alreadyCorrected=false}if(!currentNode){return alreadyCorrected}while(currentNode.parentNode){parentNode=currentNode.parentNode;if(parentNode.nodeType!==WYMeditor.NODE_TYPE.ELEMENT){break}tagName=parentNode.tagName.toLowerCase();if(tagName!=="ol"&&tagName!=="ul"&&tagName!=="li"){break}currentNode=parentNode}if(jQuery(currentNode).is("li")){WYMeditor.console.log("Correcting orphaned root li before correcting invalid list nesting.");wym._correctOrphanedListItem(currentNode);return wym._fixInvalidListNesting(currentNode,true)}if(!jQuery(currentNode).is("ol,ul")){WYMeditor.console.error("Can't correct invalid list nesting. No root list found");return alreadyCorrected}return wym._fixInvalidlyNestedList(currentNode,alreadyCorrected)};WYMeditor.editor.prototype._isPOrDivAfterEnterInEmptyNestedLi=function(container){if(jQuery.inArray(container.tagName.toLowerCase(),WYMeditor.DocumentStructureManager.VALID_DEFAULT_ROOT_CONTAINERS)>-1&&container.parentNode.tagName.toLowerCase()==="li"){switch(container.childNodes.length){case 0:return true;case 1:if(container.childNodes[0].tagName&&container.childNodes[0].tagName.toLowerCase()==="br"){return true}else if(container.childNodes[0].nodeType===WYMeditor.NODE_TYPE.TEXT&&container.childNodes[0].data===WYMeditor.NBSP){return true}}}return false};WYMeditor.editor.prototype._isSpilledListAfterEnterInEmptyLi=function(container){var wym=this;if(container.tagName.toLowerCase()==="li"&&container.previousSibling&&wym.isListNode(container.previousSibling)&&container.previousSibling.previousSibling&&container.previousSibling.previousSibling.tagName.toLowerCase()==="li"&&wym.isListNode(container.parentNode)){return true}return false};WYMeditor.editor.prototype._handlePotentialEnterInEmptyNestedLi=function(keyPressed,container){if(keyPressed!==WYMeditor.KEY_CODE.ENTER){return null}var wym=this;if(wym._isPOrDivAfterEnterInEmptyNestedLi(container)){wym._replaceNodeWithBrAndSetCaret(container)}else if(wym._isSpilledListAfterEnterInEmptyLi(container)){wym._appendSiblingsUntilNextLiToPreviousLi(container);wym._replaceNodeWithBrAndSetCaret(container)}};WYMeditor.editor.prototype._replaceNodeWithBrAndSetCaret=function(node){var wym=this,$node=jQuery(node);if(node.previousSibling&&!node.previousSibling.tagName||node.previousSibling.tagName.toLowerCase()!=="br"&&wym.isInlineNode(node.previousSibling)){$node.before("<br />")}$node.before("<br />");wym.setCaretBefore(node.previousSibling);$node.remove()};WYMeditor.editor.prototype._appendSiblingsUntilNextLiToPreviousLi=function(newLi){var $newLi=jQuery(newLi),$parentContents=$newLi.parent().contents(),$sadLi=$newLi.prevAll("li").first(),$nextLi=$newLi.nextAll("li").first(),spillStart=$sadLi.index()+1,$spilled;if($nextLi.length===1){$spilled=$parentContents.slice(spillStart,$nextLi.index())}else{$spilled=$parentContents.slice(spillStart)}$sadLi.append($spilled)};WYMeditor.editor.prototype._correctOrphanedListItem=function(listNode){var prevAdjacentLis,nextAdjacentLis,$adjacentLis=jQuery(),prevList,prevNode;prevAdjacentLis=jQuery(listNode).prevContentsUntil(":not(li)");nextAdjacentLis=jQuery(listNode).nextContentsUntil(":not(li)");$adjacentLis=$adjacentLis.add(prevAdjacentLis);$adjacentLis=$adjacentLis.add(listNode);$adjacentLis=$adjacentLis.add(nextAdjacentLis);prevNode=$adjacentLis[0].previousSibling;if(prevNode&&jQuery(prevNode).is("ol,ul")){prevList=prevNode}else{$adjacentLis.before("<ol></ol>");prevList=$adjacentLis.prev()[0]}jQuery(prevList).append($adjacentLis)};WYMeditor.editor.prototype._fixInvalidlyNestedList=function(listNode,alreadyCorrected){var rootNode=listNode,currentNode=listNode,wasCorrected=false,previousSibling,tagName,ancestorNode,nodesToMove,targetLi,lastContentNode,spacerHtml='<li class="spacer_li"></li>';if(typeof alreadyCorrected!=="undefined"){wasCorrected=alreadyCorrected}while(currentNode){if(currentNode._wym_visited){currentNode._wym_visited=false;if(currentNode===rootNode){break}if(currentNode.previousSibling){currentNode=currentNode.previousSibling}else{currentNode=currentNode.parentNode}}else{if(currentNode!==rootNode&&!jQuery(currentNode).is("li")){ancestorNode=currentNode;while(ancestorNode.parentNode){ancestorNode=ancestorNode.parentNode;if(jQuery(ancestorNode).is("li")){break}if(ancestorNode.nodeType!==WYMeditor.NODE_TYPE.ELEMENT){break}tagName=ancestorNode.tagName.toLowerCase();if(tagName==="ol"||tagName==="ul"){WYMeditor.console.log("Fixing orphaned list content");wasCorrected=true;nodesToMove=[currentNode];previousSibling=currentNode;targetLi=null;while(previousSibling.previousSibling){previousSibling=previousSibling.previousSibling;if(jQuery(previousSibling).is("li")){targetLi=previousSibling;break}nodesToMove.push(previousSibling)}nodesToMove.reverse();if(!targetLi&&nodesToMove.length===1){if(jQuery(currentNode.nextSibling).is("li")){targetLi=currentNode.nextSibling}}if(!targetLi){jQuery(nodesToMove[0]).before(spacerHtml);targetLi=jQuery(nodesToMove[0]).prev()[0]}lastContentNode=jQuery(targetLi).contents().last();if(lastContentNode.length===1&&lastContentNode[0].nodeType===WYMeditor.NODE_TYPE.TEXT){if(nodesToMove[0].nodeType===WYMeditor.NODE_TYPE.TEXT){jQuery(targetLi).append("<br />")}}jQuery(targetLi).append(jQuery(nodesToMove));break}}}if(currentNode.lastChild){currentNode._wym_visited=true;currentNode=currentNode.lastChild}else if(currentNode.previousSibling){currentNode=currentNode.previousSibling}else{currentNode=currentNode.parentNode}}}return wasCorrected};WYMeditor.editor.prototype._getCommonParentList=function(listItems,getClosest){var firstLi,parentList,rootList,haveCommonParent=true;listItems=jQuery(listItems).filter("li");if(listItems.length===0){return null}firstLi=listItems[0];parentList=jQuery(firstLi).parents("ol,ul");parentList=getClosest?parentList.first():parentList.last();if(parentList.length===0){return null}rootList=parentList[0];jQuery(listItems).each(function(index,elmnt){parentList=jQuery(elmnt).parents("ol,ul");parentList=getClosest?parentList.first():parentList.last();if(parentList.length===0||parentList[0]!==rootList){haveCommonParent=false}});if(!haveCommonParent){return null}return rootList};WYMeditor.editor.prototype.deselect=function(){var wym=this;wym.selection().removeAllRanges();wym.body().blur()};WYMeditor.editor.prototype._getSelectedNodes=function(){var wym=this,selection=wym.selection(),selectedNodes;if(wym.hasSelection()!==true){return false}selectedNodes=selection.getAllRanges().reduce(function(nodes,range){return nodes.concat(range.getNodes())},[]);return selectedNodes};WYMeditor.editor.prototype._getSelectedListItems=function(selection){var wym=this,$selectedContainer,$selectedNodes,$selectedLis;if(selection.isCollapsed){$selectedContainer=jQuery(wym.selectedContainer());if($selectedContainer.closest("li, table").is("table")){return[]}return $selectedContainer.closest("li")}$selectedNodes=jQuery(wym._getSelectedNodes());if($selectedNodes.closest("li, table").filter("li").length===0){return[]}$selectedLis=$selectedNodes.not("li, ol, ul").add($selectedNodes.find(".rangySelectionBoundary")).add($selectedNodes.filter(function(){return wym.nodeType===WYMeditor.NODE_TYPE.TEXT})).closest("li").add($selectedNodes.filter("li:empty")).not($selectedNodes.filter("table").find("li"));return jQuery.unique($selectedLis.get())};WYMeditor.editor.prototype._selectionOnlyInList=function(sel){var wym=this,selStartNode,selEndNode,i;for(i=0;i<sel.rangeCount;++i){selStartNode=wym.findUp(sel.getRangeAt(i).startContainer,["li"]);selEndNode=wym.findUp(sel.getRangeAt(i).endContainer,["li"]);if(!selStartNode||!selEndNode){return false}if(!wym._getCommonParentList([selStartNode,selEndNode],false)){return false}}return true};WYMeditor.editor.prototype.indent=function(){var wym=this,sel=wym.selection(),listItems,manipulationFunc,i;manipulationFunc=function(){var selection=wym.selection(),selectedBlock=wym.get$CommonParent(selection.anchorNode,selection.focusNode)[0],potentialListBlock=wym.findUp(selectedBlock,["ol","ul","li"]);return wym._fixInvalidListNesting(potentialListBlock)};if(wym.restoreSelectionAfterManipulation(manipulationFunc)){wym.registerModification();return true}sel=wym.selection();if(!wym._selectionOnlyInList(sel)){return false}listItems=wym._getSelectedListItems(sel);if(listItems.length===0){return false}manipulationFunc=function(){var domChanged=false;for(i=0;i<listItems.length;i++){wym._indentSingleItem(listItems[i]);domChanged=true}return domChanged};return wym.restoreSelectionAfterManipulation(manipulationFunc)&&wym.registerModification()};WYMeditor.editor.prototype.outdent=function(){var wym=this,sel=wym.selection(),listItems,manipulationFunc,i;manipulationFunc=function(){var selection=wym.selection(),selectedBlock=wym.get$CommonParent(selection.anchorNode,selection.focusNode)[0],potentialListBlock=wym.findUp(selectedBlock,["ol","ul","li"]);return wym._fixInvalidListNesting(potentialListBlock)};if(wym.restoreSelectionAfterManipulation(manipulationFunc)){wym.registerModification();return true}sel=wym.selection();if(!wym._selectionOnlyInList(sel)){return false}listItems=wym._getSelectedListItems(sel);if(listItems.length===0){return false}manipulationFunc=function(){var domChanged=false;for(i=0;i<listItems.length;i++){wym._outdentSingleItem(listItems[i]);domChanged=true}return domChanged};return wym.restoreSelectionAfterManipulation(manipulationFunc)&&wym.registerModification()};WYMeditor.editor.prototype.restoreSelectionAfterManipulation=function(manipulationFunc){var wym=this,savedSelection=rangy.saveSelection(rangy.dom.getIframeWindow(wym._iframe)),changesMade=true;try{changesMade=manipulationFunc();if(changesMade){rangy.restoreSelection(savedSelection)}else{rangy.removeMarkers(savedSelection)}}catch(e){WYMeditor.console.error("Error during manipulation");WYMeditor.console.error(e);rangy.removeMarkers(savedSelection)}return changesMade};WYMeditor.editor.prototype._insertOrderedList=function(){var wym=this,manipulationFunc;manipulationFunc=function(){var potentialListBlock=jQuery(wym._getSelectedNodes()).parents().addBack().filter("ol, ul, li").last()[0];potentialListBlock=potentialListBlock||wym.selectedContainer();return wym._fixInvalidListNesting(potentialListBlock)};if(wym.restoreSelectionAfterManipulation(manipulationFunc)){wym.registerModification();return true}manipulationFunc=function(){return wym.insertList("ol")};return wym.restoreSelectionAfterManipulation(manipulationFunc)&&wym.registerModification()};WYMeditor.editor.prototype._insertUnorderedList=function(){var wym=this,manipulationFunc;manipulationFunc=function(){var potentialListBlock=jQuery(wym._getSelectedNodes()).parents().addBack().filter("ol, ul, li").last()[0];potentialListBlock=potentialListBlock||wym.selectedContainer();return wym._fixInvalidListNesting(potentialListBlock)};if(wym.restoreSelectionAfterManipulation(manipulationFunc)){wym.registerModification();return true}manipulationFunc=function(){return wym.insertList("ul")};return wym.restoreSelectionAfterManipulation(manipulationFunc)&&wym.registerModification()};WYMeditor.editor.prototype.insertList=function(listType){var wym=this,sel=wym.selection(),listItems,$listItems,$parentListsOfDifferentType,commonParentList,potentialListBlock;listItems=wym._getSelectedListItems(sel);if(listItems.length>0){$listItems=jQuery(listItems);$parentListsOfDifferentType=$listItems.parent(":not("+listType+")");if($parentListsOfDifferentType.length>0){commonParentList=wym._getCommonParentList(listItems,true);if(commonParentList){wym.changeListType(commonParentList,listType);return true}}else{wym._removeItemsFromList($listItems);return true}}potentialListBlock=wym.findUp(wym.selectedContainer(),WYMeditor.POTENTIAL_LIST_ELEMENTS);if(potentialListBlock){wym.convertToList(potentialListBlock,listType);return true}return false};WYMeditor.editor.prototype.changeListType=function(list,listType){var wym=this;return wym.switchTo(list,listType)};WYMeditor.editor.prototype.convertToList=function(blockElement,listType){var wym=this,$blockElement=jQuery(blockElement),newListHtml,$newList;newListHtml="<"+listType+"><li></li></"+listType+">";if(wym.findUp(blockElement,WYMeditor.ROOT_CONTAINERS)===blockElement){$blockElement.wrapInner(newListHtml);$newList=$blockElement.children();$newList.unwrap();return $newList.get(0)}$blockElement.wrapInner(newListHtml);$newList=$blockElement.children();return $newList.get(0)};WYMeditor.editor.prototype._removeItemsFromList=function($listItems){var wym=this,$listItem,i,j,listItemChild,$childNodesToTransfer,k,$childNodeToTransfer,rootContainer=wym.documentStructureManager.structureRules.defaultRootContainer,attributes;for(i=0;i<$listItems.length;i++){$listItem=$listItems.eq(i);if($listItem.parent().parent("li, th, td").length===1){$listItem=jQuery(wym.switchTo($listItem[0],"span",false))}else{$listItem=jQuery(wym.switchTo($listItem[0],rootContainer,false))}if($listItem.parent().children().length===1){$listItem.parent().before($listItem);$listItem.next().remove()}else if($listItem[0]===$listItem.parent().children().first()[0]){$listItem.parent().before($listItem)}else if($listItem[0]!==$listItem.parent().children().first()[0]&&$listItem[0]!==$listItem.parent().children().last()[0]){$listItem.parent().before("<"+$listItem.parent()[0].tagName+"/>");jQuery($listItem.prevAll().toArray().reverse()).appendTo($listItem.parent().prev());$listItem.parent().before($listItem)}else if($listItem[0]===$listItem.parent().children().last()[0]){$listItem.parent().after($listItem)}for(j=0;j<$listItem.contents().length;j++){listItemChild=$listItem.contents()[j];if(wym.isBlockNode(listItemChild)&&listItemChild.className!=="rangySelectionBoundary"&&listItemChild.tagName.toLowerCase()!=="br"){$childNodesToTransfer=$listItem.contents().slice(j);if($listItem[0].tagName.toLowerCase()===rootContainer){for(k=0;k<$childNodesToTransfer.length;k++){$childNodeToTransfer=$childNodesToTransfer.eq(k);if($childNodeToTransfer[0].nodeType===WYMeditor.NODE_TYPE.TEXT){$childNodeToTransfer.wrap("<"+rootContainer+" />")}else if($childNodeToTransfer[0].tagName&&!wym.isBlockNode($childNodeToTransfer[0])&&$childNodeToTransfer[0].tagName.toLowerCase()!=="br"){wym.switchTo($childNodesToTransfer[k],rootContainer,false)}}}$listItem.after($listItem.contents().slice(j));break}}wym.$body().children("br").remove();if($listItem[0].tagName.toLowerCase()==="span"){if($listItem.contents(":not(.rangySelectionBoundary)").length===0||$listItem.contents(":not(.rangySelectionBoundary)").length===$listItem.contents("br").length){$listItem.before($listItem.contents(".rangySelectionBoundary"));$listItem.remove()}else{if($listItem[0].previousSibling&&$listItem[0].previousSibling.nodeType===WYMeditor.NODE_TYPE.TEXT||$listItem.prevAll(":not(.rangySelectionBoundary)").length>0&&wym.isBlockNode($listItem.prevAll(":not(.rangySelectionBoundary)")[0])===false){$listItem.before("<br />")}if($listItem[0].nextSibling&&$listItem[0].nextSibling.nodeType===WYMeditor.NODE_TYPE.TEXT||$listItem.nextAll(":not(.rangySelectionBoundary)").length>0&&wym.isBlockNode($listItem.nextAll(":not(.rangySelectionBoundary)")[0])===false){$listItem.after("<br />")}attributes=$listItem[0].attributes;wym.unwrapIfMeaninglessSpan($listItem[0])}}}wym.prepareDocForEditing()};WYMeditor.editor.prototype.insertTable=function(rows,columns,caption,summary){if(rows<=0||columns<=0){return}var wym=this,table=wym._doc.createElement(WYMeditor.TABLE),newRow=null,newCaption,x,y,container,selectedNode;newCaption=table.createCaption();newCaption.innerHTML=caption;for(x=0;x<rows;x+=1){newRow=table.insertRow(x);for(y=0;y<columns;y+=1){newRow.insertCell(y)}}if(summary!==""){jQuery(table).attr("summary",summary)}container=jQuery(wym.findUp(wym.selectedContainer(),WYMeditor.POTENTIAL_TABLE_INSERT_ELEMENTS)).get(0);if(!container||!container.parentNode){wym.$body().append(table)}else if(jQuery.inArray(container.nodeName.toLowerCase(),WYMeditor.INLINE_TABLE_INSERTION_ELEMENTS)>-1){selectedNode=wym.selection().focusNode;if(jQuery.inArray(selectedNode.nodeName.toLowerCase(),WYMeditor.SELECTABLE_TABLE_ELEMENTS)>-1||jQuery.inArray(selectedNode.parentNode.nodeName.toLowerCase(),WYMeditor.SELECTABLE_TABLE_ELEMENTS)>-1){while(selectedNode.nodeName.toLowerCase()!==WYMeditor.TABLE){selectedNode=selectedNode.parentNode}}if(selectedNode.nodeName.toLowerCase()===WYMeditor.LI){jQuery(selectedNode).append(table)}else{jQuery(selectedNode).after(table)}}else{jQuery(container).after(table)}wym._afterInsertTable(table);wym.prepareDocForEditing();wym.registerModification();return table};WYMeditor.editor.prototype._afterInsertTable=function(){};WYMeditor.editor.prototype._listen=function(){var wym=this;jQuery(wym._doc).bind("paste",function(){wym._handlePasteEvent()})};WYMeditor.editor.prototype._handlePasteEvent=function(){var wym=this;window.setTimeout(function(){jQuery(wym.element).trigger(WYMeditor.EVENTS.postBlockMaybeCreated,wym)},20)};WYMeditor.editor.prototype._selectSingleNode=function(node){var wym=this,selection,nodeRange;if(!node){throw"Expected a node"}selection=wym.selection();nodeRange=rangy.createRangyRange();nodeRange.selectNode(node);selection.setSingleRange(nodeRange)};WYMeditor.editor.prototype._initSkin=function(){var wym=this;jQuery(wym._box).addClass("wym_skin_"+wym._options.skin);if(typeof WYMeditor.SKINS[wym._options.skin]!=="undefined"){if(typeof WYMeditor.SKINS[wym._options.skin].init==="function"){WYMeditor.SKINS[wym._options.skin].init(wym)}}else{WYMeditor.console.warn("Chosen skin _"+wym.options.skin+"_ not found.")}};WYMeditor.editor.prototype.body=function(){var wym=this,body;if(!wym._doc.body){throw"The document seems to have no body element."}body=wym._doc.body;if(!body.tagName||body.tagName.toLowerCase()!=="body"){throw"The document's body doesn't seem to be a `body` element."}return body};WYMeditor.editor.prototype.$body=function(){var wym=this,body;body=wym.body();return jQuery(body)};WYMeditor.editor.prototype.doesElementContainSelection=function(element){var wym=this,$element,selectedContainer,$selectedNodes,i,$selectedNodeAncestors,j;if(wym.hasSelection()!==true){return false}$element=jQuery(element);if(wym.selection().isCollapsed===true){selectedContainer=wym.selectedContainer();if(element===selectedContainer){return true}if($element.has(selectedContainer).length>0){return true}return false}$selectedNodes=jQuery(wym._getSelectedNodes());for(i=0;i<$selectedNodes.length;i++){$selectedNodeAncestors=$selectedNodes.eq(i).parents();for(j=0;j<$selectedNodeAncestors.length;j++){if($selectedNodeAncestors[j]===element){return true}}}return false};"use strict";WYMeditor.DocumentStructureManager=function(wym,defaultRootContainer){var dsm=this;dsm._wym=wym;dsm.structureRules=WYMeditor.DocumentStructureManager.DEFAULTS;dsm.setDefaultRootContainer(defaultRootContainer)};jQuery.extend(WYMeditor.DocumentStructureManager,{VALID_DEFAULT_ROOT_CONTAINERS:["p","div"],DEFAULT_ROOT_CONTAINER_TITLES:{p:"Paragraph",div:"Division"},CONTAINERS_BLOCKING_NAVIGATION:["table","blockquote","pre"],DEFAULTS:{defaultRootContainer:"p",notValidRootContainers:["div"],validRootContainers:["p","div","h1","h2","h3","h4","h5","h6","pre","blockquote","table","ol","ul"],convertIfRootContainers:["div"],validListConversionTargetContainers:["p","div","h1","h2","h3","h4","h5","h6","pre","blockquote","td","th"],wrapContentsInList:["td","th"]}});WYMeditor.DocumentStructureManager.prototype.setDefaultRootContainer=function(defaultRootContainer){var dsm=this,validContainers,index,DSManager;if(dsm.structureRules.defaultRootContainer===defaultRootContainer){return}DSManager=WYMeditor.DocumentStructureManager;validContainers=DSManager.VALID_DEFAULT_ROOT_CONTAINERS;index=jQuery.inArray(defaultRootContainer,validContainers);if(index===-1){throw new Error("a defaultRootContainer of '"+defaultRootContainer+"' is not supported")}dsm.structureRules.defaultRootContainer=defaultRootContainer;dsm.structureRules.notValidRootContainers=WYMeditor.DocumentStructureManager.VALID_DEFAULT_ROOT_CONTAINERS;dsm.structureRules.notValidRootContainers.splice(index,1);dsm._adjustDefaultRootContainerUI()};WYMeditor.DocumentStructureManager.prototype._adjustDefaultRootContainerUI=function(){var dsm=this,wym=dsm._wym,defaultRootContainer=dsm.structureRules.defaultRootContainer,$containerItems,$containerLink,$newContainerItem,containerName,newContainerLinkNeeded,newContainerLinkHtml,i,DSManager;$containerItems=jQuery(wym._box).find(wym._options.containersSelector).find("li");newContainerLinkNeeded=true;for(i=0;i<$containerItems.length;++i){$containerLink=$containerItems.eq(i).find("a");containerName=$containerLink.attr("name").toLowerCase();if(jQuery.inArray(containerName,dsm.structureRules.notValidRootContainers)>-1){$containerItems.eq(i).remove()}if(containerName===defaultRootContainer){newContainerLinkNeeded=false}}if(newContainerLinkNeeded){newContainerLinkHtml=wym._options.containersItemHtml;newContainerLinkHtml=WYMeditor.Helper.replaceAllInStr(newContainerLinkHtml,WYMeditor.CONTAINER_NAME,defaultRootContainer.toUpperCase());DSManager=WYMeditor.DocumentStructureManager;newContainerLinkHtml=WYMeditor.Helper.replaceAllInStr(newContainerLinkHtml,WYMeditor.CONTAINER_TITLE,DSManager.DEFAULT_ROOT_CONTAINER_TITLES[defaultRootContainer]);newContainerLinkHtml=WYMeditor.Helper.replaceAllInStr(newContainerLinkHtml,WYMeditor.CONTAINER_CLASS,"wym_containers_"+defaultRootContainer);$newContainerItem=jQuery(newContainerLinkHtml);$containerItems=jQuery(wym._box).find(wym._options.containersSelector).find("li");$containerItems.eq(0).before($newContainerItem);$newContainerItem.find("a").click(function(){var button=this;wym.setRootContainer(jQuery(button).attr(WYMeditor.NAME));return false})}};"use strict";WYMeditor.ImageHandler=function(wym){var ih=this;ih._wym=wym;ih._$resizeHandle=ih._createResizeHandle();ih._$currentImageMarker=null;ih._$currentImg=null;ih._resizingNow=false;ih._imgDragDropAllowed=WYMeditor.ImageHandler._isImgDragDropAllowed();ih._addEventListeners();return ih};WYMeditor.ImageHandler._isImgDragDropAllowed=function(){var browser=jQuery.browser;if(browser.msie){if(browser.versionNumber<=9){return false}}return true};WYMeditor.ImageHandler._RESIZE_HANDLE_HR_HTML=jQuery("<hr>").addClass(WYMeditor.EDITOR_ONLY_CLASS).css({margin:0,padding:0}).attr("outerHTML");WYMeditor.ImageHandler._RESIZE_HANDLE_INNER_HTML=["drag this to resize","click on image to select"].join(WYMeditor.ImageHandler._RESIZE_HANDLE_HR_HTML);WYMeditor.ImageHandler._IMAGE_HIGHLIGHT_COLOR="yellow";WYMeditor.ImageHandler.prototype._createResizeHandle=function(){var $handle=jQuery("<div/>");$handle.attr("contentEditable","false");$handle.html(WYMeditor.ImageHandler._RESIZE_HANDLE_INNER_HTML);$handle.addClass(WYMeditor.RESIZE_HANDLE_CLASS).addClass(WYMeditor.EDITOR_ONLY_CLASS);$handle.css({margin:"0",padding:"0",cursor:"row-resize","text-align":"center",position:"absolute","background-color":WYMeditor.ImageHandler._IMAGE_HIGHLIGHT_COLOR,"background-image":"none","min-width":"13em",width:"100%"});return $handle};WYMeditor.ImageHandler.prototype._getCurrentImageMarker=function(){var ih=this;if(!ih._$currentImageMarker||!ih._$currentImageMarker.length){ih._$currentImageMarker=ih._createCurrentImageMarker()}return ih._$currentImageMarker};WYMeditor.ImageHandler._IMAGE_MARKER_CLASS="wym-image-marker";WYMeditor.ImageHandler.prototype._createCurrentImageMarker=function(){return jQuery("<div/>").addClass(WYMeditor.EDITOR_ONLY_CLASS).addClass(WYMeditor.ImageHandler._IMAGE_MARKER_CLASS).hide()};WYMeditor.ImageHandler.prototype._addEventListeners=function(){var ih=this;var $doc=jQuery(ih._wym._doc);$doc.delegate("img","mouseover",ih._onImgMouseover.bind(ih));$doc.delegate("img","click",ih._onImgClick.bind(ih));$doc.delegate("."+WYMeditor.RESIZE_HANDLE_CLASS,"mousedown",ih._onResizeHandleMousedown.bind(ih));$doc.delegate("img","mousedown",ih._onImgMousedown.bind(ih));$doc.delegate("img","dragstart",ih._onImgDragstart.bind(ih));$doc.bind("mousemove",ih._onMousemove.bind(ih));$doc.bind("mouseup",ih._onMouseup.bind(ih));ih._edited=new WYMeditor.EXTERNAL_MODULES.Edited($doc[0],function(){},ih._onAnyNativeEdit.bind(ih));$doc.delegate("."+WYMeditor.RESIZE_HANDLE_CLASS,"click dblclick",ih._onResizeHandleClickDblclick.bind(ih));if(false){ih._wym.$body().delegate("*",WYMeditor.Helper.getAllEventTypes(ih._wym.$body()[0]),ih._onAllEvents.bind(ih))}};WYMeditor.ImageHandler.prototype._onImgMouseover=function(evt){var ih=this;var $img=jQuery(evt.target);if(!$img.data("cE disabled")&&jQuery.browser.msie){$img.attr("contentEditable","false");$img.data("cE disabled",true)}ih._setImgCursor($img)};WYMeditor.ImageHandler.prototype._setImgCursor=function($img){var ih=this;if(ih._wym.getSelectedImage()!==$img[0]){$img.css("cursor","pointer");return}if(ih._imgDragDropAllowed){$img.css("cursor","move")}else{$img.css("cursor","default")}};WYMeditor.ImageHandler.prototype._onImgClick=function(evt){var ih=this;ih._selectImage(evt.target);ih._indicateOnResizeHandleThatImageIsSelected();return false};WYMeditor.ImageHandler.prototype._selectImage=function(img){var ih=this;var $img=jQuery(img);if(jQuery.browser.msie&&jQuery.browser.versionNumber===8){setTimeout(function(){ih._wym._selectSingleNode(img)},0)}else{ih._wym._selectSingleNode(img)}ih._setImgCursor($img)};WYMeditor.ImageHandler.prototype._indicateOnResizeHandleThatImageIsSelected=function(){var ih=this;var indication="image is selected";if(ih._imgDragDropAllowed){indication=[indication,"drag image to move it"].join(WYMeditor.ImageHandler._RESIZE_HANDLE_HR_HTML)}ih._$resizeHandle.css("font-weight","bold").html(indication);setTimeout(function(){ih._$resizeHandle.css("font-weight","normal").html(WYMeditor.ImageHandler._RESIZE_HANDLE_INNER_HTML)},1e3)};WYMeditor.ImageHandler.prototype._placeResizeHandleOnImg=function(img){var ih=this;var IMAGE_PADDING="0.8em";var $img=jQuery(img);ih._$currentImg=$img;ih._getCurrentImageMarker().insertAfter($img);$img.css({"background-color":WYMeditor.ImageHandler._IMAGE_HIGHLIGHT_COLOR,"padding-top":IMAGE_PADDING,"padding-right":IMAGE_PADDING,"padding-bottom":"0","padding-left":IMAGE_PADDING,"margin-top":"-"+IMAGE_PADDING,"margin-right":"-"+IMAGE_PADDING,"margin-bottom":"0","margin-left":"-"+IMAGE_PADDING});ih._$resizeHandle.prependTo(ih._wym.$body());ih._correctResizeHandleOffsetAndWidth();ih._$resizeHandle.show()};WYMeditor.ImageHandler.prototype._correctResizeHandleOffsetAndWidth=function(){var ih=this;ih._$resizeHandle.css("max-width",ih._$currentImg.outerWidth());var offset=ih._$currentImg.offset();ih._$resizeHandle.css("left",offset.left);var yAfterImg=offset.top+ih._$currentImg.outerHeight();if(jQuery.browser.msie){yAfterImg--}ih._$resizeHandle.css("top",yAfterImg)};WYMeditor.ImageHandler.prototype._onResizeHandleMousedown=function(evt){var ih=this;if(!ih._resizingNow){ih._startResize(evt.clientY)}return false};WYMeditor.ImageHandler.prototype._startResize=function(startMouseY){var ih=this;ih._startMouseY=startMouseY;ih._$currentImg.data("StartHeight",ih._$currentImg.height());ih._resizingNow=true};WYMeditor.ImageHandler.prototype._onMousemove=function(evt){var ih=this;if(!evt.target.tagName){return}if(ih._resizingNow){ih._resizeImage(evt.clientY);return false}if(evt.target.tagName.toLowerCase()==="img"&&!ih._isResizeHandleAttached()){ih._placeResizeHandleOnImg(evt.target);return false}if(!ih._isResizeHandleAttached()){return}if(!jQuery(evt.target).hasClass(WYMeditor.EDITOR_ONLY_CLASS)&&!ih._isCurrentImg(evt.target)){ih._detachResizeHandle();return}if(!ih._isCurrentImgAtMarker()){ih._detachResizeHandle();return}};WYMeditor.ImageHandler.prototype._isCurrentImgAtMarker=function(){var ih=this;var $marker=ih._$currentImageMarker;if(!$marker.length){return false}var $img=ih._$currentImg;var $imgPrevToMarker=$marker.prev("img");if($img.length&&$imgPrevToMarker.length&&$imgPrevToMarker[0]===$img[0]){return true}return false};WYMeditor.ImageHandler.prototype._isResizeHandle=function(elem){return jQuery(elem).hasClass(WYMeditor.RESIZE_HANDLE_CLASS)};WYMeditor.ImageHandler.prototype._isCurrentImg=function(img){var ih=this;return img===ih._$currentImg[0]};WYMeditor.ImageHandler.prototype._resizeImage=function(currentMouseY){var ih=this;var $img=ih._$currentImg;var dimensionsRatio=$img.data("DimensionsRatio");if(!dimensionsRatio){var originalHeight=$img.height();var originalWidth=$img.width();dimensionsRatio=originalWidth/originalHeight;$img.data("DimensionsRatio",dimensionsRatio)}var startHeight=$img.data("StartHeight");var newHeight=startHeight-ih._startMouseY+currentMouseY;newHeight=newHeight>0?newHeight:0;var newWidth=newHeight*dimensionsRatio;$img.attr("height",newHeight);$img.attr("width",newWidth);ih._correctResizeHandleOffsetAndWidth()};WYMeditor.ImageHandler.prototype._onMouseup=function(){var ih=this;if(ih._resizingNow){ih._stopResize()}};WYMeditor.ImageHandler.prototype._stopResize=function(){var ih=this;ih._resizingNow=false;ih._startMouseY=null;ih._wym.registerModification()};WYMeditor.ImageHandler.prototype._onImgMousedown=function(evt){var ih=this;if(jQuery.browser.msie&&jQuery.browser.versionNumber===11){ih._selectImage(evt.target)}return ih._imgDragDropAllowed};WYMeditor.ImageHandler.prototype._onAnyNativeEdit=function(){var ih=this;setTimeout(ih._handlePossibleModification.bind(ih),0)};WYMeditor.ImageHandler.prototype._handlePossibleModification=function(){var ih=this;if(!ih._isResizeHandleAttached()){return}if(!ih._isCurrentImgAtMarker()){ih._detachResizeHandle();return}ih._correctResizeHandleOffsetAndWidth()};WYMeditor.ImageHandler.prototype._isResizeHandleAttached=function(){var ih=this;var $handle=ih._getResizeHandle();return $handle&&$handle.css("display")!=="none"};WYMeditor.ImageHandler.prototype._getResizeHandle=function(){var ih=this;var $handle=ih._wym.$body().find("."+WYMeditor.RESIZE_HANDLE_CLASS);return $handle.length?$handle:false};WYMeditor.ImageHandler.prototype._detachResizeHandle=function(){var ih=this;ih._$currentImageMarker.detach();if(ih._$currentImg.height()>=16&&ih._$currentImg.width()>=16){ih._$currentImg.css({padding:0,margin:0})}ih._$currentImg=null;ih._$resizeHandle.hide()};WYMeditor.ImageHandler.prototype._onImgDragstart=function(){var ih=this;ih._detachResizeHandle()};WYMeditor.ImageHandler.prototype._onResizeHandleClickDblclick=function(){var ih=this;if(jQuery.browser.msie&&jQuery.browser.versionNumber===11){ih._wym.deselect()}return false};WYMeditor.ImageHandler.prototype._isAnImgSelected=function(message){var ih=this;message=message.toUpperCase();function check(prefix){var result=ih._wym.getSelectedImage()?"***YES***":"";prefix=prefix?prefix+" ":"";WYMeditor.console.log(prefix+message+" "+result)}check("sync");setTimeout(function(){check("async")},0)};WYMeditor.ImageHandler._onAllEvents=function(evt){var ih=this;ih._isAnImgSelected([evt.type,evt.target.tagName,jQuery(evt.target).attr("className")].join(" "))};"use strict";WYMeditor.WymClassGecko=function(wym){var wymClassGecko=this;wymClassGecko._wym=wym;wymClassGecko._class="class"};WYMeditor.WymClassGecko.CELL_PLACEHOLDER='<br _moz_dirty="" />';WYMeditor.WymClassGecko.NEEDS_CELL_FIX=parseInt(jQuery.browser.version,10)===1&&jQuery.browser.version>="1.9.1"&&jQuery.browser.version<"2.0";WYMeditor.WymClassGecko.prototype._docEventQuirks=function(){var wym=this;var $doc=jQuery(wym._doc);$doc.keyup(wym._keyup.bind(wym));$doc.focus(function(){wym.undoRedo._onBodyFocus()});$doc.click(wym._click.bind(wym))};WYMeditor.WymClassGecko.prototype._keyup=function(evt){var wym=this,container,defaultRootContainer,notValidRootContainers,name,parentName;notValidRootContainers=wym.documentStructureManager.structureRules.notValidRootContainers;defaultRootContainer=wym.documentStructureManager.structureRules.defaultRootContainer;container=null;if(!wym.keyCanCreateBlockElement(evt.which)&&evt.which!==WYMeditor.KEY_CODE.CTRL&&evt.which!==WYMeditor.KEY_CODE.COMMAND&&!evt.metaKey&&!evt.ctrlKey){container=wym.selectedContainer();name=container.tagName.toLowerCase();if(container.parentNode){parentName=container.parentNode.tagName.toLowerCase()}if(wym.isForbiddenRootContainer(name)){name=parentName}if(name===WYMeditor.BODY||jQuery.inArray(name,notValidRootContainers)>-1&&parentName===WYMeditor.BODY){wym._exec(WYMeditor.EXEC_COMMANDS.FORMAT_BLOCK,defaultRootContainer);wym.prepareDocForEditing()}}if(wym.keyCanCreateBlockElement(evt.which)){container=wym.selectedContainer();name=container.tagName.toLowerCase();if(container.parentNode){parentName=container.parentNode.tagName.toLowerCase()}if(jQuery.inArray(name,notValidRootContainers)>-1&&parentName===WYMeditor.BODY){wym._exec(WYMeditor.EXEC_COMMANDS.FORMAT_BLOCK,defaultRootContainer)}wym._handlePotentialEnterInEmptyNestedLi(evt.which,container);wym.prepareDocForEditing()}};WYMeditor.WymClassGecko.prototype._click=function(){var wym=this,container=wym.selectedContainer(),sel;if(WYMeditor.WymClassGecko.NEEDS_CELL_FIX===true){if(container&&container.tagName.toLowerCase()===WYMeditor.TR){jQuery(WYMeditor.TD,wym._doc.body).append(WYMeditor.WymClassGecko.CELL_PLACEHOLDER)}}if(container&&container.tagName.toLowerCase()===WYMeditor.BODY){sel=wym.selection();if(sel.isCollapsed===true){wym._exec(WYMeditor.EXEC_COMMANDS.FORMAT_BLOCK,WYMeditor.P)}}};WYMeditor.WymClassGecko.prototype._designModeQuirks=function(){var wym=this;try{wym._doc.execCommand("styleWithCSS","",false);wym._doc.execCommand("enableObjectResizing",false,false);wym._doc.execCommand("enableInlineTableEditing",false,false)}catch(e){}};WYMeditor.WymClassGecko.prototype._afterInsertTable=function(table){if(WYMeditor.WymClassGecko.NEEDS_CELL_FIX===true){jQuery(table).find("td").each(function(index,element){jQuery(element).append(WYMeditor.WymClassGecko.CELL_PLACEHOLDER)})}};"use strict";WYMeditor.WymClassWebKit=function(wym){var wymClassWebKit=this;wymClassWebKit._wym=wym;wymClassWebKit._class="class"};WYMeditor.WymClassWebKit.prototype._docEventQuirks=function(){var wym=this;jQuery(wym._doc).bind("keyup",function(evt){wym._keyup(evt)});wym.keyboard.combokeys.bind("shift+enter",function(){wym._exec(WYMeditor.EXEC_COMMANDS.INSERT_LINEBREAK);return false});wym.$body().bind("focus",function(){wym.undoRedo._onBodyFocus()})};WYMeditor.WymClassWebKit.prototype._inListBreakoutDiv=function(evtWhich){var wym=this,$rootContainer=jQuery(wym.getRootContainer());if(evtWhich===WYMeditor.KEY_CODE.ENTER&&$rootContainer.is("div")&&wym.documentStructureManager.defaultRootContainer!=="div"&&$rootContainer.prev("ol, ul").length===1){return true}return false};WYMeditor.WymClassWebKit.prototype._isLiInLiAfterEnter=function(evtWhich){var wym=this,nodeAfterSel=wym.nodeAfterSel(),parentNode,previousSibling,previousSiblingChild,previousPreviousSibling;if(evtWhich!==WYMeditor.KEY_CODE.ENTER){return false}if(!nodeAfterSel){return false}parentNode=nodeAfterSel.parentNode;if(!parentNode){return false}if(typeof parentNode.tagName!=="string"){return false}if(parentNode.tagName.toLowerCase()!=="li"){return false}previousSibling=nodeAfterSel.previousSibling;if(!previousSibling){return false}if(typeof previousSibling.tagName!=="string"){return false}if(previousSibling.tagName.toLowerCase()!=="li"){return false}if(previousSibling.childNodes.length!==1){return false}previousSiblingChild=previousSibling.childNodes[0];if(!previousSiblingChild){return false}if(typeof previousSiblingChild.tagName!=="string"){return false}if(previousSiblingChild.tagName.toLowerCase()!=="br"){return false}previousPreviousSibling=previousSibling.previousSibling;if(!previousPreviousSibling){return false}if(typeof previousPreviousSibling.tagName!=="string"){return false}if(jQuery.inArray(previousPreviousSibling.tagName.toLowerCase(),["ol","ul"])===-1){return false}return true};WYMeditor.WymClassWebKit.prototype._fixLiInLiAfterEnter=function(){var wym=this,nodeAfterSel=wym.nodeAfterSel(),$errorLi=jQuery(nodeAfterSel.previousSibling),$parentLi=$errorLi.parent("li"),errorLiIndex=$parentLi.contents().index($errorLi),$contentsAfterErrorLi=$parentLi.contents().slice(errorLiIndex+1);$errorLi.remove();$parentLi.after("<li><br /></li>");$parentLi.next().append($contentsAfterErrorLi);wym.setCaretBefore($parentLi.next("li").children().first("br")[0])};WYMeditor.WymClassWebKit.prototype._keyup=function(evt){var wym=this,container,defaultRootContainer,notValidRootContainers,name,parentName,rootContainer;notValidRootContainers=wym.documentStructureManager.structureRules.notValidRootContainers;defaultRootContainer=wym.documentStructureManager.structureRules.defaultRootContainer;if(jQuery.browser.version<534.1){if(evt.which===WYMeditor.KEY_CODE.ENTER&&evt.shiftKey){wym._exec("InsertLineBreak")}}if(!wym.keyCanCreateBlockElement(evt.which)&&evt.which!==WYMeditor.KEY_CODE.CTRL&&evt.which!==WYMeditor.KEY_CODE.COMMAND&&!evt.metaKey&&!evt.ctrlKey){container=wym.selectedContainer();name=container.tagName.toLowerCase();if(container.parentNode){parentName=container.parentNode.tagName.toLowerCase()}if(wym.isForbiddenRootContainer(name)){name=parentName}if(name===WYMeditor.BODY||jQuery.inArray(name,notValidRootContainers)>-1&&parentName===WYMeditor.BODY){wym._exec(WYMeditor.EXEC_COMMANDS.FORMAT_BLOCK,defaultRootContainer);wym.prepareDocForEditing()}}if(wym.keyCanCreateBlockElement(evt.which)){container=wym.selectedContainer();name=container.tagName.toLowerCase();if(container.parentNode){parentName=container.parentNode.tagName.toLowerCase()}if(jQuery.inArray(name,notValidRootContainers)>-1&&parentName===WYMeditor.BODY){wym._exec(WYMeditor.EXEC_COMMANDS.FORMAT_BLOCK,defaultRootContainer);container=wym.selectedContainer()}if(wym._isLiInLiAfterEnter(evt.which,container)){wym._fixLiInLiAfterEnter();container=wym.selectedContainer();return}wym._handlePotentialEnterInEmptyNestedLi(evt.which,container);if(wym._inListBreakoutDiv(evt.which)){rootContainer=wym.switchTo(wym.getRootContainer(),defaultRootContainer);wym.setCaretIn(rootContainer)}wym.prepareDocForEditing()}};"use strict";WYMeditor.WymClassBlink=function(wym){var wymClassBlink=this;wymClassBlink._wym=wym};jQuery.extend(WYMeditor.WymClassBlink.prototype,WYMeditor.WymClassWebKit.prototype);"use strict";WYMeditor.WymClassSafari=function(wym){var wymClassSafari=this;wymClassSafari._wym=wym};jQuery.extend(WYMeditor.WymClassSafari.prototype,WYMeditor.WymClassWebKit.prototype);"use strict";WYMeditor.WymClassTridentPre7=function(wym){var wymClassTridentPre7=this;wymClassTridentPre7._wym=wym;wymClassTridentPre7._class="className"};WYMeditor.WymClassTridentPre7.prototype._onEditorIframeLoad=function(wym){wym._assignWymDoc();if(wym._isDesignModeOn()===false){wym._doc.designMode="On"}else{wym._afterDesignModeOn()}};WYMeditor.WymClassTridentPre7.prototype._assignWymDoc=function(){var wym=this;wym._doc=wym._iframe.contentWindow.document};WYMeditor.WymClassTridentPre7.prototype._docEventQuirks=function(){var wym=this;wym._doc.onbeforedeactivate=function(){wym._saveCaret()};jQuery(wym._doc).bind("keyup",function(evt){wym._keyup(evt)});wym._doc.onkeyup=function(){wym._saveCaret()};wym._doc.onclick=function(){wym._saveCaret()};wym.$body().bind("focus",function(){wym.undoRedo._onBodyFocus()});wym._doc.body.onbeforepaste=function(){wym._iframe.contentWindow.event.returnValue=false};wym._doc.body.onpaste=function(){wym._iframe.contentWindow.event.returnValue=false;wym.paste(window.clipboardData.getData("Text"))};wym.$body().bind("dragend",function(evt){if(evt.target.tagName.toLowerCase()===WYMeditor.IMG){wym.deselect()}});wym._doc.oncontrolselect=function(){return false}};WYMeditor.WymClassTridentPre7.prototype._setButtonsUnselectable=function(){var wym=this,$buttons=wym.get$Buttons();$buttons.attr("unselectable","on")};WYMeditor.WymClassTridentPre7.prototype._uiQuirks=function(){var wym=this;if(jQuery.browser.versionNumber===8){wym._setButtonsUnselectable()}};WYMeditor.WymClassTridentPre7.prototype._saveCaret=function(){var wym=this,nativeSelection=wym._doc.selection;if(nativeSelection.type==="None"){return}wym._doc.caretPos=nativeSelection.createRange()};WYMeditor.WymClassTridentPre7.prototype._wrapWithContainer=function(node,containerType){var wym=this,$wrappedNode,selection,range;$wrappedNode=jQuery(node).wrap("<"+containerType+" />");selection=wym.selection();range=rangy.createRange(wym._doc);range.selectNodeContents($wrappedNode[0]);range.collapse();selection.setSingleRange(range)};WYMeditor.WymClassTridentPre7.prototype._keyup=function(evt){var wym=this,container,defaultRootContainer,notValidRootContainers,name,parentName,forbiddenMainContainer=false,selectedNode;notValidRootContainers=wym.documentStructureManager.structureRules.notValidRootContainers;defaultRootContainer=wym.documentStructureManager.structureRules.defaultRootContainer;if(!wym.keyCanCreateBlockElement(evt.which)&&evt.which!==WYMeditor.KEY_CODE.CTRL&&evt.which!==WYMeditor.KEY_CODE.COMMAND&&!evt.metaKey&&!evt.ctrlKey){container=wym.selectedContainer();selectedNode=wym.selection().focusNode;if(container!==null){name=container.tagName.toLowerCase()}if(container.parentNode){parentName=container.parentNode.tagName.toLowerCase()}if(wym.isForbiddenRootContainer(name)){name=parentName;forbiddenMainContainer=true}if(name===WYMeditor.BODY&&selectedNode.nodeName==="#text"){if(forbiddenMainContainer){selectedNode=selectedNode.parentNode}wym._wrapWithContainer(selectedNode,defaultRootContainer);wym.prepareDocForEditing()}if(jQuery.inArray(name,notValidRootContainers)>-1&&parentName===WYMeditor.BODY){wym.switchTo(container,defaultRootContainer);wym.prepareDocForEditing()}}if(wym.keyCanCreateBlockElement(evt.which)){container=wym.selectedContainer();name=container.tagName.toLowerCase();if(container.parentNode){parentName=container.parentNode.tagName.toLowerCase()}if(jQuery.inArray(name,notValidRootContainers)>-1&&parentName===WYMeditor.BODY){wym.switchTo(container,defaultRootContainer)}wym._handlePotentialEnterInEmptyNestedLi(evt.which,container);if(evt.which===WYMeditor.KEY_CODE.BACKSPACE&&jQuery.browser.versionNumber===8&&container.parentNode&&(parentName==="ul"||parentName==="ol")){wym._fixInvalidListNesting(container)}wym.prepareDocForEditing()}};"use strict";WYMeditor.WymClassTrident7=function(wym){var wymClassTrident7=this;wymClassTrident7._wym=wym;wymClassTrident7._class="class"};jQuery.extend(WYMeditor.WymClassTrident7.prototype,WYMeditor.WymClassGecko.prototype);jQuery.copyPropsFromObjectToObject(WYMeditor.WymClassTridentPre7.prototype,WYMeditor.WymClassTrident7.prototype,["_exec","_keyup","_wrapWithContainer"]);WYMeditor.WymClassTrident7.prototype.rawHtml=function(html){var wym=this;if(typeof html==="string"){wym._doc.designMode="off";wym.$body().html(html);if(wym._isDesignModeOn()!==true){wym._enableDesignModeOnDocument()}}else{return wym.$body().html()}return false};WYMeditor.WymClassTrident7.prototype._docEventQuirks=function(){var wym=this;jQuery(wym._doc).bind("keyup",function(evt){wym._keyup(evt)});wym.$body().bind("dragend",function(evt){if(evt.target.tagName.toLowerCase()===WYMeditor.IMG){wym.deselect()}});wym.$body().bind("focus",function(){wym.undoRedo._onBodyFocus()})};(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.foo=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var _=require("lodash");var clone=require("udc");var xtend=require("xtend");module.exports=function(initial,options){var self=this;self.options=xtend({limit:null},options);self.notObjError=new Error("requires a plain object");if(!initial||!_.isPlainObject(initial)){throw self.notObjError}self.current=clone(initial);self.changesets={backward:[],forward:[]}};var proto=module.exports.prototype;proto.add=require("./prototype/add");proto.get=require("./prototype/get");proto.lengthBackward=require("./prototype/length-backward");proto.lengthForward=require("./prototype/length-forward");proto.backward=require("./prototype/backward");proto.forward=require("./prototype/forward");proto.move=require("./prototype/move");proto.forgetAllInDirection=require("./prototype/forget-all-in-direction");proto.forgetAllBackward=require("./prototype/forget-all-backward");proto.forgetAllForward=require("./prototype/forget-all-forward")},{"./prototype/add":2,"./prototype/backward":3,"./prototype/forget-all-backward":4,"./prototype/forget-all-forward":5,"./prototype/forget-all-in-direction":6,"./prototype/forward":7,"./prototype/get":8,"./prototype/length-backward":9,"./prototype/length-forward":10,"./prototype/move":11,lodash:14,udc:15,xtend:16}],2:[function(require,module,exports){"use strict";var _=require("lodash");var diff=require("changeset");var clone=require("udc");module.exports=function(obj){var self=this;if(!obj||!_.isPlainObject(obj)){throw self.notObjError}if(self.lengthBackward()===self.options.limit){self.changesets.backward.shift()}self.changesets.backward.push(diff(obj,self.current));self.current=clone(obj);self.changesets.forward=[]}},{changeset:12,lodash:14,udc:15}],3:[function(require,module,exports){"use strict";module.exports=function(){var self=this;self.move("backward")}},{}],4:[function(require,module,exports){"use strict";module.exports=function(){var self=this;self.forgetAllInDirection("backward")}},{}],5:[function(require,module,exports){"use strict";module.exports=function(){var self=this;self.forgetAllInDirection("forward")}},{}],6:[function(require,module,exports){var forgetAllInDirection=function(direction){var self=this;var changesets=self.changesets;if(!changesets.hasOwnProperty(direction)){throw new Error("there is no such direction")}changesets[direction]=[]};module.exports=forgetAllInDirection},{}],7:[function(require,module,exports){"use strict";module.exports=function(){var self=this;self.move("forward")}},{}],8:[function(require,module,exports){"use strict";var clone=require("udc");module.exports=function(){var self=this;return clone(self.current)}},{udc:15}],9:[function(require,module,exports){"use strict";module.exports=function(){var self=this;return self.changesets.backward.length}},{}],10:[function(require,module,exports){"use strict";module.exports=function(){var self=this;return self.changesets.forward.length}},{}],11:[function(require,module,exports){"use strict";var diff=require("changeset");var apply=diff.apply;var without=require("lodash").without;var move=function(direction){var self=this;if(!direction||!self.changesets.hasOwnProperty(direction)){throw new Error("Invalid direction")}var directions=Object.getOwnPropertyNames(self.changesets);var reverseDirection=without(directions,direction)[0];var changesets=self.changesets[direction];var reverseChangesets=self.changesets[reverseDirection];if(changesets.length===0){throw new Error("There's no going "+direction)}var newCurrent=apply(changesets.pop(),self.current);reverseChangesets.push(diff(newCurrent,self.current));self.current=newCurrent};module.exports=move},{changeset:12,lodash:14}],12:[function(require,module,exports){var _=require("underscore");module.exports=diff;function diff(old,new_){var changes=[];changes=changes.concat(compare([],old,new_));comparing=[];return changes}function delCheck(op){if(op.type==="put"&&op.value===undefined){op.type="del";delete op.value}return op}var comparing=[];function compare(path,old,new_){var changes=[];if(old!==null&&new_!==null&&typeof old==="object"&&!_.contains(comparing,old)){comparing.push(old);var oldKeys=Object.keys(old);var newKeys=Object.keys(new_);var sameKeys=_.intersection(oldKeys,newKeys);sameKeys.forEach(function(k){var childChanges=compare(path.concat(k),old[k],new_[k]);changes=changes.concat(childChanges)});var delKeys=_.difference(oldKeys,newKeys);delKeys.forEach(function(k){changes.push({type:"del",key:path.concat(k)})});var newKeys_=_.difference(newKeys,oldKeys);newKeys_.forEach(function(k){changes.push(delCheck({type:"put",key:path.concat(k),value:new_[k]}))})}else if(old!==new_){changes.push(delCheck({type:"put",key:path,value:new_}))}return changes}module.exports.apply=apply;function apply(changes,target,modify){var obj,clone;if(modify){obj=target}else{clone=require("udc");obj=clone(target)}changes.forEach(function(ch){var ptr,keys,len;switch(ch.type){case"put":ptr=obj;keys=ch.key;len=keys.length;if(len){keys.forEach(function(prop,i){if(!(prop in ptr)){ptr[prop]={}}if(i<len-1){ptr=ptr[prop]}else{ptr[prop]=ch.value}})}else{obj=ch.value}break;case"del":ptr=obj;keys=ch.key;len=keys.length;if(len){keys.forEach(function(prop,i){if(!(prop in ptr)){ptr[prop]={}}if(i<len-1){ptr=ptr[prop]}else{delete ptr[prop]}})}else{obj=null}break}});return obj}},{udc:15,underscore:13}],13:[function(require,module,exports){(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=_}exports._=_}else{root._=_}_.VERSION="1.4.4";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context)}else if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++){if(iterator.call(context,obj[i],i,obj)===breaker)return}}else{for(var key in obj){if(_.has(obj,key)){if(iterator.call(context,obj[key],key,obj)===breaker)return}}}};_.map=_.collect=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)});return results};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduce&&obj.reduce===nativeReduce){if(context)iterator=_.bind(iterator,context);return initial?obj.reduce(iterator,memo):obj.reduce(iterator)}each(obj,function(value,index,list){if(!initial){memo=value;initial=true}else{memo=iterator.call(context,memo,value,index,list)}});if(!initial)throw new TypeError(reduceError);return memo};_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context)iterator=_.bind(iterator,context);return initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator)}var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}each(obj,function(value,index,list){index=keys?keys[--length]:--length;if(!initial){memo=obj[index];initial=true}else{memo=iterator.call(context,memo,obj[index],index,list)}});if(!initial)throw new TypeError(reduceError);return memo};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeFilter&&obj.filter===nativeFilter)return obj.filter(iterator,context);each(obj,function(value,index,list){if(iterator.call(context,value,index,list))results[results.length]=value});return results};_.reject=function(obj,iterator,context){return _.filter(obj,function(value,index,list){return!iterator.call(context,value,index,list)},context)};_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=true;if(obj==null)return result;if(nativeEvery&&obj.every===nativeEvery)return obj.every(iterator,context);each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker});return!!result};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=false;if(obj==null)return result;if(nativeSome&&obj.some===nativeSome)return obj.some(iterator,context);each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker});return!!result};_.contains=_.include=function(obj,target){if(obj==null)return false;if(nativeIndexOf&&obj.indexOf===nativeIndexOf)return obj.indexOf(target)!=-1;return any(obj,function(value){return value===target})};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})};_.where=function(obj,attrs,first){if(_.isEmpty(attrs))return first?null:[];return _[first?"find":"filter"](obj,function(value){for(var key in attrs){if(attrs[key]!==value[key])return false}return true})};_.findWhere=function(obj,attrs){return _.where(obj,attrs,true)};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.max.apply(Math,obj)}if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity,value:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>=result.computed&&(result={value:value,computed:computed})});return result.value};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.min.apply(Math,obj)}if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity,value:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})});return result.value};_.shuffle=function(obj){var rand;var index=0;var shuffled=[];each(obj,function(value){rand=_.random(index++);shuffled[index-1]=shuffled[rand];shuffled[rand]=value});return shuffled};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value]}};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index<right.index?-1:1}),"value")};var group=function(obj,value,context,behavior){var result={};var iterator=lookupIterator(value||_.identity);each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)});return result};_.groupBy=function(obj,value,context){return group(obj,value,context,function(result,key,value){(_.has(result,key)?result[key]:result[key]=[]).push(value)})};_.countBy=function(obj,value,context){return group(obj,value,context,function(result,key){if(!_.has(result,key))result[key]=0;result[key]++})};_.sortedIndex=function(array,obj,iterator,context){iterator=iterator==null?_.identity:lookupIterator(iterator);var value=iterator.call(context,obj);var low=0,high=array.length;while(low<high){var mid=low+high>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low};_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(obj.length===+obj.length)return _.map(obj,_.identity);return _.values(obj)};_.size=function(obj){if(obj==null)return 0;return obj.length===+obj.length?obj.length:_.keys(obj).length};_.first=_.head=_.take=function(array,n,guard){if(array==null)return void 0;return n!=null&&!guard?slice.call(array,0,n):array[0]};_.initial=function(array,n,guard){return slice.call(array,0,array.length-(n==null||guard?1:n))};_.last=function(array,n,guard){if(array==null)return void 0;if(n!=null&&!guard){return slice.call(array,Math.max(array.length-n,0))}else{return array[array.length-1]}};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,output){each(input,function(value){if(_.isArray(value)){shallow?push.apply(output,value):flatten(value,shallow,output)}else{output.push(value)}});return output};_.flatten=function(array,shallow){return flatten(array,shallow,[])};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iterator,context){if(_.isFunction(isSorted)){context=iterator;iterator=isSorted;isSorted=false}var initial=iterator?_.map(array,iterator,context):array;var results=[];var seen=[];each(initial,function(value,index){if(isSorted?!index||seen[seen.length-1]!==value:!_.contains(seen,value)){seen.push(value);results.push(array[index])}});return results};_.union=function(){return _.uniq(concat.apply(ArrayProto,arguments))};_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})};_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value)})};_.zip=function(){var args=slice.call(arguments);var length=_.max(_.pluck(args,"length"));var results=new Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(args,""+i)}return results};_.object=function(list,values){if(list==null)return{};var result={};for(var i=0,l=list.length;i<l;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i=0,l=array.length;if(isSorted){if(typeof isSorted=="number"){i=isSorted<0?Math.max(0,l+isSorted):isSorted}else{i=_.sortedIndex(array,item);return array[i]===item?i:-1}}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;i<l;i++)if(array[i]===item)return i;return-1};_.lastIndexOf=function(array,item,from){if(array==null)return-1;var hasIndex=from!=null;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf){return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item)}var i=hasIndex?from:array.length;while(i--)if(array[i]===item)return i;return-1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(len);while(idx<len){range[idx++]=start;start+=step}return range};_.bind=function(func,context){if(func.bind===nativeBind&&nativeBind)return nativeBind.apply(func,slice.call(arguments,1));var args=slice.call(arguments,2);return function(){return func.apply(context,args.concat(slice.call(arguments)))}};_.partial=function(func){var args=slice.call(arguments,1);return function(){return func.apply(this,args.concat(slice.call(arguments)))}};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length===0)funcs=_.functions(obj);each(funcs,function(f){obj[f]=_.bind(obj[f],obj)});return obj};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))};_.throttle=function(func,wait){var context,args,timeout,result;var previous=0;var later=function(){previous=new Date;timeout=null;result=func.apply(context,args)};return function(){var now=new Date;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args)}else if(!timeout){timeout=setTimeout(later,remaining)}return result}};_.debounce=function(func,wait,immediate){var timeout,result;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)result=func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)result=func.apply(context,args);return result}};_.once=function(func){var ran=false,memo;return function(){if(ran)return memo;ran=true;memo=func.apply(this,arguments);func=null;return memo}};_.wrap=function(func,wrapper){return function(){var args=[func];push.apply(args,arguments);return wrapper.apply(this,args)}};_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)]}return args[0]}};_.after=function(times,func){if(times<=0)return func();return function(){if(--times<1){return func.apply(this,arguments)}}};_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)if(_.has(obj,key))keys[keys.length]=key;return keys};_.values=function(obj){var values=[];for(var key in obj)if(_.has(obj,key))values.push(obj[key]);return values};_.pairs=function(obj){var pairs=[];for(var key in obj)if(_.has(obj,key))pairs.push([key,obj[key]]);return pairs};_.invert=function(obj){var result={};for(var key in obj)if(_.has(obj,key))result[obj[key]]=key;return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};_.extend=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){obj[prop]=source[prop]}}});return obj};_.pick=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));each(keys,function(key){if(key in obj)copy[key]=obj[key]});return copy};_.omit=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj){if(!_.contains(keys,key))copy[key]=obj[key]}return copy};_.defaults=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){if(obj[prop]==null)obj[prop]=source[prop]}}});return obj};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!=toString.call(b))return false;switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return false;var length=aStack.length;while(length--){if(aStack[length]==a)return bStack[length]==b}aStack.push(a);bStack.push(b);var size=0,result=true;if(className=="[object Array]"){size=a.length;result=size==b.length;if(result){while(size--){if(!(result=eq(a[size],b[size],aStack,bStack)))break}}}else{var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)){return false}for(var key in a){if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))break}}if(result){for(key in b){if(_.has(b,key)&&!size--)break}result=!size}}aStack.pop();bStack.pop();return result};_.isEqual=function(a,b){return eq(a,b,[],[])};_.isEmpty=function(obj){if(obj==null)return true;if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(_.has(obj,key))return false;return true};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)=="[object Array]"};_.isObject=function(obj){return obj===Object(obj)};each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]"}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return!!(obj&&_.has(obj,"callee"))}}if(typeof/./!=="function"){_.isFunction=function(obj){return typeof obj==="function"}}_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)=="[object Boolean]"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return hasOwnProperty.call(obj,key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.times=function(n,iterator,context){var accum=Array(n);for(var i=0;i<n;i++)accum[i]=iterator.call(context,i);return accum};_.random=function(min,max){if(max==null){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(method){_[method]=function(string){if(string==null)return"";return(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}});_.result=function(object,property){if(object==null)return null;var value=object[property];return _.isFunction(value)?value.call(object):value};_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,function(match){return"\\"+escapes[match]});if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"}if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"}if(evaluate){source+="';\n"+evaluate+"\n__p+='"}index=offset+match.length;return match});source+="';\n";if(!settings.variable)source="with(obj||{}){\n"+source+"}\n";source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{render=new Function(settings.variable||"obj","_",source)}catch(e){e.source=source;throw e}if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};template.source="function("+(settings.variable||"obj")+"){\n"+source+"}";return template};_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_);each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name=="shift"||name=="splice")&&obj.length===0)delete obj[0];return result.call(this,obj)}});each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}});_.extend(_.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this)},{}],14:[function(require,module,exports){(function(global){(function(){var undefined;var arrayPool=[],objectPool=[];var idCounter=0;var keyPrefix=+new Date+"";var largeArraySize=75;var maxPoolSize=40;var whitespace=" \t\v\fÂ \ufeff"+"\n\r\u2028\u2029"+"áá ââââââââââââ¯âã";var reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var reFlags=/\w*$/;var reFuncName=/^\s*function[ \n\r\t]+\w/;var reInterpolate=/<%=([\s\S]+?)%>/g;var reLeadingSpacesAndZeros=RegExp("^["+whitespace+"]*0+(?=.$)");var reNoMatch=/($^)/;var reThis=/\bthis\b/;var reUnescapedString=/['\n\r\t\u2028\u2029\\]/g;var contextProps=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"];var templateCounter=0;var argsClass="[object Arguments]",arrayClass="[object Array]",boolClass="[object Boolean]",dateClass="[object Date]",funcClass="[object Function]",numberClass="[object Number]",objectClass="[object Object]",regexpClass="[object RegExp]",stringClass="[object String]";var cloneableClasses={};cloneableClasses[funcClass]=false;cloneableClasses[argsClass]=cloneableClasses[arrayClass]=cloneableClasses[boolClass]=cloneableClasses[dateClass]=cloneableClasses[numberClass]=cloneableClasses[objectClass]=cloneableClasses[regexpClass]=cloneableClasses[stringClass]=true;var debounceOptions={leading:false,maxWait:0,trailing:false};var descriptor={configurable:false,enumerable:false,value:null,writable:false};var objectTypes={boolean:false,function:true,object:true,number:false,string:false,undefined:false};var stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"};var root=objectTypes[typeof window]&&window||this;var freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports;var freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module;var moduleExports=freeModule&&freeModule.exports===freeExports&&freeExports;var freeGlobal=objectTypes[typeof global]&&global;if(freeGlobal&&(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal)){root=freeGlobal}function baseIndexOf(array,value,fromIndex){var index=(fromIndex||0)-1,length=array?array.length:0;while(++index<length){if(array[index]===value){return index}}return-1}function cacheIndexOf(cache,value){var type=typeof value;cache=cache.cache;if(type=="boolean"||value==null){return cache[value]?0:-1}if(type!="number"&&type!="string"){type="object"}var key=type=="number"?value:keyPrefix+value;cache=(cache=cache[type])&&cache[key];return type=="object"?cache&&baseIndexOf(cache,value)>-1?0:-1:cache?0:-1}function cachePush(value){var cache=this.cache,type=typeof value;if(type=="boolean"||value==null){cache[value]=true}else{if(type!="number"&&type!="string"){type="object"}var key=type=="number"?value:keyPrefix+value,typeCache=cache[type]||(cache[type]={});if(type=="object"){(typeCache[key]||(typeCache[key]=[])).push(value)}else{typeCache[key]=true}}}function charAtCallback(value){return value.charCodeAt(0)}function compareAscending(a,b){var ac=a.criteria,bc=b.criteria,index=-1,length=ac.length;while(++index<length){var value=ac[index],other=bc[index];if(value!==other){if(value>other||typeof value=="undefined"){return 1}if(value<other||typeof other=="undefined"){return-1}}}return a.index-b.index}function createCache(array){var index=-1,length=array.length,first=array[0],mid=array[length/2|0],last=array[length-1];if(first&&typeof first=="object"&&mid&&typeof mid=="object"&&last&&typeof last=="object"){return false}var cache=getObject();cache["false"]=cache["null"]=cache["true"]=cache["undefined"]=false;var result=getObject();result.array=array;result.cache=cache;result.push=cachePush;while(++index<length){result.push(array[index])}return result}function escapeStringChar(match){return"\\"+stringEscapes[match]}function getArray(){return arrayPool.pop()||[]}function getObject(){return objectPool.pop()||{array:null,cache:null,criteria:null,false:false,index:0,null:false,number:null,object:null,push:null,string:null,true:false,undefined:false,value:null}}function releaseArray(array){array.length=0;if(arrayPool.length<maxPoolSize){arrayPool.push(array)}}function releaseObject(object){var cache=object.cache;if(cache){releaseObject(cache)}object.array=object.cache=object.criteria=object.object=object.number=object.string=object.value=null;if(objectPool.length<maxPoolSize){objectPool.push(object)}}function slice(array,start,end){start||(start=0);if(typeof end=="undefined"){end=array?array.length:0}var index=-1,length=end-start||0,result=Array(length<0?0:length);while(++index<length){result[index]=array[start+index]}return result}function runInContext(context){context=context?_.defaults(root.Object(),context,_.pick(root,contextProps)):root;var Array=context.Array,Boolean=context.Boolean,Date=context.Date,Function=context.Function,Math=context.Math,Number=context.Number,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError;var arrayRef=[];var objectProto=Object.prototype;var oldDash=context._;var toString=objectProto.toString;var reNative=RegExp("^"+String(toString).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");var ceil=Math.ceil,clearTimeout=context.clearTimeout,floor=Math.floor,fnToString=Function.prototype.toString,getPrototypeOf=isNative(getPrototypeOf=Object.getPrototypeOf)&&getPrototypeOf,hasOwnProperty=objectProto.hasOwnProperty,push=arrayRef.push,setTimeout=context.setTimeout,splice=arrayRef.splice,unshift=arrayRef.unshift;var defineProperty=function(){try{var o={},func=isNative(func=Object.defineProperty)&&func,result=func(o,o,o)&&func}catch(e){}return result}();var nativeCreate=isNative(nativeCreate=Object.create)&&nativeCreate,nativeIsArray=isNative(nativeIsArray=Array.isArray)&&nativeIsArray,nativeIsFinite=context.isFinite,nativeIsNaN=context.isNaN,nativeKeys=isNative(nativeKeys=Object.keys)&&nativeKeys,nativeMax=Math.max,nativeMin=Math.min,nativeParseInt=context.parseInt,nativeRandom=Math.random;var ctorByClass={};ctorByClass[arrayClass]=Array;ctorByClass[boolClass]=Boolean;ctorByClass[dateClass]=Date;ctorByClass[funcClass]=Function;ctorByClass[objectClass]=Object;ctorByClass[numberClass]=Number;ctorByClass[regexpClass]=RegExp;ctorByClass[stringClass]=String;function lodash(value){return value&&typeof value=="object"&&!isArray(value)&&hasOwnProperty.call(value,"__wrapped__")?value:new lodashWrapper(value)}function lodashWrapper(value,chainAll){this.__chain__=!!chainAll;this.__wrapped__=value}lodashWrapper.prototype=lodash.prototype;var support=lodash.support={};support.funcDecomp=!isNative(context.WinRTError)&&reThis.test(runInContext);support.funcNames=typeof Function.name=="string";lodash.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:reInterpolate,variable:"",imports:{_:lodash}};function baseBind(bindData){var func=bindData[0],partialArgs=bindData[2],thisArg=bindData[4];function bound(){if(partialArgs){var args=slice(partialArgs);push.apply(args,arguments)}if(this instanceof bound){var thisBinding=baseCreate(func.prototype),result=func.apply(thisBinding,args||arguments);return isObject(result)?result:thisBinding}return func.apply(thisArg,args||arguments)}setBindData(bound,bindData);return bound}function baseClone(value,isDeep,callback,stackA,stackB){if(callback){var result=callback(value);if(typeof result!="undefined"){return result}}var isObj=isObject(value);if(isObj){var className=toString.call(value);if(!cloneableClasses[className]){return value}var ctor=ctorByClass[className];switch(className){case boolClass:case dateClass:return new ctor(+value);case numberClass:case stringClass:return new ctor(value);case regexpClass:result=ctor(value.source,reFlags.exec(value));result.lastIndex=value.lastIndex;return result}}else{return value}var isArr=isArray(value);if(isDeep){var initedStack=!stackA;stackA||(stackA=getArray());stackB||(stackB=getArray());var length=stackA.length;while(length--){if(stackA[length]==value){return stackB[length]}}result=isArr?ctor(value.length):{}}else{result=isArr?slice(value):assign({},value)}if(isArr){if(hasOwnProperty.call(value,"index")){result.index=value.index}if(hasOwnProperty.call(value,"input")){result.input=value.input}}if(!isDeep){return result}stackA.push(value);stackB.push(result);(isArr?forEach:forOwn)(value,function(objValue,key){result[key]=baseClone(objValue,isDeep,callback,stackA,stackB)});if(initedStack){releaseArray(stackA);releaseArray(stackB)}return result}function baseCreate(prototype,properties){return isObject(prototype)?nativeCreate(prototype):{}}if(!nativeCreate){baseCreate=function(){function Object(){}return function(prototype){if(isObject(prototype)){Object.prototype=prototype;var result=new Object;Object.prototype=null}return result||context.Object()}}()}function baseCreateCallback(func,thisArg,argCount){if(typeof func!="function"){return identity}if(typeof thisArg=="undefined"||!("prototype"in func)){return func}var bindData=func.__bindData__;if(typeof bindData=="undefined"){if(support.funcNames){bindData=!func.name}bindData=bindData||!support.funcDecomp;if(!bindData){var source=fnToString.call(func);if(!support.funcNames){bindData=!reFuncName.test(source)}if(!bindData){bindData=reThis.test(source);setBindData(func,bindData)}}}if(bindData===false||bindData!==true&&bindData[1]&1){return func}switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 2:return function(a,b){return func.call(thisArg,a,b)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)}}return bind(func,thisArg)}function baseCreateWrapper(bindData){var func=bindData[0],bitmask=bindData[1],partialArgs=bindData[2],partialRightArgs=bindData[3],thisArg=bindData[4],arity=bindData[5];var isBind=bitmask&1,isBindKey=bitmask&2,isCurry=bitmask&4,isCurryBound=bitmask&8,key=func;function bound(){var thisBinding=isBind?thisArg:this;if(partialArgs){var args=slice(partialArgs);push.apply(args,arguments)}if(partialRightArgs||isCurry){args||(args=slice(arguments));if(partialRightArgs){push.apply(args,partialRightArgs)}if(isCurry&&args.length<arity){bitmask|=16&~32;return baseCreateWrapper([func,isCurryBound?bitmask:bitmask&~3,args,null,thisArg,arity])}}args||(args=arguments);if(isBindKey){func=thisBinding[key]}if(this instanceof bound){thisBinding=baseCreate(func.prototype);var result=func.apply(thisBinding,args);return isObject(result)?result:thisBinding}return func.apply(thisBinding,args)}setBindData(bound,bindData);return bound}function baseDifference(array,values){var index=-1,indexOf=getIndexOf(),length=array?array.length:0,isLarge=length>=largeArraySize&&indexOf===baseIndexOf,result=[];if(isLarge){var cache=createCache(values);if(cache){indexOf=cacheIndexOf;values=cache}else{isLarge=false}}while(++index<length){var value=array[index];if(indexOf(values,value)<0){result.push(value)}}if(isLarge){releaseObject(values)}return result}function baseFlatten(array,isShallow,isStrict,fromIndex){var index=(fromIndex||0)-1,length=array?array.length:0,result=[];while(++index<length){var value=array[index];if(value&&typeof value=="object"&&typeof value.length=="number"&&(isArray(value)||isArguments(value))){if(!isShallow){value=baseFlatten(value,isShallow,isStrict)}var valIndex=-1,valLength=value.length,resIndex=result.length;result.length+=valLength;while(++valIndex<valLength){result[resIndex++]=value[valIndex]}}else if(!isStrict){result.push(value)}}return result}function baseIsEqual(a,b,callback,isWhere,stackA,stackB){if(callback){var result=callback(a,b);if(typeof result!="undefined"){return!!result}}if(a===b){return a!==0||1/a==1/b}var type=typeof a,otherType=typeof b;if(a===a&&!(a&&objectTypes[type])&&!(b&&objectTypes[otherType])){return false}if(a==null||b==null){return a===b}var className=toString.call(a),otherClass=toString.call(b);if(className==argsClass){className=objectClass}if(otherClass==argsClass){otherClass=objectClass}if(className!=otherClass){return false}switch(className){case boolClass:case dateClass:return+a==+b;case numberClass:return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case regexpClass:case stringClass:return a==String(b)}var isArr=className==arrayClass;if(!isArr){var aWrapped=hasOwnProperty.call(a,"__wrapped__"),bWrapped=hasOwnProperty.call(b,"__wrapped__");if(aWrapped||bWrapped){return baseIsEqual(aWrapped?a.__wrapped__:a,bWrapped?b.__wrapped__:b,callback,isWhere,stackA,stackB)}if(className!=objectClass){return false}var ctorA=a.constructor,ctorB=b.constructor;if(ctorA!=ctorB&&!(isFunction(ctorA)&&ctorA instanceof ctorA&&isFunction(ctorB)&&ctorB instanceof ctorB)&&("constructor"in a&&"constructor"in b)){return false}}var initedStack=!stackA;stackA||(stackA=getArray());stackB||(stackB=getArray());var length=stackA.length;while(length--){if(stackA[length]==a){return stackB[length]==b}}var size=0;result=true;stackA.push(a);stackB.push(b);if(isArr){length=a.length;size=b.length;result=size==length;if(result||isWhere){while(size--){var index=length,value=b[size];if(isWhere){while(index--){if(result=baseIsEqual(a[index],value,callback,isWhere,stackA,stackB)){break}}}else if(!(result=baseIsEqual(a[size],value,callback,isWhere,stackA,stackB))){break}}}}else{forIn(b,function(value,key,b){if(hasOwnProperty.call(b,key)){size++;return result=hasOwnProperty.call(a,key)&&baseIsEqual(a[key],value,callback,isWhere,stackA,stackB)}});if(result&&!isWhere){forIn(a,function(value,key,a){if(hasOwnProperty.call(a,key)){return result=--size>-1}})}}stackA.pop();stackB.pop();if(initedStack){releaseArray(stackA);releaseArray(stackB)}return result}function baseMerge(object,source,callback,stackA,stackB){(isArray(source)?forEach:forOwn)(source,function(source,key){var found,isArr,result=source,value=object[key];if(source&&((isArr=isArray(source))||isPlainObject(source))){var stackLength=stackA.length;while(stackLength--){if(found=stackA[stackLength]==source){value=stackB[stackLength];break}}if(!found){var isShallow;if(callback){result=callback(value,source);if(isShallow=typeof result!="undefined"){value=result}}if(!isShallow){value=isArr?isArray(value)?value:[]:isPlainObject(value)?value:{}}stackA.push(source);stackB.push(value);if(!isShallow){baseMerge(value,source,callback,stackA,stackB)}}}else{if(callback){result=callback(value,source);if(typeof result=="undefined"){result=source}}if(typeof result!="undefined"){value=result}}object[key]=value})}function baseRandom(min,max){return min+floor(nativeRandom()*(max-min+1))}function baseUniq(array,isSorted,callback){var index=-1,indexOf=getIndexOf(),length=array?array.length:0,result=[];var isLarge=!isSorted&&length>=largeArraySize&&indexOf===baseIndexOf,seen=callback||isLarge?getArray():result;if(isLarge){var cache=createCache(seen);indexOf=cacheIndexOf;seen=cache}while(++index<length){var value=array[index],computed=callback?callback(value,index,array):value;if(isSorted?!index||seen[seen.length-1]!==computed:indexOf(seen,computed)<0){if(callback||isLarge){seen.push(computed)}result.push(value)}}if(isLarge){releaseArray(seen.array);releaseObject(seen)}else if(callback){releaseArray(seen)}return result}function createAggregator(setter){return function(collection,callback,thisArg){var result={};callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){var value=collection[index];setter(result,value,callback(value,index,collection),collection)}}else{forOwn(collection,function(value,key,collection){setter(result,value,callback(value,key,collection),collection)})}return result}}function createWrapper(func,bitmask,partialArgs,partialRightArgs,thisArg,arity){var isBind=bitmask&1,isBindKey=bitmask&2,isCurry=bitmask&4,isCurryBound=bitmask&8,isPartial=bitmask&16,isPartialRight=bitmask&32;if(!isBindKey&&!isFunction(func)){throw new TypeError}if(isPartial&&!partialArgs.length){bitmask&=~16;isPartial=partialArgs=false}if(isPartialRight&&!partialRightArgs.length){bitmask&=~32;isPartialRight=partialRightArgs=false}var bindData=func&&func.__bindData__;if(bindData&&bindData!==true){bindData=slice(bindData);if(bindData[2]){bindData[2]=slice(bindData[2])}if(bindData[3]){bindData[3]=slice(bindData[3])}if(isBind&&!(bindData[1]&1)){bindData[4]=thisArg}if(!isBind&&bindData[1]&1){bitmask|=8}if(isCurry&&!(bindData[1]&4)){bindData[5]=arity}if(isPartial){push.apply(bindData[2]||(bindData[2]=[]),partialArgs)}if(isPartialRight){unshift.apply(bindData[3]||(bindData[3]=[]),partialRightArgs)}bindData[1]|=bitmask;return createWrapper.apply(null,bindData)}var creater=bitmask==1||bitmask===17?baseBind:baseCreateWrapper;return creater([func,bitmask,partialArgs,partialRightArgs,thisArg,arity])}function escapeHtmlChar(match){return htmlEscapes[match]}function getIndexOf(){var result=(result=lodash.indexOf)===indexOf?baseIndexOf:result;return result}function isNative(value){return typeof value=="function"&&reNative.test(value)}var setBindData=!defineProperty?noop:function(func,value){descriptor.value=value;defineProperty(func,"__bindData__",descriptor);descriptor.value=null};function shimIsPlainObject(value){var ctor,result;if(!(value&&toString.call(value)==objectClass)||(ctor=value.constructor,isFunction(ctor)&&!(ctor instanceof ctor))){return false}forIn(value,function(value,key){result=key});return typeof result=="undefined"||hasOwnProperty.call(value,result)}function unescapeHtmlChar(match){return htmlUnescapes[match]}function isArguments(value){return value&&typeof value=="object"&&typeof value.length=="number"&&toString.call(value)==argsClass||false}var isArray=nativeIsArray||function(value){return value&&typeof value=="object"&&typeof value.length=="number"&&toString.call(value)==arrayClass||false};var shimKeys=function(object){var index,iterable=object,result=[];if(!iterable)return result;if(!objectTypes[typeof object])return result;for(index in iterable){if(hasOwnProperty.call(iterable,index)){result.push(index)}}return result};var keys=!nativeKeys?shimKeys:function(object){if(!isObject(object)){return[]}return nativeKeys(object)};var htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var htmlUnescapes=invert(htmlEscapes);var reEscapedHtml=RegExp("("+keys(htmlUnescapes).join("|")+")","g"),reUnescapedHtml=RegExp("["+keys(htmlEscapes).join("")+"]","g");var assign=function(object,source,guard){var index,iterable=object,result=iterable;if(!iterable)return result;var args=arguments,argsIndex=0,argsLength=typeof guard=="number"?2:args.length;if(argsLength>3&&typeof args[argsLength-2]=="function"){var callback=baseCreateCallback(args[--argsLength-1],args[argsLength--],2)}else if(argsLength>2&&typeof args[argsLength-1]=="function"){callback=args[--argsLength]}while(++argsIndex<argsLength){iterable=args[argsIndex];if(iterable&&objectTypes[typeof iterable]){var ownIndex=-1,ownProps=objectTypes[typeof iterable]&&keys(iterable),length=ownProps?ownProps.length:0;while(++ownIndex<length){index=ownProps[ownIndex];result[index]=callback?callback(result[index],iterable[index]):iterable[index]}}}return result};function clone(value,isDeep,callback,thisArg){if(typeof isDeep!="boolean"&&isDeep!=null){thisArg=callback;callback=isDeep;isDeep=false}return baseClone(value,isDeep,typeof callback=="function"&&baseCreateCallback(callback,thisArg,1))}function cloneDeep(value,callback,thisArg){return baseClone(value,true,typeof callback=="function"&&baseCreateCallback(callback,thisArg,1))}function create(prototype,properties){var result=baseCreate(prototype);return properties?assign(result,properties):result}var defaults=function(object,source,guard){var index,iterable=object,result=iterable;if(!iterable)return result;var args=arguments,argsIndex=0,argsLength=typeof guard=="number"?2:args.length;while(++argsIndex<argsLength){iterable=args[argsIndex];if(iterable&&objectTypes[typeof iterable]){var ownIndex=-1,ownProps=objectTypes[typeof iterable]&&keys(iterable),length=ownProps?ownProps.length:0;while(++ownIndex<length){index=ownProps[ownIndex];if(typeof result[index]=="undefined")result[index]=iterable[index]}}}return result};function findKey(object,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg,3);forOwn(object,function(value,key,object){if(callback(value,key,object)){result=key;return false}});return result}function findLastKey(object,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg,3);forOwnRight(object,function(value,key,object){if(callback(value,key,object)){result=key;return false}});return result}var forIn=function(collection,callback,thisArg){var index,iterable=collection,result=iterable;if(!iterable)return result;if(!objectTypes[typeof iterable])return result;callback=callback&&typeof thisArg=="undefined"?callback:baseCreateCallback(callback,thisArg,3);for(index in iterable){if(callback(iterable[index],index,collection)===false)return result}return result};function forInRight(object,callback,thisArg){var pairs=[];forIn(object,function(value,key){pairs.push(key,value)});var length=pairs.length;callback=baseCreateCallback(callback,thisArg,3);while(length--){if(callback(pairs[length--],pairs[length],object)===false){break}}return object}var forOwn=function(collection,callback,thisArg){var index,iterable=collection,result=iterable;if(!iterable)return result;if(!objectTypes[typeof iterable])return result;callback=callback&&typeof thisArg=="undefined"?callback:baseCreateCallback(callback,thisArg,3);var ownIndex=-1,ownProps=objectTypes[typeof iterable]&&keys(iterable),length=ownProps?ownProps.length:0;while(++ownIndex<length){index=ownProps[ownIndex];if(callback(iterable[index],index,collection)===false)return result}return result};function forOwnRight(object,callback,thisArg){var props=keys(object),length=props.length;callback=baseCreateCallback(callback,thisArg,3);while(length--){var key=props[length];if(callback(object[key],key,object)===false){break}}return object}function functions(object){var result=[];forIn(object,function(value,key){if(isFunction(value)){result.push(key)}});return result.sort()}function has(object,key){return object?hasOwnProperty.call(object,key):false}function invert(object){var index=-1,props=keys(object),length=props.length,result={};while(++index<length){var key=props[index];result[object[key]]=key}return result}function isBoolean(value){return value===true||value===false||value&&typeof value=="object"&&toString.call(value)==boolClass||false}function isDate(value){return value&&typeof value=="object"&&toString.call(value)==dateClass||false}function isElement(value){return value&&value.nodeType===1||false}function isEmpty(value){var result=true;if(!value){return result}var className=toString.call(value),length=value.length;if(className==arrayClass||className==stringClass||className==argsClass||className==objectClass&&typeof length=="number"&&isFunction(value.splice)){return!length}forOwn(value,function(){return result=false});return result}function isEqual(a,b,callback,thisArg){return baseIsEqual(a,b,typeof callback=="function"&&baseCreateCallback(callback,thisArg,2))}function isFinite(value){return nativeIsFinite(value)&&!nativeIsNaN(parseFloat(value))}function isFunction(value){return typeof value=="function"}function isObject(value){return!!(value&&objectTypes[typeof value])}function isNaN(value){return isNumber(value)&&value!=+value}function isNull(value){return value===null}function isNumber(value){return typeof value=="number"||value&&typeof value=="object"&&toString.call(value)==numberClass||false}var isPlainObject=!getPrototypeOf?shimIsPlainObject:function(value){if(!(value&&toString.call(value)==objectClass)){return false}var valueOf=value.valueOf,objProto=isNative(valueOf)&&(objProto=getPrototypeOf(valueOf))&&getPrototypeOf(objProto);return objProto?value==objProto||getPrototypeOf(value)==objProto:shimIsPlainObject(value)};function isRegExp(value){return value&&typeof value=="object"&&toString.call(value)==regexpClass||false}function isString(value){return typeof value=="string"||value&&typeof value=="object"&&toString.call(value)==stringClass||false}function isUndefined(value){return typeof value=="undefined"}function mapValues(object,callback,thisArg){var result={};callback=lodash.createCallback(callback,thisArg,3);forOwn(object,function(value,key,object){result[key]=callback(value,key,object)});return result}function merge(object){var args=arguments,length=2;if(!isObject(object)){return object}if(typeof args[2]!="number"){length=args.length}if(length>3&&typeof args[length-2]=="function"){var callback=baseCreateCallback(args[--length-1],args[length--],2)}else if(length>2&&typeof args[length-1]=="function"){callback=args[--length]}var sources=slice(arguments,1,length),index=-1,stackA=getArray(),stackB=getArray();while(++index<length){baseMerge(object,sources[index],callback,stackA,stackB)}releaseArray(stackA);releaseArray(stackB);return object}function omit(object,callback,thisArg){var result={};if(typeof callback!="function"){var props=[];forIn(object,function(value,key){props.push(key)});props=baseDifference(props,baseFlatten(arguments,true,false,1));var index=-1,length=props.length;while(++index<length){var key=props[index];result[key]=object[key]}}else{callback=lodash.createCallback(callback,thisArg,3);forIn(object,function(value,key,object){if(!callback(value,key,object)){result[key]=value}})}return result}function pairs(object){var index=-1,props=keys(object),length=props.length,result=Array(length);while(++index<length){var key=props[index];result[index]=[key,object[key]]}return result}function pick(object,callback,thisArg){var result={};if(typeof callback!="function"){var index=-1,props=baseFlatten(arguments,true,false,1),length=isObject(object)?props.length:0;while(++index<length){var key=props[index];if(key in object){result[key]=object[key]}}}else{callback=lodash.createCallback(callback,thisArg,3);forIn(object,function(value,key,object){if(callback(value,key,object)){result[key]=value}})}return result}function transform(object,callback,accumulator,thisArg){var isArr=isArray(object);if(accumulator==null){if(isArr){accumulator=[]}else{var ctor=object&&object.constructor,proto=ctor&&ctor.prototype;accumulator=baseCreate(proto)}}if(callback){callback=lodash.createCallback(callback,thisArg,4);(isArr?forEach:forOwn)(object,function(value,index,object){return callback(accumulator,value,index,object)})}return accumulator}function values(object){var index=-1,props=keys(object),length=props.length,result=Array(length);while(++index<length){result[index]=object[props[index]]}return result}function at(collection){var args=arguments,index=-1,props=baseFlatten(args,true,false,1),length=args[2]&&args[2][args[1]]===collection?1:props.length,result=Array(length);while(++index<length){result[index]=collection[props[index]]}return result}function contains(collection,target,fromIndex){var index=-1,indexOf=getIndexOf(),length=collection?collection.length:0,result=false;fromIndex=(fromIndex<0?nativeMax(0,length+fromIndex):fromIndex)||0;if(isArray(collection)){result=indexOf(collection,target,fromIndex)>-1}else if(typeof length=="number"){result=(isString(collection)?collection.indexOf(target,fromIndex):indexOf(collection,target,fromIndex))>-1}else{forOwn(collection,function(value){if(++index>=fromIndex){return!(result=value===target)}})}return result}var countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key]++:result[key]=1});function every(collection,callback,thisArg){var result=true;callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){if(!(result=!!callback(collection[index],index,collection))){break}}}else{forOwn(collection,function(value,index,collection){return result=!!callback(value,index,collection)})}return result}function filter(collection,callback,thisArg){var result=[];callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){var value=collection[index];if(callback(value,index,collection)){result.push(value)}}}else{forOwn(collection,function(value,index,collection){if(callback(value,index,collection)){result.push(value)}})}return result}function find(collection,callback,thisArg){callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){var value=collection[index];if(callback(value,index,collection)){return value}}}else{var result;forOwn(collection,function(value,index,collection){if(callback(value,index,collection)){result=value;return false}});return result}}function findLast(collection,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg,3);forEachRight(collection,function(value,index,collection){if(callback(value,index,collection)){result=value;return false}});return result}function forEach(collection,callback,thisArg){var index=-1,length=collection?collection.length:0;callback=callback&&typeof thisArg=="undefined"?callback:baseCreateCallback(callback,thisArg,3);if(typeof length=="number"){while(++index<length){if(callback(collection[index],index,collection)===false){break}}}else{forOwn(collection,callback)}return collection}function forEachRight(collection,callback,thisArg){var length=collection?collection.length:0;callback=callback&&typeof thisArg=="undefined"?callback:baseCreateCallback(callback,thisArg,3);if(typeof length=="number"){while(length--){if(callback(collection[length],length,collection)===false){break}}}else{var props=keys(collection);length=props.length;forOwn(collection,function(value,key,collection){key=props?props[--length]:--length;return callback(collection[key],key,collection)})}return collection}var groupBy=createAggregator(function(result,value,key){(hasOwnProperty.call(result,key)?result[key]:result[key]=[]).push(value)});var indexBy=createAggregator(function(result,value,key){result[key]=value});function invoke(collection,methodName){var args=slice(arguments,2),index=-1,isFunc=typeof methodName=="function",length=collection?collection.length:0,result=Array(typeof length=="number"?length:0);forEach(collection,function(value){result[++index]=(isFunc?methodName:value[methodName]).apply(value,args)});return result}function map(collection,callback,thisArg){var index=-1,length=collection?collection.length:0;callback=lodash.createCallback(callback,thisArg,3);if(typeof length=="number"){var result=Array(length);while(++index<length){result[index]=callback(collection[index],index,collection)}}else{result=[];forOwn(collection,function(value,key,collection){result[++index]=callback(value,key,collection)})}return result}function max(collection,callback,thisArg){var computed=-Infinity,result=computed;if(typeof callback!="function"&&thisArg&&thisArg[callback]===collection){callback=null}if(callback==null&&isArray(collection)){var index=-1,length=collection.length;while(++index<length){var value=collection[index];if(value>result){result=value}}}else{callback=callback==null&&isString(collection)?charAtCallback:lodash.createCallback(callback,thisArg,3);forEach(collection,function(value,index,collection){var current=callback(value,index,collection);if(current>computed){computed=current;result=value}})}return result}function min(collection,callback,thisArg){var computed=Infinity,result=computed;if(typeof callback!="function"&&thisArg&&thisArg[callback]===collection){callback=null}if(callback==null&&isArray(collection)){var index=-1,length=collection.length;while(++index<length){var value=collection[index];if(value<result){result=value}}}else{callback=callback==null&&isString(collection)?charAtCallback:lodash.createCallback(callback,thisArg,3);forEach(collection,function(value,index,collection){var current=callback(value,index,collection);if(current<computed){computed=current;result=value}})}return result}var pluck=map;function reduce(collection,callback,accumulator,thisArg){if(!collection)return accumulator;var noaccum=arguments.length<3;callback=lodash.createCallback(callback,thisArg,4);var index=-1,length=collection.length;if(typeof length=="number"){if(noaccum){accumulator=collection[++index]}while(++index<length){accumulator=callback(accumulator,collection[index],index,collection)}}else{forOwn(collection,function(value,index,collection){accumulator=noaccum?(noaccum=false,value):callback(accumulator,value,index,collection)})}return accumulator}function reduceRight(collection,callback,accumulator,thisArg){var noaccum=arguments.length<3;callback=lodash.createCallback(callback,thisArg,4);forEachRight(collection,function(value,index,collection){accumulator=noaccum?(noaccum=false,value):callback(accumulator,value,index,collection)});return accumulator}function reject(collection,callback,thisArg){callback=lodash.createCallback(callback,thisArg,3);return filter(collection,function(value,index,collection){return!callback(value,index,collection)})}function sample(collection,n,guard){if(collection&&typeof collection.length!="number"){collection=values(collection)}if(n==null||guard){return collection?collection[baseRandom(0,collection.length-1)]:undefined}var result=shuffle(collection);result.length=nativeMin(nativeMax(0,n),result.length);return result}function shuffle(collection){var index=-1,length=collection?collection.length:0,result=Array(typeof length=="number"?length:0);forEach(collection,function(value){var rand=baseRandom(0,++index);result[index]=result[rand];result[rand]=value});return result}function size(collection){var length=collection?collection.length:0;return typeof length=="number"?length:keys(collection).length}function some(collection,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){if(result=callback(collection[index],index,collection)){break}}}else{forOwn(collection,function(value,index,collection){return!(result=callback(value,index,collection))})}return!!result}function sortBy(collection,callback,thisArg){var index=-1,isArr=isArray(callback),length=collection?collection.length:0,result=Array(typeof length=="number"?length:0);if(!isArr){callback=lodash.createCallback(callback,thisArg,3)}forEach(collection,function(value,key,collection){var object=result[++index]=getObject();if(isArr){object.criteria=map(callback,function(key){return value[key]})}else{(object.criteria=getArray())[0]=callback(value,key,collection)}object.index=index;object.value=value});length=result.length;result.sort(compareAscending);while(length--){var object=result[length];result[length]=object.value;if(!isArr){releaseArray(object.criteria)}releaseObject(object)}return result}function toArray(collection){if(collection&&typeof collection.length=="number"){return slice(collection)}return values(collection)}var where=filter;function compact(array){var index=-1,length=array?array.length:0,result=[];while(++index<length){var value=array[index];if(value){result.push(value)}}return result}function difference(array){return baseDifference(array,baseFlatten(arguments,true,true,1))}function findIndex(array,callback,thisArg){var index=-1,length=array?array.length:0;callback=lodash.createCallback(callback,thisArg,3);while(++index<length){if(callback(array[index],index,array)){return index}}return-1}function findLastIndex(array,callback,thisArg){var length=array?array.length:0;callback=lodash.createCallback(callback,thisArg,3);while(length--){if(callback(array[length],length,array)){return length}}return-1}function first(array,callback,thisArg){var n=0,length=array?array.length:0;if(typeof callback!="number"&&callback!=null){var index=-1;callback=lodash.createCallback(callback,thisArg,3);while(++index<length&&callback(array[index],index,array)){n++}}else{n=callback;if(n==null||thisArg){return array?array[0]:undefined}}return slice(array,0,nativeMin(nativeMax(0,n),length))}function flatten(array,isShallow,callback,thisArg){if(typeof isShallow!="boolean"&&isShallow!=null){thisArg=callback;callback=typeof isShallow!="function"&&thisArg&&thisArg[isShallow]===array?null:isShallow;isShallow=false}if(callback!=null){array=map(array,callback,thisArg)}return baseFlatten(array,isShallow)}function indexOf(array,value,fromIndex){if(typeof fromIndex=="number"){var length=array?array.length:0;fromIndex=fromIndex<0?nativeMax(0,length+fromIndex):fromIndex||0}else if(fromIndex){var index=sortedIndex(array,value);return array[index]===value?index:-1}return baseIndexOf(array,value,fromIndex)}function initial(array,callback,thisArg){var n=0,length=array?array.length:0;if(typeof callback!="number"&&callback!=null){var index=length;callback=lodash.createCallback(callback,thisArg,3);while(index--&&callback(array[index],index,array)){n++}}else{n=callback==null||thisArg?1:callback||n}return slice(array,0,nativeMin(nativeMax(0,length-n),length))}function intersection(){var args=[],argsIndex=-1,argsLength=arguments.length,caches=getArray(),indexOf=getIndexOf(),trustIndexOf=indexOf===baseIndexOf,seen=getArray();while(++argsIndex<argsLength){var value=arguments[argsIndex];if(isArray(value)||isArguments(value)){args.push(value);caches.push(trustIndexOf&&value.length>=largeArraySize&&createCache(argsIndex?args[argsIndex]:seen))}}var array=args[0],index=-1,length=array?array.length:0,result=[];outer:while(++index<length){var cache=caches[0];value=array[index];if((cache?cacheIndexOf(cache,value):indexOf(seen,value))<0){argsIndex=argsLength;(cache||seen).push(value);while(--argsIndex){cache=caches[argsIndex];if((cache?cacheIndexOf(cache,value):indexOf(args[argsIndex],value))<0){continue outer}}result.push(value)}}while(argsLength--){cache=caches[argsLength];if(cache){releaseObject(cache)}}releaseArray(caches);releaseArray(seen);return result}function last(array,callback,thisArg){var n=0,length=array?array.length:0;if(typeof callback!="number"&&callback!=null){var index=length;callback=lodash.createCallback(callback,thisArg,3);while(index--&&callback(array[index],index,array)){n++}}else{n=callback;if(n==null||thisArg){return array?array[length-1]:undefined}}return slice(array,nativeMax(0,length-n))}function lastIndexOf(array,value,fromIndex){var index=array?array.length:0;if(typeof fromIndex=="number"){index=(fromIndex<0?nativeMax(0,index+fromIndex):nativeMin(fromIndex,index-1))+1}while(index--){if(array[index]===value){return index}}return-1}function pull(array){var args=arguments,argsIndex=0,argsLength=args.length,length=array?array.length:0;while(++argsIndex<argsLength){var index=-1,value=args[argsIndex];while(++index<length){if(array[index]===value){splice.call(array,index--,1);length--}}}return array}function range(start,end,step){start=+start||0;step=typeof step=="number"?step:+step||1;if(end==null){end=start;start=0}var index=-1,length=nativeMax(0,ceil((end-start)/(step||1))),result=Array(length);while(++index<length){result[index]=start;start+=step}return result}function remove(array,callback,thisArg){var index=-1,length=array?array.length:0,result=[];callback=lodash.createCallback(callback,thisArg,3);while(++index<length){var value=array[index];if(callback(value,index,array)){result.push(value);splice.call(array,index--,1);length--}}return result}function rest(array,callback,thisArg){if(typeof callback!="number"&&callback!=null){var n=0,index=-1,length=array?array.length:0;callback=lodash.createCallback(callback,thisArg,3);while(++index<length&&callback(array[index],index,array)){n++}}else{n=callback==null||thisArg?1:nativeMax(0,callback)}return slice(array,n)}function sortedIndex(array,value,callback,thisArg){var low=0,high=array?array.length:low;callback=callback?lodash.createCallback(callback,thisArg,1):identity;value=callback(value);while(low<high){var mid=low+high>>>1;callback(array[mid])<value?low=mid+1:high=mid}return low}function union(){return baseUniq(baseFlatten(arguments,true,true))}function uniq(array,isSorted,callback,thisArg){if(typeof isSorted!="boolean"&&isSorted!=null){thisArg=callback;callback=typeof isSorted!="function"&&thisArg&&thisArg[isSorted]===array?null:isSorted;isSorted=false}if(callback!=null){callback=lodash.createCallback(callback,thisArg,3)}return baseUniq(array,isSorted,callback)}function without(array){return baseDifference(array,slice(arguments,1))}function xor(){var index=-1,length=arguments.length;while(++index<length){var array=arguments[index];if(isArray(array)||isArguments(array)){var result=result?baseUniq(baseDifference(result,array).concat(baseDifference(array,result))):array}}return result||[]}function zip(){var array=arguments.length>1?arguments:arguments[0],index=-1,length=array?max(pluck(array,"length")):0,result=Array(length<0?0:length);while(++index<length){result[index]=pluck(array,index)}return result}function zipObject(keys,values){var index=-1,length=keys?keys.length:0,result={};if(!values&&length&&!isArray(keys[0])){values=[]}while(++index<length){var key=keys[index];if(values){result[key]=values[index]}else if(key){result[key[0]]=key[1]}}return result}function after(n,func){if(!isFunction(func)){throw new TypeError}return function(){if(--n<1){return func.apply(this,arguments)}}}function bind(func,thisArg){return arguments.length>2?createWrapper(func,17,slice(arguments,2),null,thisArg):createWrapper(func,1,null,null,thisArg)}function bindAll(object){var funcs=arguments.length>1?baseFlatten(arguments,true,false,1):functions(object),index=-1,length=funcs.length;while(++index<length){var key=funcs[index];object[key]=createWrapper(object[key],1,null,null,object)}return object}function bindKey(object,key){return arguments.length>2?createWrapper(key,19,slice(arguments,2),null,object):createWrapper(key,3,null,null,object)}function compose(){var funcs=arguments,length=funcs.length;while(length--){if(!isFunction(funcs[length])){throw new TypeError}}return function(){var args=arguments,length=funcs.length;while(length--){args=[funcs[length].apply(this,args)]}return args[0]}}function curry(func,arity){arity=typeof arity=="number"?arity:+arity||func.length;return createWrapper(func,4,null,null,null,arity)}function debounce(func,wait,options){var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=false,trailing=true;if(!isFunction(func)){throw new TypeError}wait=nativeMax(0,wait)||0;if(options===true){var leading=true;trailing=false}else if(isObject(options)){leading=options.leading;maxWait="maxWait"in options&&(nativeMax(wait,options.maxWait)||0);trailing="trailing"in options?options.trailing:trailing}var delayed=function(){var remaining=wait-(now()-stamp);if(remaining<=0){if(maxTimeoutId){clearTimeout(maxTimeoutId)}var isCalled=trailingCall;maxTimeoutId=timeoutId=trailingCall=undefined;if(isCalled){lastCalled=now();result=func.apply(thisArg,args);if(!timeoutId&&!maxTimeoutId){args=thisArg=null}}}else{timeoutId=setTimeout(delayed,remaining)}};var maxDelayed=function(){if(timeoutId){clearTimeout(timeoutId)}maxTimeoutId=timeoutId=trailingCall=undefined;if(trailing||maxWait!==wait){lastCalled=now();result=func.apply(thisArg,args);if(!timeoutId&&!maxTimeoutId){args=thisArg=null}}};return function(){args=arguments;stamp=now();thisArg=this;trailingCall=trailing&&(timeoutId||!leading);if(maxWait===false){var leadingCall=leading&&!timeoutId}else{if(!maxTimeoutId&&!leading){lastCalled=stamp}var remaining=maxWait-(stamp-lastCalled),isCalled=remaining<=0;if(isCalled){if(maxTimeoutId){maxTimeoutId=clearTimeout(maxTimeoutId)}lastCalled=stamp;result=func.apply(thisArg,args)}else if(!maxTimeoutId){maxTimeoutId=setTimeout(maxDelayed,remaining)}}if(isCalled&&timeoutId){timeoutId=clearTimeout(timeoutId)}else if(!timeoutId&&wait!==maxWait){timeoutId=setTimeout(delayed,wait)}if(leadingCall){isCalled=true;result=func.apply(thisArg,args)}if(isCalled&&!timeoutId&&!maxTimeoutId){args=thisArg=null}return result}}function defer(func){if(!isFunction(func)){throw new TypeError}var args=slice(arguments,1);return setTimeout(function(){func.apply(undefined,args)},1)}function delay(func,wait){if(!isFunction(func)){throw new TypeError}var args=slice(arguments,2);return setTimeout(function(){func.apply(undefined,args)},wait)}function memoize(func,resolver){if(!isFunction(func)){throw new TypeError}var memoized=function(){var cache=memoized.cache,key=resolver?resolver.apply(this,arguments):keyPrefix+arguments[0];return hasOwnProperty.call(cache,key)?cache[key]:cache[key]=func.apply(this,arguments)};memoized.cache={};return memoized}function once(func){var ran,result;if(!isFunction(func)){throw new TypeError}return function(){if(ran){return result}ran=true;result=func.apply(this,arguments);func=null;return result}}function partial(func){return createWrapper(func,16,slice(arguments,1))}function partialRight(func){return createWrapper(func,32,null,slice(arguments,1))}function throttle(func,wait,options){var leading=true,trailing=true;if(!isFunction(func)){throw new TypeError}if(options===false){leading=false}else if(isObject(options)){leading="leading"in options?options.leading:leading;trailing="trailing"in options?options.trailing:trailing}debounceOptions.leading=leading;debounceOptions.maxWait=wait;debounceOptions.trailing=trailing;return debounce(func,wait,debounceOptions)}function wrap(value,wrapper){return createWrapper(wrapper,16,[value])}function constant(value){return function(){return value}}function createCallback(func,thisArg,argCount){var type=typeof func;if(func==null||type=="function"){return baseCreateCallback(func,thisArg,argCount)}if(type!="object"){return property(func)}var props=keys(func),key=props[0],a=func[key];if(props.length==1&&a===a&&!isObject(a)){return function(object){var b=object[key];return a===b&&(a!==0||1/a==1/b)}}return function(object){var length=props.length,result=false;while(length--){if(!(result=baseIsEqual(object[props[length]],func[props[length]],null,true))){break}}return result}}function escape(string){return string==null?"":String(string).replace(reUnescapedHtml,escapeHtmlChar)}function identity(value){return value}function mixin(object,source,options){var chain=true,methodNames=source&&functions(source);if(!source||!options&&!methodNames.length){if(options==null){options=source}ctor=lodashWrapper;source=object;object=lodash;methodNames=functions(source)}if(options===false){chain=false}else if(isObject(options)&&"chain"in options){chain=options.chain}var ctor=object,isFunc=isFunction(ctor);forEach(methodNames,function(methodName){var func=object[methodName]=source[methodName];if(isFunc){ctor.prototype[methodName]=function(){var chainAll=this.__chain__,value=this.__wrapped__,args=[value];push.apply(args,arguments);var result=func.apply(object,args);if(chain||chainAll){if(value===result&&isObject(result)){return this}result=new ctor(result);result.__chain__=chainAll}return result}}})}function noConflict(){context._=oldDash;return this}function noop(){}var now=isNative(now=Date.now)&&now||function(){return(new Date).getTime()};var parseInt=nativeParseInt(whitespace+"08")==8?nativeParseInt:function(value,radix){return nativeParseInt(isString(value)?value.replace(reLeadingSpacesAndZeros,""):value,radix||0)};function property(key){return function(object){return object[key]}}function random(min,max,floating){var noMin=min==null,noMax=max==null;if(floating==null){if(typeof min=="boolean"&&noMax){floating=min;min=1}else if(!noMax&&typeof max=="boolean"){floating=max;noMax=true}}if(noMin&&noMax){max=1}min=+min||0;if(noMax){max=min;min=0}else{max=+max||0}if(floating||min%1||max%1){var rand=nativeRandom();return nativeMin(min+rand*(max-min+parseFloat("1e-"+((rand+"").length-1))),max)}return baseRandom(min,max)}function result(object,key){if(object){var value=object[key];return isFunction(value)?object[key]():value}}function template(text,data,options){var settings=lodash.templateSettings;text=String(text||"");options=defaults({},options,settings);var imports=defaults({},options.imports,settings.imports),importsKeys=keys(imports),importsValues=values(imports);var isEvaluating,index=0,interpolate=options.interpolate||reNoMatch,source="__p += '";var reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g");text.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){interpolateValue||(interpolateValue=esTemplateValue);source+=text.slice(index,offset).replace(reUnescapedString,escapeStringChar);if(escapeValue){source+="' +\n__e("+escapeValue+") +\n'"}if(evaluateValue){isEvaluating=true;source+="';\n"+evaluateValue+";\n__p += '"}if(interpolateValue){source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"}index=offset+match.length;return match});source+="';\n";var variable=options.variable,hasVariable=variable;if(!hasVariable){variable="obj";source="with ("+variable+") {\n"+source+"\n}\n"}source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;");source="function("+variable+") {\n"+(hasVariable?"":variable+" || ("+variable+" = {});\n")+"var __t, __p = '', __e = _.escape"+(isEvaluating?", __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var sourceURL="\n/*\n//# sourceURL="+(options.sourceURL||"/lodash/template/source["+templateCounter+++"]")+"\n*/";try{var result=Function(importsKeys,"return "+source+sourceURL).apply(undefined,importsValues)}catch(e){e.source=source;throw e}if(data){return result(data)}result.source=source;return result}function times(n,callback,thisArg){n=(n=+n)>-1?n:0;var index=-1,result=Array(n);callback=baseCreateCallback(callback,thisArg,1);while(++index<n){result[index]=callback(index)}return result}function unescape(string){return string==null?"":String(string).replace(reEscapedHtml,unescapeHtmlChar)}function uniqueId(prefix){var id=++idCounter;return String(prefix==null?"":prefix)+id}function chain(value){value=new lodashWrapper(value);value.__chain__=true;return value}function tap(value,interceptor){interceptor(value);return value}function wrapperChain(){this.__chain__=true;return this}function wrapperToString(){return String(this.__wrapped__)}function wrapperValueOf(){return this.__wrapped__}lodash.after=after;lodash.assign=assign;lodash.at=at;lodash.bind=bind;lodash.bindAll=bindAll;lodash.bindKey=bindKey;lodash.chain=chain;lodash.compact=compact;lodash.compose=compose;lodash.constant=constant;lodash.countBy=countBy;lodash.create=create;lodash.createCallback=createCallback;lodash.curry=curry;lodash.debounce=debounce;lodash.defaults=defaults;lodash.defer=defer;lodash.delay=delay;lodash.difference=difference;lodash.filter=filter;lodash.flatten=flatten;lodash.forEach=forEach;lodash.forEachRight=forEachRight;lodash.forIn=forIn;lodash.forInRight=forInRight;lodash.forOwn=forOwn;lodash.forOwnRight=forOwnRight;lodash.functions=functions;lodash.groupBy=groupBy;lodash.indexBy=indexBy;lodash.initial=initial;lodash.intersection=intersection;lodash.invert=invert;lodash.invoke=invoke;lodash.keys=keys;lodash.map=map;lodash.mapValues=mapValues;lodash.max=max;lodash.memoize=memoize;lodash.merge=merge;lodash.min=min;lodash.omit=omit;lodash.once=once;lodash.pairs=pairs;lodash.partial=partial;lodash.partialRight=partialRight;lodash.pick=pick;lodash.pluck=pluck;lodash.property=property;lodash.pull=pull;lodash.range=range;lodash.reject=reject;lodash.remove=remove;lodash.rest=rest;lodash.shuffle=shuffle;lodash.sortBy=sortBy;lodash.tap=tap;lodash.throttle=throttle;lodash.times=times;lodash.toArray=toArray;lodash.transform=transform;lodash.union=union;lodash.uniq=uniq;lodash.values=values;lodash.where=where;lodash.without=without;lodash.wrap=wrap;lodash.xor=xor;lodash.zip=zip;lodash.zipObject=zipObject;lodash.collect=map;lodash.drop=rest;lodash.each=forEach;lodash.eachRight=forEachRight;lodash.extend=assign;lodash.methods=functions;lodash.object=zipObject;lodash.select=filter;lodash.tail=rest;lodash.unique=uniq;lodash.unzip=zip;mixin(lodash);lodash.clone=clone;lodash.cloneDeep=cloneDeep;lodash.contains=contains;lodash.escape=escape;lodash.every=every;lodash.find=find;lodash.findIndex=findIndex;lodash.findKey=findKey;lodash.findLast=findLast;lodash.findLastIndex=findLastIndex;lodash.findLastKey=findLastKey;lodash.has=has;lodash.identity=identity;lodash.indexOf=indexOf;lodash.isArguments=isArguments;lodash.isArray=isArray;lodash.isBoolean=isBoolean;lodash.isDate=isDate;lodash.isElement=isElement;lodash.isEmpty=isEmpty;lodash.isEqual=isEqual;lodash.isFinite=isFinite;lodash.isFunction=isFunction;lodash.isNaN=isNaN;lodash.isNull=isNull;lodash.isNumber=isNumber;lodash.isObject=isObject;lodash.isPlainObject=isPlainObject;lodash.isRegExp=isRegExp;lodash.isString=isString;lodash.isUndefined=isUndefined;lodash.lastIndexOf=lastIndexOf;lodash.mixin=mixin;lodash.noConflict=noConflict;lodash.noop=noop;lodash.now=now;lodash.parseInt=parseInt;lodash.random=random;lodash.reduce=reduce;lodash.reduceRight=reduceRight;lodash.result=result;lodash.runInContext=runInContext;lodash.size=size;lodash.some=some;lodash.sortedIndex=sortedIndex;lodash.template=template;lodash.unescape=unescape;lodash.uniqueId=uniqueId;lodash.all=every;lodash.any=some;lodash.detect=find;lodash.findWhere=find;lodash.foldl=reduce;lodash.foldr=reduceRight;lodash.include=contains;lodash.inject=reduce;mixin(function(){var source={};forOwn(lodash,function(func,methodName){if(!lodash.prototype[methodName]){source[methodName]=func}});return source}(),false);lodash.first=first;lodash.last=last;lodash.sample=sample;lodash.take=first;lodash.head=first;forOwn(lodash,function(func,methodName){var callbackable=methodName!=="sample";if(!lodash.prototype[methodName]){lodash.prototype[methodName]=function(n,guard){var chainAll=this.__chain__,result=func(this.__wrapped__,n,guard);return!chainAll&&(n==null||guard&&!(callbackable&&typeof n=="function"))?result:new lodashWrapper(result,chainAll)}}});lodash.VERSION="2.4.2";lodash.prototype.chain=wrapperChain;lodash.prototype.toString=wrapperToString;lodash.prototype.value=wrapperValueOf;lodash.prototype.valueOf=wrapperValueOf;forEach(["join","pop","shift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){var chainAll=this.__chain__,result=func.apply(this.__wrapped__,arguments);return chainAll?new lodashWrapper(result,chainAll):result}});forEach(["push","reverse","sort","unshift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){func.apply(this.__wrapped__,arguments);return this}});forEach(["concat","slice","splice"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return new lodashWrapper(func.apply(this.__wrapped__,arguments),this.__chain__)}});return lodash}var _=runInContext();if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){root._=_;define(function(){return _})}else if(freeExports&&freeModule){if(moduleExports){(freeModule.exports=_)._=_}else{freeExports._=_}}else{root._=_}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],15:[function(require,module,exports){(function(root,factory){"use strict";if(typeof exports==="object"){module.exports=factory()}else if(typeof define==="function"&&define.amd){define(factory)}else{root.UltraDeepClone=factory()}})(this,function(){var functionPropertyFilter=["caller","arguments"];var typedArrayPropertyFilter=["BYTES_PER_ELEMENT","get","set","slice","subarray","buffer","length","byteOffset","byteLength"];var primitiveCloner=makeCloner(clonePrimitive);var typedArrayCloner=makeRecursiveCloner(makeCloner(cloneTypedArray),typedArrayPropertyFilter);function typeString(type){return"[object "+type+"]"}var cloneFunctions={};cloneFunctions[typeString("RegExp")]=makeCloner(cloneRegExp);cloneFunctions[typeString("Date")]=makeCloner(cloneDate);cloneFunctions[typeString("Function")]=makeRecursiveCloner(makeCloner(cloneFunction),functionPropertyFilter);cloneFunctions[typeString("Object")]=makeRecursiveCloner(makeCloner(cloneObject));cloneFunctions[typeString("Array")]=makeRecursiveCloner(makeCloner(cloneArray));["Null","Undefined","Number","String","Boolean"].map(typeString).forEach(function(type){cloneFunctions[type]=primitiveCloner});["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].map(typeString).forEach(function(type){cloneFunctions[type]=typedArrayCloner});function makeArguments(numberOfArgs){var letters=[];for(var i=1;i<=numberOfArgs;i++)letters.push("arg"+i);return letters}function wrapFunctionWithArity(callback){var argList=makeArguments(callback.length);var functionCode="return false || function ";functionCode+=callback.name+"(";functionCode+=argList.join(", ")+") {\n";functionCode+="return fn.apply(this, arguments);\n";functionCode+="};";return Function("fn",functionCode)(callback)}function makeCloner(cloneThing){return function(thing,thingStack,copyStack){thingStack.push(thing);var copy=cloneThing(thing);copyStack.push(copy);return copy}}function clonePrimitive(primitive){return primitive}function cloneRegExp(regexp){return new RegExp(regexp)}function cloneDate(date){return new Date(date.getTime())}function cloneFunction(fn){return wrapFunctionWithArity(fn)}function cloneObject(object){return Object.create(Object.getPrototypeOf(object))}function cloneArray(array){return[]}function cloneTypedArray(typedArray){var len=typedArray.length;return new typedArray.constructor(len)}function makeRecursiveCloner(cloneThing,propertyFilter){return function(thing,thingStack,copyStack){var clone=this;return Object.getOwnPropertyNames(thing).filter(function(prop){return!propertyFilter||propertyFilter.indexOf(prop)===-1}).reduce(function(copy,prop){var thingOffset=thingStack.indexOf(thing[prop]);if(thingOffset===-1){copy[prop]=clone(thing[prop])}else{copy[prop]=copyStack[thingOffset]}return copy},cloneThing(thing,thingStack,copyStack))}}return function _ultraDeepClone(source){var thingStack=[];var copyStack=[];function clone(thing){var typeOfThing=Object.prototype.toString.call(thing);return cloneFunctions[typeOfThing].call(clone,thing,thingStack,copyStack)}return clone(source)}})},{}],16:[function(require,module,exports){module.exports=extend;function extend(){var target={};for(var i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(source.hasOwnProperty(key)){target[key]=source[key]}}}return target}},{}],17:[function(require,module,exports){WYMeditor.EXTERNAL_MODULES.ObjectHistory=require("object-history")},{"object-history":1}]},{},[17])(17)});(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.foo=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";module.exports=function(element){var self=this;var Combokeys=self.constructor;self.callbacks={};self.directMap={};self.sequenceLevels={};self.resetTimer;self.ignoreNextKeyup=false;self.ignoreNextKeypress=false;self.nextExpectedAction=false;self.element=element;self.addEvents();Combokeys.instances.push(self);return self};module.exports.prototype.bind=require("./prototype/bind");module.exports.prototype.bindMultiple=require("./prototype/bindMultiple");module.exports.prototype.unbind=require("./prototype/unbind");module.exports.prototype.trigger=require("./prototype/trigger");module.exports.prototype.reset=require("./prototype/reset.js");module.exports.prototype.stopCallback=require("./prototype/stopCallback");module.exports.prototype.handleKey=require("./prototype/handleKey");module.exports.prototype.addEvents=require("./prototype/addEvents");module.exports.prototype.bindSingle=require("./prototype/bindSingle");module.exports.prototype.getKeyInfo=require("./prototype/getKeyInfo");module.exports.prototype.pickBestAction=require("./prototype/pickBestAction");module.exports.prototype.getReverseMap=require("./prototype/getReverseMap");module.exports.prototype.getMatches=require("./prototype/getMatches");module.exports.prototype.resetSequences=require("./prototype/resetSequences");module.exports.prototype.fireCallback=require("./prototype/fireCallback");module.exports.prototype.bindSequence=require("./prototype/bindSequence");module.exports.prototype.resetSequenceTimer=require("./prototype/resetSequenceTimer");module.exports.prototype.detach=require("./prototype/detach");module.exports.instances=[];module.exports.reset=require("./reset");module.exports.REVERSE_MAP=null},{"./prototype/addEvents":2,"./prototype/bind":3,"./prototype/bindMultiple":4,"./prototype/bindSequence":5,"./prototype/bindSingle":6,"./prototype/detach":7,"./prototype/fireCallback":8,"./prototype/getKeyInfo":9,"./prototype/getMatches":10,"./prototype/getReverseMap":11,"./prototype/handleKey":12,"./prototype/pickBestAction":15,"./prototype/reset.js":16,"./prototype/resetSequenceTimer":17,"./prototype/resetSequences":18,"./prototype/stopCallback":19,"./prototype/trigger":20,"./prototype/unbind":21,"./reset":22}],2:[function(require,module,exports){"use strict";module.exports=function(){var self=this;var on=require("dom-event");var element=self.element;self.eventHandler=require("./handleKeyEvent").bind(self);on(element,"keypress",self.eventHandler);on(element,"keydown",self.eventHandler);on(element,"keyup",self.eventHandler)}},{"./handleKeyEvent":13,"dom-event":33}],3:[function(require,module,exports){"use strict";module.exports=function(keys,callback,action){var self=this;keys=keys instanceof Array?keys:[keys];self.bindMultiple(keys,callback,action);return self}},{}],4:[function(require,module,exports){"use strict";module.exports=function(combinations,callback,action){var self=this;for(var j=0;j<combinations.length;++j){self.bindSingle(combinations[j],callback,action)}}},{}],5:[function(require,module,exports){"use strict";module.exports=function(combo,keys,callback,action){var self=this;self.sequenceLevels[combo]=0;function increaseSequence(nextAction){return function(){self.nextExpectedAction=nextAction;++self.sequenceLevels[combo];self.resetSequenceTimer()}}function callbackAndReset(e){var characterFromEvent;self.fireCallback(callback,e,combo);if(action!=="keyup"){characterFromEvent=require("../../helpers/characterFromEvent");self.ignoreNextKeyup=characterFromEvent(e)}setTimeout(function(){self.resetSequences()},10)}for(var j=0;j<keys.length;++j){var isFinal=j+1===keys.length;var wrappedCallback=isFinal?callbackAndReset:increaseSequence(action||self.getKeyInfo(keys[j+1]).action);self.bindSingle(keys[j],wrappedCallback,action,combo,j)}}},{"../../helpers/characterFromEvent":23}],6:[function(require,module,exports){"use strict";module.exports=function(combination,callback,action,sequenceName,level){var self=this;self.directMap[combination+":"+action]=callback;combination=combination.replace(/\s+/g," ");var sequence=combination.split(" ");var info;if(sequence.length>1){self.bindSequence(combination,sequence,callback,action);return}info=self.getKeyInfo(combination,action);self.callbacks[info.key]=self.callbacks[info.key]||[];self.getMatches(info.key,info.modifiers,{type:info.action},sequenceName,combination,level);self.callbacks[info.key][sequenceName?"unshift":"push"]({callback:callback,modifiers:info.modifiers,action:info.action,seq:sequenceName,level:level,combo:combination})}},{}],7:[function(require,module,exports){var off=require("dom-event").off;module.exports=function(){var self=this;var element=self.element;off(element,"keypress",self.eventHandler);off(element,"keydown",self.eventHandler);off(element,"keyup",self.eventHandler)}},{"dom-event":33}],8:[function(require,module,exports){"use strict";module.exports=function(callback,e,combo,sequence){var self=this;var preventDefault;var stopPropagation;if(self.stopCallback(e,e.target||e.srcElement,combo,sequence)){return}if(callback(e,combo)===false){preventDefault=require("../../helpers/preventDefault");preventDefault(e);stopPropagation=require("../../helpers/stopPropagation");stopPropagation(e)}}},{"../../helpers/preventDefault":27,"../../helpers/stopPropagation":32}],9:[function(require,module,exports){"use strict";module.exports=function(combination,action){var self=this;var keysFromString;var keys;var key;var j;var modifiers=[];var SPECIAL_ALIASES;var SHIFT_MAP;var isModifier;keysFromString=require("../../helpers/keysFromString");keys=keysFromString(combination);SPECIAL_ALIASES=require("../../helpers/special-aliases");SHIFT_MAP=require("../../helpers/shift-map");isModifier=require("../../helpers/isModifier");for(j=0;j<keys.length;++j){key=keys[j];if(SPECIAL_ALIASES[key]){key=SPECIAL_ALIASES[key]}if(action&&action!=="keypress"&&SHIFT_MAP[key]){key=SHIFT_MAP[key];modifiers.push("shift")}if(isModifier(key)){modifiers.push(key)}}action=self.pickBestAction(key,modifiers,action);return{key:key,modifiers:modifiers,action:action}}},{"../../helpers/isModifier":25,"../../helpers/keysFromString":26,"../../helpers/shift-map":28,"../../helpers/special-aliases":29}],10:[function(require,module,exports){"use strict";module.exports=function(character,modifiers,e,sequenceName,combination,level){var self=this;var j;var callback;var matches=[];var action=e.type;var isModifier;var modifiersMatch;if(action==="keypress"){var anyCharCallbacks=self.callbacks["any-character"]||[];anyCharCallbacks.forEach(function(callback){matches.push(callback)})}if(!self.callbacks[character]){return matches}isModifier=require("../../helpers/isModifier");if(action==="keyup"&&isModifier(character)){modifiers=[character]}for(j=0;j<self.callbacks[character].length;++j){callback=self.callbacks[character][j];if(!sequenceName&&callback.seq&&self.sequenceLevels[callback.seq]!==callback.level){continue}if(action!==callback.action){continue}modifiersMatch=require("./modifiersMatch");if(action==="keypress"&&!e.metaKey&&!e.ctrlKey||modifiersMatch(modifiers,callback.modifiers)){var deleteCombo=!sequenceName&&callback.combo===combination;var deleteSequence=sequenceName&&callback.seq===sequenceName&&callback.level===level;if(deleteCombo||deleteSequence){self.callbacks[character].splice(j,1)}matches.push(callback)}}return matches}},{"../../helpers/isModifier":25,"./modifiersMatch":14}],11:[function(require,module,exports){"use strict";module.exports=function(){var self=this;var constructor=self.constructor;var SPECIAL_KEYS_MAP;if(!constructor.REVERSE_MAP){constructor.REVERSE_MAP={};SPECIAL_KEYS_MAP=require("../../helpers/special-keys-map");for(var key in SPECIAL_KEYS_MAP){if(key>95&&key<112){continue}if(SPECIAL_KEYS_MAP.hasOwnProperty(key)){constructor.REVERSE_MAP[SPECIAL_KEYS_MAP[key]]=key}}}return constructor.REVERSE_MAP}},{"../../helpers/special-keys-map":31}],12:[function(require,module,exports){"use strict";module.exports=function(character,modifiers,e){var self=this;var callbacks;var j;var doNotReset={};var maxLevel=0;var processedSequenceCallback=false;var isModifier;var ignoreThisKeypress;callbacks=self.getMatches(character,modifiers,e);for(j=0;j<callbacks.length;++j){if(callbacks[j].seq){maxLevel=Math.max(maxLevel,callbacks[j].level)}}for(j=0;j<callbacks.length;++j){if(callbacks[j].seq){if(callbacks[j].level!==maxLevel){continue}processedSequenceCallback=true;doNotReset[callbacks[j].seq]=1;self.fireCallback(callbacks[j].callback,e,callbacks[j].combo,callbacks[j].seq);continue}if(!processedSequenceCallback){self.fireCallback(callbacks[j].callback,e,callbacks[j].combo)}}ignoreThisKeypress=e.type==="keypress"&&self.ignoreNextKeypress;isModifier=require("../../helpers/isModifier");if(e.type===self.nextExpectedAction&&!isModifier(character)&&!ignoreThisKeypress){self.resetSequences(doNotReset)}self.ignoreNextKeypress=processedSequenceCallback&&e.type==="keydown"}},{"../../helpers/isModifier":25}],13:[function(require,module,exports){"use strict";module.exports=function(e){var self=this;var characterFromEvent;var eventModifiers;if(typeof e.which!=="number"){e.which=e.keyCode}characterFromEvent=require("../../helpers/characterFromEvent");var character=characterFromEvent(e);if(!character){return}if(e.type==="keyup"&&self.ignoreNextKeyup===character){self.ignoreNextKeyup=false;return}eventModifiers=require("../../helpers/eventModifiers");self.handleKey(character,eventModifiers(e),e)}},{"../../helpers/characterFromEvent":23,"../../helpers/eventModifiers":24}],14:[function(require,module,exports){"use strict";module.exports=function(modifiers1,modifiers2){return modifiers1.sort().join(",")===modifiers2.sort().join(",")}},{}],15:[function(require,module,exports){"use strict";module.exports=function(key,modifiers,action){var self=this;if(!action){action=self.getReverseMap()[key]?"keydown":"keypress"}if(action==="keypress"&&modifiers.length){action="keydown"}return action}},{}],16:[function(require,module,exports){"use strict";module.exports=function(){var self=this;self.callbacks={};self.directMap={};return this}},{}],17:[function(require,module,exports){"use strict";module.exports=function(){var self=this;clearTimeout(self.resetTimer);self.resetTimer=setTimeout(function(){self.resetSequences()},1e3)}},{}],18:[function(require,module,exports){"use strict";module.exports=function(doNotReset){var self=this;doNotReset=doNotReset||{};var activeSequences=false;var key;for(key in self.sequenceLevels){if(doNotReset[key]){activeSequences=true;continue}self.sequenceLevels[key]=0}if(!activeSequences){self.nextExpectedAction=false}}},{}],19:[function(require,module,exports){"use strict";module.exports=function(e,element){if((" "+element.className+" ").indexOf(" combokeys ")>-1){return false}var tagName=element.tagName.toLowerCase();return tagName==="input"||tagName==="select"||tagName==="textarea"||element.isContentEditable}},{}],20:[function(require,module,exports){"use strict";module.exports=function(keys,action){var self=this;if(self.directMap[keys+":"+action]){self.directMap[keys+":"+action]({},keys)}return this}},{}],21:[function(require,module,exports){"use strict";module.exports=function(keys,action){var self=this;return self.bind(keys,function(){},action)}},{}],22:[function(require,module,exports){"use strict";module.exports=function(){var self=this;self.instances.forEach(function(combokeys){combokeys.reset()})}},{}],23:[function(require,module,exports){"use strict";module.exports=function(e){var SPECIAL_KEYS_MAP,SPECIAL_CHARACTERS_MAP;SPECIAL_KEYS_MAP=require("./special-keys-map");SPECIAL_CHARACTERS_MAP=require("./special-characters-map");if(e.type==="keypress"){var character=String.fromCharCode(e.which);if(!e.shiftKey){character=character.toLowerCase()}return character}if(SPECIAL_KEYS_MAP[e.which]){return SPECIAL_KEYS_MAP[e.which]}if(SPECIAL_CHARACTERS_MAP[e.which]){return SPECIAL_CHARACTERS_MAP[e.which]}return String.fromCharCode(e.which).toLowerCase()}},{"./special-characters-map":30,"./special-keys-map":31}],24:[function(require,module,exports){"use strict";module.exports=function(e){var modifiers=[];if(e.shiftKey){modifiers.push("shift")}if(e.altKey){modifiers.push("alt")}if(e.ctrlKey){modifiers.push("ctrl")}if(e.metaKey){modifiers.push("meta")}return modifiers}},{}],25:[function(require,module,exports){"use strict";module.exports=function(key){return key==="shift"||key==="ctrl"||key==="alt"||key==="meta"}},{}],26:[function(require,module,exports){"use strict";module.exports=function(combination){if(combination==="+"){return["+"]}return combination.split("+")}},{}],27:[function(require,module,exports){"use strict";module.exports=function(e){if(e.preventDefault){e.preventDefault();return}e.returnValue=false}},{}],28:[function(require,module,exports){"use strict";module.exports={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"}},{}],29:[function(require,module,exports){"use strict";module.exports={option:"alt",command:"meta",return:"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"}},{}],30:[function(require,module,exports){"use strict";module.exports={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}},{}],31:[function(require,module,exports){"use strict";module.exports={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",187:"plus",189:"minus",224:"meta"};for(var i=1;i<20;++i){module.exports[111+i]="f"+i}for(i=0;i<=9;++i){module.exports[i+96]=i}},{}],32:[function(require,module,exports){"use strict";module.exports=function(e){if(e.stopPropagation){e.stopPropagation();return}e.cancelBubble=true}},{}],33:[function(require,module,exports){module.exports=on;module.exports.on=on;module.exports.off=off;function on(element,event,callback,capture){!element.addEventListener&&(event="on"+event);(element.addEventListener||element.attachEvent).call(element,event,callback,capture);return callback}function off(element,event,callback,capture){!element.removeEventListener&&(event="on"+event);(element.removeEventListener||element.detachEvent).call(element,event,callback,capture);return callback}},{}],34:[function(require,module,exports){WYMeditor.EXTERNAL_MODULES.Combokeys=require("combokeys")},{combokeys:1}]},{},[34])(34)});(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.foo=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";module.exports=function(element,onSensible,onAny){var self=this;if(typeof onSensible!=="function"){throw new Error("Expected a function")}self.element=element;self.onSensible=onSensible;self.onAny=onAny;self.listen();return self};module.exports.prototype.listen=require("./prototype/listen");module.exports.prototype.discern=require("./prototype/discern");module.exports.prototype.reset=require("./prototype/reset");module.exports.prototype.detach=require("./prototype/detach");module.exports.prototype.callbackSensible=require("./prototype/callback-sensible");module.exports.prototype.callbackAny=require("./prototype/callback-any")},{"./prototype/callback-any":2,"./prototype/callback-sensible":3,"./prototype/detach":4,"./prototype/discern":5,"./prototype/listen":6,"./prototype/reset":7}],2:[function(require,module,exports){"use strict";module.exports=function(){var self=this;(self.onAny||function(){}).call(self)}},{}],3:[function(require,module,exports){"use strict";module.exports=function(){var self=this;self.onSensible()}},{}],4:[function(require,module,exports){"use strict";var off=require("dom-events").off;var TEXT_ALTERING_EVENT_TYPES=require("../../text-altering-event-types");module.exports=function(){var self=this;TEXT_ALTERING_EVENT_TYPES.forEach(function(type){off(self.element,type,self.listener)})}},{"../../text-altering-event-types":8,"dom-events":11}],5:[function(require,module,exports){"use strict";var getType=require("../../textEditType");module.exports=function(e){var self=this;var type=getType(e);if(!type){return}self.callbackAny();self.previousEditType=self.lastEditType;self.lastEditType=type;if(!self.previousEditType)return;if(self.lastEditType!==self.previousEditType||self.lastEditType==="paste"||self.lastEditType==="drop"){self.callbackSensible()}}},{"../../textEditType":9}],6:[function(require,module,exports){"use strict";var on;var TEXT_ALTERING_EVENT_TYPES;on=require("add-event-handler");TEXT_ALTERING_EVENT_TYPES=require("../../text-altering-event-types");module.exports=function(){var self=this;self.listener=function(e){self.discern(e)};TEXT_ALTERING_EVENT_TYPES.forEach(function(type){on(self.element,type,self.listener)})}},{"../../text-altering-event-types":8,"add-event-handler":10}],7:[function(require,module,exports){"use strict";module.exports=function(){var self=this;delete self.lastEditType}},{}],8:[function(require,module,exports){"use strict";module.exports=["keydown","paste","drop"]},{}],9:[function(require,module,exports){"use strict";var BACKWARDS_REMOVAL_KEYS=["backspace"];var FORWARD_REMOVAL_KEYS=["del","delete"];var EDIT_PREVENTING_PROPS=["altKey","ctrlKey","metaKey"];var keycode=require("keycode");module.exports=function(e){if(e.type==="keydown"){var noEdit;EDIT_PREVENTING_PROPS.forEach(function(prop){if(e[prop]){noEdit=true}});if(noEdit){return false}var key=keycode(e);if(BACKWARDS_REMOVAL_KEYS.indexOf(key)>-1){return"backwardsRemoval"}if(FORWARD_REMOVAL_KEYS.indexOf(key)>-1){return"forwardRemoval"}if(key==="space"){return key}if(key==="enter"){return key}return"characterAddition"}if(e.type==="paste"){return e.type}if(e.type==="drop"){return e.type}throw new Error("Shouldn't get this far")}},{keycode:15}],10:[function(require,module,exports){"use strict";module.exports=function(element,type,handler){if(element.addEventListener){return element.addEventListener(type,handler,false)}else if(element.attachEvent){return element.attachEvent("on"+type,handler)}else{throw"No event handler adding interface found"}}},{}],11:[function(require,module,exports){var synth=require("synthetic-dom-events");var on=function(element,name,fn,capture){return element.addEventListener(name,fn,capture||false)};var off=function(element,name,fn,capture){return element.removeEventListener(name,fn,capture||false)};var once=function(element,name,fn,capture){function tmp(ev){off(element,name,tmp,capture);fn(ev)}on(element,name,tmp,capture)};var emit=function(element,name,opt){var ev=synth(name,opt);element.dispatchEvent(ev)};if(!document.addEventListener){on=function(element,name,fn){return element.attachEvent("on"+name,fn)}}if(!document.removeEventListener){off=function(element,name,fn){return element.detachEvent("on"+name,fn)}}if(!document.dispatchEvent){emit=function(element,name,opt){var ev=synth(name,opt);return element.fireEvent("on"+ev.type,ev)}}module.exports={on:on,off:off,once:once,emit:emit}},{"synthetic-dom-events":12}],12:[function(require,module,exports){var win=window;var doc=document||{};var root=doc.documentElement||{};var use_key_event=true;try{doc.createEvent("KeyEvents")}catch(err){use_key_event=false}function check_kb(ev,opts){if(ev.ctrlKey!=(opts.ctrlKey||false)||ev.altKey!=(opts.altKey||false)||ev.shiftKey!=(opts.shiftKey||false)||ev.metaKey!=(opts.metaKey||false)||ev.keyCode!=(opts.keyCode||0)||ev.charCode!=(opts.charCode||0)){ev=document.createEvent("Event");ev.initEvent(opts.type,opts.bubbles,opts.cancelable);ev.ctrlKey=opts.ctrlKey||false;ev.altKey=opts.altKey||false;ev.shiftKey=opts.shiftKey||false;ev.metaKey=opts.metaKey||false;ev.keyCode=opts.keyCode||0;ev.charCode=opts.charCode||0}return ev}var modern=function(type,opts){opts=opts||{};var family=typeOf(type);var init_fam=family;if(family==="KeyboardEvent"&&use_key_event){family="KeyEvents";init_fam="KeyEvent"}var ev=doc.createEvent(family);var init_fn="init"+init_fam;var init=typeof ev[init_fn]==="function"?init_fn:"initEvent";var sig=initSignatures[init];var args=[];var used={};opts.type=type;for(var i=0;i<sig.length;++i){var key=sig[i];var val=opts[key];if(val===undefined){val=ev[key]}used[key]=true;args.push(val)}ev[init].apply(ev,args);if(family==="KeyboardEvent"){ev=check_kb(ev,opts)}for(var key in opts){if(!used[key]){ev[key]=opts[key]}}return ev};var legacy=function(type,opts){opts=opts||{};var ev=doc.createEventObject();ev.type=type;for(var key in opts){if(opts[key]!==undefined){ev[key]=opts[key]}}return ev};module.exports=doc.createEvent?modern:legacy;var initSignatures=require("./init.json");var types=require("./types.json");var typeOf=function(){var typs={};for(var key in types){var ts=types[key];for(var i=0;i<ts.length;i++){typs[ts[i]]=key}}return function(name){return typs[name]||"Event"}}()},{"./init.json":13,"./types.json":14}],13:[function(require,module,exports){module.exports={initEvent:["type","bubbles","cancelable"],initUIEvent:["type","bubbles","cancelable","view","detail"],initMouseEvent:["type","bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget"],initMutationEvent:["type","bubbles","cancelable","relatedNode","prevValue","newValue","attrName","attrChange"],initKeyboardEvent:["type","bubbles","cancelable","view","ctrlKey","altKey","shiftKey","metaKey","keyCode","charCode"],initKeyEvent:["type","bubbles","cancelable","view","ctrlKey","altKey","shiftKey","metaKey","keyCode","charCode"]}},{}],14:[function(require,module,exports){module.exports={MouseEvent:["click","mousedown","mouseup","mouseover","mousemove","mouseout"],KeyboardEvent:["keydown","keyup","keypress"],MutationEvent:["DOMSubtreeModified","DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMAttrModified","DOMCharacterDataModified"],HTMLEvents:["load","unload","abort","error","select","change","submit","reset","focus","blur","resize","scroll"],UIEvent:["DOMFocusIn","DOMFocusOut","DOMActivate"]}},{}],15:[function(require,module,exports){exports=module.exports=function(searchInput){if(searchInput&&"object"===typeof searchInput){var hasKeyCode=searchInput.which||searchInput.keyCode||searchInput.charCode;if(hasKeyCode)searchInput=hasKeyCode}if("number"===typeof searchInput)return names[searchInput];var search=String(searchInput);var foundNamedKey=codes[search.toLowerCase()];if(foundNamedKey)return foundNamedKey;var foundNamedKey=aliases[search.toLowerCase()];if(foundNamedKey)return foundNamedKey;if(search.length===1)return search.charCodeAt(0);return undefined};var codes=exports.code=exports.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"right click":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222};var aliases=exports.aliases={windows:91,"â§":16,"â¥":18,"â":17,"â":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,pgup:33,pgdn:33,ins:45,del:46,cmd:91};for(i=97;i<123;i++)codes[String.fromCharCode(i)]=i-32;for(var i=48;i<58;i++)codes[i-48]=i;for(i=1;i<13;i++)codes["f"+i]=i+111;for(i=0;i<10;i++)codes["numpad "+i]=i+96;var names=exports.names=exports.title={};for(i in codes)names[codes[i]]=i;for(var alias in aliases){codes[alias]=aliases[alias]}},{}],16:[function(require,module,exports){WYMeditor.EXTERNAL_MODULES.Edited=require("edited")},{edited:1}]},{},[16])(16)});"use strict";WYMeditor.UndoRedo=function(wym){var undoRedo=this;undoRedo.wym=wym;wym.keyboard.combokeys.bind("mod+z",function(){wym.undoRedo.undo();return false});wym.keyboard.combokeys.bind(["shift+meta+z","mod+y"],function(){wym.undoRedo.redo();return false})};WYMeditor.UndoRedo.prototype._onBodyFocus=function(){var undoRedo=this,wym=undoRedo.wym;if(undoRedo.history){return}setTimeout(function(){undoRedo._instantiateHistory(wym.getCurrentState())},0)};WYMeditor.UndoRedo.prototype._add=function(){var undoRedo=this,wym=undoRedo.wym;if(!undoRedo.history){return}undoRedo.history.add(wym.getCurrentState());undoRedo.hasUnregisteredModification=false};WYMeditor.UndoRedo.prototype._do=function(what){var undoRedo=this,wym=undoRedo.wym,history=undoRedo.history,state,postEventName;if(!undoRedo.history){return}if(what===WYMeditor.UndoRedo.UN){if(history.lengthBackward()===0){return}if(undoRedo.hasUnregisteredModification){undoRedo._add()}history.backward();postEventName="postUndo"}else if(what===WYMeditor.UndoRedo.RE){if(history.lengthForward()===0){return}history.forward();postEventName="postRedo"}else{throw"Single parameter must be either `'un'` or `'re'` "+"(there are constants for those)."}state=history.get();wym.rawHtml(state.html);if(state.savedSelection){state.savedSelection.win=wym._iframe.contentWindow;state.savedSelection.doc=wym._doc;rangy.restoreSelection(state.savedSelection)}jQuery(wym.element).trigger(WYMeditor.EVENTS[postEventName])};WYMeditor.UndoRedo.UN="un";WYMeditor.UndoRedo.RE="re";WYMeditor.UndoRedo.prototype.redo=function(){var undoRedo=this;undoRedo._do(WYMeditor.UndoRedo.RE)};WYMeditor.UndoRedo.prototype.undo=function(){var undoRedo=this;undoRedo._do(WYMeditor.UndoRedo.UN)};WYMeditor.UndoRedo.prototype.reset=function(){var undoRedo=this,wym=undoRedo.wym;undoRedo._instantiateHistory(wym.getCurrentState());undoRedo.hasUnregisteredModification=null};WYMeditor.UndoRedo.prototype._instantiateHistory=function(initialState){var undoRedo=this;undoRedo.history=new WYMeditor.EXTERNAL_MODULES.ObjectHistory(initialState,{limit:100})};"use strict";WYMeditor.Keyboard=function(wym){var keyboard=this;keyboard._wym=wym;keyboard.combokeys=new WYMeditor.EXTERNAL_MODULES.Combokeys(wym._doc);return keyboard};WYMeditor.Keyboard.DEFAULT_KEYBOARD_SHORTCUTS=[{combo:"mod+b",cb:function(){var wym=this;wym.exec(WYMeditor.EXEC_COMMANDS.BOLD);return false}},{combo:"mod+i",cb:function(){var wym=this;wym.exec(WYMeditor.EXEC_COMMANDS.ITALIC);return false}},{combo:"mod+k",cb:function(){var wym=this;wym.dialog(WYMeditor.DIALOGS.CreateLink);return false}},{combo:"tab",cb:function(){return false}}];WYMeditor.Keyboard.prototype._attachDefaultKeyboardShortcuts=function(){var keyboard=this,wym=keyboard._wym,SHORTCUTS=keyboard.constructor.DEFAULT_KEYBOARD_SHORTCUTS,shortcut,i;for(i=0;i<SHORTCUTS.length;i++){shortcut=SHORTCUTS[i];keyboard.combokeys.bind(shortcut.combo,function(cb){return function(){return cb.call(wym)}}(shortcut.cb))}};"use strict";WYMeditor.NativeEditRegistration=function(wym){var nativeEditRegistration=this;nativeEditRegistration.wym=wym;nativeEditRegistration.edited=new WYMeditor.EXTERNAL_MODULES.Edited(wym._doc.body,nativeEditRegistration._onSensibleNativeEdit.bind(nativeEditRegistration),nativeEditRegistration._onAnyNativeEdit.bind(nativeEditRegistration))};WYMeditor.NativeEditRegistration.prototype._onSensibleNativeEdit=function(){var nativeEditRegistration=this;nativeEditRegistration.wym.registerModification(true)};WYMeditor.NativeEditRegistration.prototype._onAnyNativeEdit=function(){var nativeEditRegistration=this,undoRedo=nativeEditRegistration.wym.undoRedo;if(undoRedo.history){undoRedo.history.forgetAllForward()}undoRedo.hasUnregisteredModification=true};WYMeditor.LEXER_ENTER=1;WYMeditor.LEXER_MATCHED=2;WYMeditor.LEXER_UNMATCHED=3;WYMeditor.LEXER_EXIT=4;WYMeditor.LEXER_SPECIAL=5;WYMeditor.Lexer=function(parser,start,case_sensitive){start=start||"accept";this._case=case_sensitive||false;this._regexes={};this._parser=parser;this._mode=new WYMeditor.StateStack(start);this._mode_handlers={};this._mode_handlers[start]=start;return this};WYMeditor.Lexer.prototype.addPattern=function(pattern,mode){mode=mode||"accept";if(typeof this._regexes[mode]=="undefined"){this._regexes[mode]=new WYMeditor.ParallelRegex(this._case)}this._regexes[mode].addPattern(pattern);if(typeof this._mode_handlers[mode]=="undefined"){this._mode_handlers[mode]=mode}};WYMeditor.Lexer.prototype.addEntryPattern=function(pattern,mode,new_mode){if(typeof this._regexes[mode]=="undefined"){this._regexes[mode]=new WYMeditor.ParallelRegex(this._case)}this._regexes[mode].addPattern(pattern,new_mode);if(typeof this._mode_handlers[new_mode]=="undefined"){this._mode_handlers[new_mode]=new_mode}};WYMeditor.Lexer.prototype.addExitPattern=function(pattern,mode){if(typeof this._regexes[mode]=="undefined"){this._regexes[mode]=new WYMeditor.ParallelRegex(this._case)}this._regexes[mode].addPattern(pattern,"__exit");if(typeof this._mode_handlers[mode]=="undefined"){this._mode_handlers[mode]=mode}};WYMeditor.Lexer.prototype.addSpecialPattern=function(pattern,mode,special){if(typeof this._regexes[mode]=="undefined"){this._regexes[mode]=new WYMeditor.ParallelRegex(this._case)}this._regexes[mode].addPattern(pattern,"_"+special);if(typeof this._mode_handlers[special]=="undefined"){this._mode_handlers[special]=special}};WYMeditor.Lexer.prototype.mapHandler=function(mode,handler){this._mode_handlers[mode]=handler};WYMeditor.Lexer.prototype.parse=function(raw){if(typeof this._parser=="undefined"){return false}var length=raw.length;var parsed;while(typeof(parsed=this._reduce(raw))=="object"){raw=parsed[0];var unmatched=parsed[1];var matched=parsed[2];var mode=parsed[3];if(!this._dispatchTokens(unmatched,matched,mode)){return false}if(raw===""){return true}if(raw.length==length){return false}length=raw.length}if(!parsed){return false}return this._invokeParser(raw,WYMeditor.LEXER_UNMATCHED)};WYMeditor.Lexer.prototype._dispatchTokens=function(unmatched,matched,mode){mode=mode||false;if(!this._invokeParser(unmatched,WYMeditor.LEXER_UNMATCHED)){return false}if(typeof mode=="boolean"){return this._invokeParser(matched,WYMeditor.LEXER_MATCHED)}if(this._isModeEnd(mode)){if(!this._invokeParser(matched,WYMeditor.LEXER_EXIT)){return false}return this._mode.leave()}if(this._isSpecialMode(mode)){this._mode.enter(this._decodeSpecial(mode));if(!this._invokeParser(matched,WYMeditor.LEXER_SPECIAL)){return false}return this._mode.leave()}this._mode.enter(mode);return this._invokeParser(matched,WYMeditor.LEXER_ENTER)};WYMeditor.Lexer.prototype._isModeEnd=function(mode){return mode==="__exit"};WYMeditor.Lexer.prototype._isSpecialMode=function(mode){return mode.substring(0,1)=="_"};WYMeditor.Lexer.prototype._decodeSpecial=function(mode){return mode.substring(1)};WYMeditor.Lexer.prototype._invokeParser=function(content,is_match){if(content===""){return true}var current=this._mode.getCurrent();var handler=this._mode_handlers[current];var result=this._parser[handler](content,is_match);return result};WYMeditor.Lexer.prototype._reduce=function(raw){var matched=this._regexes[this._mode.getCurrent()].match(raw);var match=matched[1];var action=matched[0];if(action){var unparsed_character_count=raw.indexOf(match);var unparsed=raw.substr(0,unparsed_character_count);raw=raw.substring(unparsed_character_count+match.length);return[raw,unparsed,match,action]}return true};WYMeditor.ParallelRegex=function(case_sensitive){this._case=case_sensitive;this._patterns=[];this._labels=[];this._regex=null;return this};WYMeditor.ParallelRegex.prototype.addPattern=function(pattern,label){label=label||true;var count=this._patterns.length;this._patterns[count]=pattern;this._labels[count]=label;this._regex=null};WYMeditor.ParallelRegex.prototype.match=function(subject){if(this._patterns.length===0){return[false,""]}var matches=subject.match(this._getCompoundedRegex());if(!matches){return[false,""]}var match=matches[0];for(var i=1;i<matches.length;i++){if(matches[i]){return[this._labels[i-1],match]}}return[true,matches[0]]};WYMeditor.ParallelRegex.prototype._getCompoundedRegex=function(){if(this._regex===null){for(var i=0,count=this._patterns.length;i<count;i++){this._patterns[i]="("+this._untokenizeRegex(this._tokenizeRegex(this._patterns[i]).replace(/([\/\(\)])/g,"\\$1"))+")"}this._regex=new RegExp(this._patterns.join("|"),this._getPerlMatchingFlags())}return this._regex};WYMeditor.ParallelRegex.prototype._tokenizeRegex=function(regex){return regex.replace(/\(\?(i|m|s|x|U)\)/,"~~~~~~Tk1$1~~~~~~").replace(/\(\?(\-[i|m|s|x|U])\)/,"~~~~~~Tk2$1~~~~~~").replace(/\(\?\=(.*)\)/,"~~~~~~Tk3$1~~~~~~").replace(/\(\?\!(.*)\)/,"~~~~~~Tk4$1~~~~~~").replace(/\(\?\<\=(.*)\)/,"~~~~~~Tk5$1~~~~~~").replace(/\(\?\<\!(.*)\)/,"~~~~~~Tk6$1~~~~~~").replace(/\(\?\:(.*)\)/,"~~~~~~Tk7$1~~~~~~")};WYMeditor.ParallelRegex.prototype._untokenizeRegex=function(regex){return regex.replace(/~~~~~~Tk1(.{1})~~~~~~/,"(?$1)").replace(/~~~~~~Tk2(.{2})~~~~~~/,"(?$1)").replace(/~~~~~~Tk3(.*)~~~~~~/,"(?=$1)").replace(/~~~~~~Tk4(.*)~~~~~~/,"(?!$1)").replace(/~~~~~~Tk5(.*)~~~~~~/,"(?<=$1)").replace(/~~~~~~Tk6(.*)~~~~~~/,"(?<!$1)").replace(/~~~~~~Tk7(.*)~~~~~~/,"(?:$1)")};WYMeditor.ParallelRegex.prototype._getPerlMatchingFlags=function(){return this._case?"m":"mi"};WYMeditor.StateStack=function(start){this._stack=[start];return this};WYMeditor.StateStack.prototype.getCurrent=function(){return this._stack[this._stack.length-1]};WYMeditor.StateStack.prototype.enter=function(state){this._stack.push(state)};WYMeditor.StateStack.prototype.leave=function(){if(this._stack.length==1){return false}this._stack.pop();return true};WYMeditor.XhtmlLexer=function(parser){jQuery.extend(this,new WYMeditor.Lexer(parser,"Text"));this.mapHandler("Text","Text");this.addTokens();this.init();return this};WYMeditor.XhtmlLexer.prototype.init=function(){};WYMeditor.XhtmlLexer.prototype.addTokens=function(){this.addCommentTokens("Text");this.addScriptTokens("Text");this.addCssTokens("Text");this.addTagTokens("Text")};WYMeditor.XhtmlLexer.prototype.addCommentTokens=function(scope){this.addEntryPattern("\x3c!--",scope,"Comment");this.addExitPattern("--\x3e","Comment")};WYMeditor.XhtmlLexer.prototype.addScriptTokens=function(scope){this.addEntryPattern("<script",scope,"Script");this.addExitPattern("<\/script>","Script")};WYMeditor.XhtmlLexer.prototype.addCssTokens=function(scope){this.addEntryPattern("<style",scope,"Css");this.addExitPattern("</style>","Css")};WYMeditor.XhtmlLexer.prototype.addTagTokens=function(scope){this.addSpecialPattern("<\\s*[a-z0-9:-]+\\s*/>",scope,"SelfClosingTag");this.addSpecialPattern("<\\s*[a-z0-9:-]+\\s*>",scope,"OpeningTag");this.addEntryPattern("<[a-z0-9:-]+"+"[\\/ \\>]+",scope,"OpeningTag");this.addInTagDeclarationTokens("OpeningTag");this.addSpecialPattern("</\\s*[a-z0-9:-]+\\s*>",scope,"ClosingTag")};WYMeditor.XhtmlLexer.prototype.addInTagDeclarationTokens=function(scope){this.addSpecialPattern("\\s+",scope,"Ignore");this.addAttributeTokens(scope);this.addExitPattern("/>",scope);this.addExitPattern(">",scope)};WYMeditor.XhtmlLexer.prototype.addAttributeTokens=function(scope){this.addSpecialPattern("\\s*[a-z-_0-9]*:?[a-z-_0-9]+\\s*(?==)\\s*",scope,"TagAttributes");this.addEntryPattern('=\\s*"',scope,"DoubleQuotedAttribute");this.addPattern('\\\\"',"DoubleQuotedAttribute");this.addExitPattern('"',"DoubleQuotedAttribute");this.addEntryPattern("=\\s*'",scope,"SingleQuotedAttribute");this.addPattern("\\\\'","SingleQuotedAttribute");this.addExitPattern("'","SingleQuotedAttribute");this.addSpecialPattern("=\\s*[^>\\s]*",scope,"UnquotedAttribute")};WYMeditor.XhtmlParser=function(Listener,mode){mode=mode||"Text";this._Lexer=new WYMeditor.XhtmlLexer(this);this._Listener=Listener;this._mode=mode;this._matches=[];this._last_match="";this._current_match="";return this};WYMeditor.XhtmlParser.prototype.parse=function(raw){this._Lexer.parse(this.beforeParsing(raw));return this.afterParsing(this._Listener.getResult())};WYMeditor.XhtmlParser.prototype.beforeParsing=function(raw){if(raw.match(/class="MsoNormal"/)||raw.match(/ns = "urn:schemas-microsoft-com/)){this._Listener.avoidStylingTagsAndAttributes()}return this._Listener.beforeParsing(raw)};WYMeditor.XhtmlParser.prototype.afterParsing=function(parsed){if(this._Listener._avoiding_tags_implicitly){this._Listener.allowStylingTagsAndAttributes()}return this._Listener.afterParsing(parsed)};WYMeditor.XhtmlParser.prototype.Ignore=function(match,state){return true};WYMeditor.XhtmlParser.prototype.Text=function(text){this._Listener.addContent(text);return true};WYMeditor.XhtmlParser.prototype.Comment=function(match,status){return this._addNonTagBlock(match,status,"addComment")};WYMeditor.XhtmlParser.prototype.Script=function(match,status){return this._addNonTagBlock(match,status,"addScript")};WYMeditor.XhtmlParser.prototype.Css=function(match,status){return this._addNonTagBlock(match,status,"addCss")};WYMeditor.XhtmlParser.prototype._addNonTagBlock=function(match,state,type){switch(state){case WYMeditor.LEXER_ENTER:this._non_tag=match;break;case WYMeditor.LEXER_UNMATCHED:this._non_tag+=match;break;case WYMeditor.LEXER_EXIT:switch(type){case"addComment":this._Listener.addComment(this._non_tag+match);break;case"addScript":this._Listener.addScript(this._non_tag+match);break;case"addCss":this._Listener.addCss(this._non_tag+match);break;default:break}break;default:break}return true};WYMeditor.XhtmlParser.prototype.SelfClosingTag=function(match,state){var result=this.OpeningTag(match,state);var tag=this.normalizeTag(match);return this.ClosingTag(match,state)};WYMeditor.XhtmlParser.prototype.OpeningTag=function(match,state){switch(state){case WYMeditor.LEXER_ENTER:this._tag=this.normalizeTag(match);this._tag_attributes={};break;case WYMeditor.LEXER_SPECIAL:this._callOpenTagListener(this.normalizeTag(match));break;case WYMeditor.LEXER_EXIT:this._callOpenTagListener(this._tag,this._tag_attributes);break;default:break}return true};WYMeditor.XhtmlParser.prototype.ClosingTag=function(match,state){this._callCloseTagListener(this.normalizeTag(match));return true};WYMeditor.XhtmlParser.prototype._callOpenTagListener=function(tag,attributes){attributes=attributes||{};this.autoCloseUnclosedBeforeNewOpening(tag);if(this._Listener.isBlockTag(tag)){this._Listener._tag_stack.push(tag);this._Listener.fixNestingBeforeOpeningBlockTag(tag,attributes);this._Listener.openBlockTag(tag,attributes);this._increaseOpenTagCounter(tag)}else if(this._Listener.isInlineTag(tag)){this._Listener.inlineTag(tag,attributes)}else{this._Listener.openUnknownTag(tag,attributes);this._increaseOpenTagCounter(tag)}this._Listener.last_tag=tag;this._Listener.last_tag_opened=true;this._Listener.last_tag_attributes=attributes};WYMeditor.XhtmlParser.prototype._callCloseTagListener=function(tag){if(this._decreaseOpenTagCounter(tag)){this.autoCloseUnclosedBeforeTagClosing(tag);if(this._Listener.isBlockTag(tag)){var expected_tag=this._Listener._tag_stack.pop();if(expected_tag===false){return}else if(expected_tag!==tag){if(this._Listener._extraBlockClosingTags){this._Listener._tag_stack.push(expected_tag);this._Listener.removedExtraBlockClosingTag();return}tag=expected_tag}this._Listener.closeBlockTag(tag)}}else{if(!this._Listener.isInlineTag(tag)){this._Listener.closeUnopenedTag(tag)}}this._Listener.last_tag=tag;this._Listener.last_tag_opened=false};WYMeditor.XhtmlParser.prototype._increaseOpenTagCounter=function(tag){this._Listener._open_tags[tag]=this._Listener._open_tags[tag]||0;this._Listener._open_tags[tag]++};WYMeditor.XhtmlParser.prototype._decreaseOpenTagCounter=function(tag){if(this._Listener._open_tags[tag]){this._Listener._open_tags[tag]--;if(this._Listener._open_tags[tag]===0){this._Listener._open_tags[tag]=undefined}return true}return false};WYMeditor.XhtmlParser.prototype.autoCloseUnclosedBeforeNewOpening=function(new_tag){this._autoCloseUnclosed(new_tag,false)};WYMeditor.XhtmlParser.prototype.autoCloseUnclosedBeforeTagClosing=function(tag){this._autoCloseUnclosed(tag,true)};WYMeditor.XhtmlParser.prototype._autoCloseUnclosed=function(new_tag,closing){closing=closing||false;if(this._Listener._open_tags){for(var tag in this._Listener._open_tags){if(this._Listener.shouldCloseTagAutomatically(tag,new_tag,closing)){this._callCloseTagListener(tag,true)}}}};WYMeditor.XhtmlParser.prototype.getTagReplacements=function(){return this._Listener.getTagReplacements()};WYMeditor.XhtmlParser.prototype.normalizeTag=function(tag){tag=tag.replace(/^([\s<\/>]*)|([\s<\/>]*)$/gm,"").toLowerCase();var tags=this._Listener.getTagReplacements();if(tags[tag]){return tags[tag]}return tag};WYMeditor.XhtmlParser.prototype.TagAttributes=function(match,state){if(WYMeditor.LEXER_SPECIAL==state){this._current_attribute=match}return true};WYMeditor.XhtmlParser.prototype.DoubleQuotedAttribute=function(match,state){if(WYMeditor.LEXER_UNMATCHED==state){this._tag_attributes[this._current_attribute]=match}return true};WYMeditor.XhtmlParser.prototype.SingleQuotedAttribute=function(match,state){if(WYMeditor.LEXER_UNMATCHED==state){this._tag_attributes[this._current_attribute]=match}return true};WYMeditor.XhtmlParser.prototype.UnquotedAttribute=function(match,state){this._tag_attributes[this._current_attribute]=match.replace(/^=/,"");return true};WYMeditor.XhtmlSaxListener=function(){this.output="";this.helper=new WYMeditor.XmlHelper;this._open_tags={};this.validator=WYMeditor.XhtmlValidator;this._tag_stack=[];this.avoided_tags=[];this._insert_before_closing=[];this._insert_after_closing=[];this._last_node_was_text=false;this._consecutive_brs=0;this._lastAddedOpenTag="";this._insideLI=false;this.tagsToUnwrapInLists=WYMeditor.DocumentStructureManager.VALID_DEFAULT_ROOT_CONTAINERS;this._rootInlineTagsToRemove=["br"];this._extraBlockClosingTags=0;this._insideTagToRemove=false;this._addSpacerBeforeElementInLI=false;this._insideTagToRemove=false;this._lastTagRemoved=false;this._extraLIClosingTags=0;this._removedTagStackIndex=0;this.entities={"&nbsp;":"&#160;","&iexcl;":"&#161;","&cent;":"&#162;","&pound;":"&#163;","&curren;":"&#164;","&yen;":"&#165;","&brvbar;":"&#166;","&sect;":"&#167;","&uml;":"&#168;","&copy;":"&#169;","&ordf;":"&#170;","&laquo;":"&#171;","&not;":"&#172;","&shy;":"&#173;","&reg;":"&#174;","&macr;":"&#175;","&deg;":"&#176;","&plusmn;":"&#177;","&sup2;":"&#178;","&sup3;":"&#179;","&acute;":"&#180;","&micro;":"&#181;","&para;":"&#182;","&middot;":"&#183;","&cedil;":"&#184;","&sup1;":"&#185;","&ordm;":"&#186;","&raquo;":"&#187;","&frac14;":"&#188;","&frac12;":"&#189;","&frac34;":"&#190;","&iquest;":"&#191;","&Agrave;":"&#192;","&Aacute;":"&#193;","&Acirc;":"&#194;","&Atilde;":"&#195;","&Auml;":"&#196;","&Aring;":"&#197;","&AElig;":"&#198;","&Ccedil;":"&#199;","&Egrave;":"&#200;","&Eacute;":"&#201;","&Ecirc;":"&#202;","&Euml;":"&#203;","&Igrave;":"&#204;","&Iacute;":"&#205;","&Icirc;":"&#206;","&Iuml;":"&#207;","&ETH;":"&#208;","&Ntilde;":"&#209;","&Ograve;":"&#210;","&Oacute;":"&#211;","&Ocirc;":"&#212;","&Otilde;":"&#213;","&Ouml;":"&#214;","&times;":"&#215;","&Oslash;":"&#216;","&Ugrave;":"&#217;","&Uacute;":"&#218;","&Ucirc;":"&#219;","&Uuml;":"&#220;","&Yacute;":"&#221;","&THORN;":"&#222;","&szlig;":"&#223;","&agrave;":"&#224;","&aacute;":"&#225;","&acirc;":"&#226;","&atilde;":"&#227;","&auml;":"&#228;","&aring;":"&#229;","&aelig;":"&#230;","&ccedil;":"&#231;","&egrave;":"&#232;","&eacute;":"&#233;","&ecirc;":"&#234;","&euml;":"&#235;","&igrave;":"&#236;","&iacute;":"&#237;","&icirc;":"&#238;","&iuml;":"&#239;","&eth;":"&#240;","&ntilde;":"&#241;","&ograve;":"&#242;","&oacute;":"&#243;","&ocirc;":"&#244;","&otilde;":"&#245;","&ouml;":"&#246;","&divide;":"&#247;","&oslash;":"&#248;","&ugrave;":"&#249;","&uacute;":"&#250;","&ucirc;":"&#251;","&uuml;":"&#252;","&yacute;":"&#253;","&thorn;":"&#254;","&yuml;":"&#255;","&OElig;":"&#338;","&oelig;":"&#339;","&Scaron;":"&#352;","&scaron;":"&#353;","&Yuml;":"&#376;","&fnof;":"&#402;","&circ;":"&#710;","&tilde;":"&#732;","&Alpha;":"&#913;","&Beta;":"&#914;","&Gamma;":"&#915;","&Delta;":"&#916;","&Epsilon;":"&#917;","&Zeta;":"&#918;","&Eta;":"&#919;","&Theta;":"&#920;","&Iota;":"&#921;","&Kappa;":"&#922;","&Lambda;":"&#923;","&Mu;":"&#924;","&Nu;":"&#925;","&Xi;":"&#926;","&Omicron;":"&#927;","&Pi;":"&#928;","&Rho;":"&#929;","&Sigma;":"&#931;","&Tau;":"&#932;","&Upsilon;":"&#933;","&Phi;":"&#934;","&Chi;":"&#935;","&Psi;":"&#936;","&Omega;":"&#937;","&alpha;":"&#945;","&beta;":"&#946;","&gamma;":"&#947;","&delta;":"&#948;","&epsilon;":"&#949;","&zeta;":"&#950;","&eta;":"&#951;","&theta;":"&#952;","&iota;":"&#953;","&kappa;":"&#954;","&lambda;":"&#955;","&mu;":"&#956;","&nu;":"&#957;","&xi;":"&#958;","&omicron;":"&#959;","&pi;":"&#960;","&rho;":"&#961;","&sigmaf;":"&#962;","&sigma;":"&#963;","&tau;":"&#964;","&upsilon;":"&#965;","&phi;":"&#966;","&chi;":"&#967;","&psi;":"&#968;","&omega;":"&#969;","&thetasym;":"&#977;","&upsih;":"&#978;","&piv;":"&#982;","&ensp;":"&#8194;","&emsp;":"&#8195;","&thinsp;":"&#8201;","&zwnj;":"&#8204;","&zwj;":"&#8205;","&lrm;":"&#8206;","&rlm;":"&#8207;","&ndash;":"&#8211;","&mdash;":"&#8212;","&lsquo;":"&#8216;","&rsquo;":"&#8217;","&sbquo;":"&#8218;","&ldquo;":"&#8220;","&rdquo;":"&#8221;","&bdquo;":"&#8222;","&dagger;":"&#8224;","&Dagger;":"&#8225;","&bull;":"&#8226;","&hellip;":"&#8230;","&permil;":"&#8240;","&prime;":"&#8242;","&Prime;":"&#8243;","&lsaquo;":"&#8249;","&rsaquo;":"&#8250;","&oline;":"&#8254;","&frasl;":"&#8260;","&euro;":"&#8364;","&image;":"&#8465;","&weierp;":"&#8472;","&real;":"&#8476;","&trade;":"&#8482;","&alefsym;":"&#8501;","&larr;":"&#8592;","&uarr;":"&#8593;","&rarr;":"&#8594;","&darr;":"&#8595;","&harr;":"&#8596;","&crarr;":"&#8629;","&lArr;":"&#8656;","&uArr;":"&#8657;","&rArr;":"&#8658;","&dArr;":"&#8659;","&hArr;":"&#8660;","&forall;":"&#8704;","&part;":"&#8706;","&exist;":"&#8707;","&empty;":"&#8709;","&nabla;":"&#8711;","&isin;":"&#8712;","&notin;":"&#8713;","&ni;":"&#8715;","&prod;":"&#8719;","&sum;":"&#8721;","&minus;":"&#8722;","&lowast;":"&#8727;","&radic;":"&#8730;","&prop;":"&#8733;","&infin;":"&#8734;","&ang;":"&#8736;","&and;":"&#8743;","&or;":"&#8744;","&cap;":"&#8745;","&cup;":"&#8746;","&int;":"&#8747;","&there4;":"&#8756;","&sim;":"&#8764;","&cong;":"&#8773;","&asymp;":"&#8776;","&ne;":"&#8800;","&equiv;":"&#8801;","&le;":"&#8804;","&ge;":"&#8805;","&sub;":"&#8834;","&sup;":"&#8835;","&nsub;":"&#8836;","&sube;":"&#8838;","&supe;":"&#8839;","&oplus;":"&#8853;","&otimes;":"&#8855;","&perp;":"&#8869;","&sdot;":"&#8901;","&lceil;":"&#8968;","&rceil;":"&#8969;","&lfloor;":"&#8970;","&rfloor;":"&#8971;","&lang;":"&#9001;","&rang;":"&#9002;","&loz;":"&#9674;","&spades;":"&#9824;","&clubs;":"&#9827;","&hearts;":"&#9829;","&diams;":"&#9830;"};this.block_tags=["a","abbr","acronym","address","area","b","base","bdo","big","blockquote","body","button","caption","cite","code","colgroup","dd","del","div","dfn","dl","dt","em","fieldset","form","head","h1","h2","h3","h4","h5","h6","html","i","iframe","ins","kbd","label","legend","li","map","noscript","object","ol","optgroup","option","p","param","pre","q","samp","script","select","small","span","strong","style","sub","sup","table","tbody","td","textarea","tfoot","th","thead","title","tr","tt","ul","var","extends","macro"];this.inline_tags=["br","col","hr","img","input"];return this};WYMeditor.XhtmlSaxListener.prototype.shouldCloseTagAutomatically=function(tag,now_on_tag,closing){if(tag!="td"&&tag!="option"){return false}var openCount=this._open_tags[tag];if(!openCount){return false}if(tag=="td"){var openTrCount=this._open_tags["tr"]||0;if(!closing&&now_on_tag==="td"&&openCount>=openTrCount){return true}if(closing&&now_on_tag=="tr"&&openCount>openTrCount){return true}}else if(tag=="option"){if(closing&&now_on_tag=="select"||!closing&&now_on_tag=="option"){return true}}return false};WYMeditor.XhtmlSaxListener.prototype.beforeParsing=function(raw){this.output="";this._insert_before_closing=[];this._insert_after_closing=[];this._open_tags={};this._tag_stack=[];this._last_node_was_text=false;this._lastTagRemoved=false;this._insideTagToRemove=false;this.last_tag=null;return raw};WYMeditor.XhtmlSaxListener.prototype.afterParsing=function(xhtml){xhtml=this.replaceNamedEntities(xhtml);xhtml=this.joinRepeatedEntities(xhtml);xhtml=this.removeEmptyTags(xhtml);xhtml=this.removeBrInPre(xhtml);return xhtml};WYMeditor.XhtmlSaxListener.prototype.replaceNamedEntities=function(xhtml){for(var entity in this.entities){xhtml=xhtml.replace(new RegExp(entity,"g"),this.entities[entity])}return xhtml};WYMeditor.XhtmlSaxListener.prototype.joinRepeatedEntities=function(xhtml){var tags="em|strong|sub|sup|acronym|pre|del|address";return xhtml.replace(new RegExp("</("+tags+")><\\1>",""),"").replace(new RegExp("(s*<("+tags+")>s*){2}(.*)(s*</\\2>s*){2}",""),"<$2>$3<$2>")};WYMeditor.XhtmlSaxListener.prototype.removeEmptyTags=function(xhtml){return xhtml.replace(new RegExp("<("+this.block_tags.join("|").replace(/\|td/,"").replace(/\|th/,"")+")>(<br />|&#160;|&nbsp;|\\s)*</\\1>","g"),"")};WYMeditor.XhtmlSaxListener.prototype.removeBrInPre=function(xhtml){var matches=xhtml.match(new RegExp("<pre[^>]*>(.*?)</pre>","gmi"));if(matches){for(var i=0;i<matches.length;i++){xhtml=xhtml.replace(matches[i],matches[i].replace(new RegExp("<br />","g"),String.fromCharCode(13,10)))}}return xhtml};WYMeditor.XhtmlSaxListener.prototype.getResult=function(){return this.output};WYMeditor.XhtmlSaxListener.prototype.getTagReplacements=function(){return{b:"strong",i:"em"}};WYMeditor.XhtmlSaxListener.prototype.getTagForStyle=function(style){if(/sub/.test(style)){return"sub"}else if(/super/.test(style)){return"sup"}else if(/bold/.test(style)){return"strong"}else if(/italic/.test(style)){return"em"}return false};WYMeditor.XhtmlSaxListener.prototype.addContent=function(text){if(this.last_tag&&this.last_tag=="li"){text=text.replace(/(\r|\n|\r\n)+$/g,"");text=text.replace(/(\r|\n|\r\n)+/g," ")}if(text.replace(/^\s+|\s+$/g,"").length>0){this._last_node_was_text=true;if(this._addSpacerBeforeElementInLI){this.output+="<br />";this._addSpacerBeforeElementInLI=false}}if(!this._insideTagToRemove){this.output+=text}};WYMeditor.XhtmlSaxListener.prototype.addComment=function(text){if(this.remove_comments||this._insideTagToRemove){return}this.output+=text};WYMeditor.XhtmlSaxListener.prototype.addScript=function(text){if(this.remove_scripts||this._insideTagToRemove){return}this.output+=text};WYMeditor.XhtmlSaxListener.prototype.addCss=function(text){if(this.remove_embeded_styles||this._insideTagToRemove){return}this.output+=text};WYMeditor.XhtmlSaxListener.prototype.openBlockTag=function(tag,attributes){var lastNodeWasText=this._last_node_was_text;this._last_node_was_text=false;if(this._insideTagToRemove){return}if(this._shouldRemoveTag(tag,attributes)){this._insideTagToRemove=true;this._removedTagStackIndex=this._tag_stack.length-1;return}if(this._insideLI&&jQuery.inArray(tag,this.tagsToUnwrapInLists)>-1){if(this._lastAddedOpenTag!=="li"||lastNodeWasText){this.output+="<br />";this._addSpacerBeforeElementInLI=false}this._tag_stack.pop();this._extraBlockClosingTags++;return}if(this._addSpacerBeforeElementInLI&&tag!=="li"&&jQuery.inArray(tag,WYMeditor.LIST_TYPE_ELEMENTS)===-1){this.output+="<br />";this._addSpacerBeforeElementInLI=false}attributes=this.validator.getValidTagAttributes(tag,attributes);attributes=this.removeUnwantedClasses(attributes);if(tag==="span"&&attributes.style){var new_tag=this.getTagForStyle(attributes.style);if(new_tag){tag=new_tag;this._tag_stack.pop();this._tag_stack.push(tag);attributes.style=""}}if(tag==="li"){this._insideLI=true;this._addSpacerBeforeElementInLI=false}this.output+=this.helper.tag(tag,attributes,true);this._lastAddedOpenTag=tag;this._lastTagRemoved=false};WYMeditor.XhtmlSaxListener.prototype.inlineTag=function(tag,attributes){if(this._insideTagToRemove||this._shouldRemoveTag(tag,attributes)){return}this._last_node_was_text=false;attributes=this.validator.getValidTagAttributes(tag,attributes);attributes=this.removeUnwantedClasses(attributes);this.output+=this.helper.tag(tag,attributes);this._lastTagRemoved=false};WYMeditor.XhtmlSaxListener.prototype.openUnknownTag=function(tag,attributes){};WYMeditor.XhtmlSaxListener.prototype.closeBlockTag=function(tag){this._last_node_was_text=false;if(this._insideTagToRemove){if(this._tag_stack.length===this._removedTagStackIndex){this._insideTagToRemove=false}this._lastTagRemoved=true;return}if(tag==="li"){this._insideLI=false;this._addSpacerBeforeElementInLI=false}if(jQuery.inArray(tag,WYMeditor.LIST_TYPE_ELEMENTS)>-1){this._insideLI=false}this.output=this.output+this._getClosingTagContent("before",tag)+"</"+tag+">"+this._getClosingTagContent("after",tag)};WYMeditor.XhtmlSaxListener.prototype.removedExtraBlockClosingTag=function(){this._extraBlockClosingTags--;this._addSpacerBeforeElementInLI=true;this._last_node_was_text=false};WYMeditor.XhtmlSaxListener.prototype.closeUnknownTag=function(tag){};WYMeditor.XhtmlSaxListener.prototype.closeUnopenedTag=function(tag){this._last_node_was_text=false;if(this._insideTagToRemove){return}if(tag==="li"&&this._extraLIClosingTags){this._extraLIClosingTags--}else{this.output+="</"+tag+">"}};WYMeditor.XhtmlSaxListener.prototype.avoidStylingTagsAndAttributes=function(){this.avoided_tags=["div","span"];this.validator.skiped_attributes=["style"];this.validator.skiped_attribute_values=["MsoNormal","main1"];this._avoiding_tags_implicitly=true};WYMeditor.XhtmlSaxListener.prototype.allowStylingTagsAndAttributes=function(){this.avoided_tags=[];this.validator.skiped_attributes=[];this.validator.skiped_attribute_values=[];this._avoiding_tags_implicitly=false};WYMeditor.XhtmlSaxListener.prototype.isBlockTag=function(tag){return!WYMeditor.Helper.arrayContains(this.avoided_tags,tag)&&WYMeditor.Helper.arrayContains(this.block_tags,tag)};WYMeditor.XhtmlSaxListener.prototype.isInlineTag=function(tag){return!WYMeditor.Helper.arrayContains(this.avoided_tags,tag)&&WYMeditor.Helper.arrayContains(this.inline_tags,tag)};WYMeditor.XhtmlSaxListener.prototype.insertContentAfterClosingTag=function(tag,content){this._insertContentWhenClosingTag("after",tag,content)};WYMeditor.XhtmlSaxListener.prototype.insertContentBeforeClosingTag=function(tag,content){this._insertContentWhenClosingTag("before",tag,content)};WYMeditor.XhtmlSaxListener.prototype.removeUnwantedClasses=function(attributes){var pattern,i;if(!attributes["class"]){return attributes}for(i=0;i<WYMeditor.CLASSES_REMOVED_BY_PARSER.length;++i){pattern=new RegExp("(^|\\s)"+WYMeditor.CLASSES_REMOVED_BY_PARSER[i]+"($|\\s)","gi");attributes["class"]=attributes["class"].replace(pattern,"$1")}attributes["class"]=attributes["class"].replace(/\s$/,"");return attributes};WYMeditor.XhtmlSaxListener.prototype.fixNestingBeforeOpeningBlockTag=function(tag,attributes){if(!this._last_node_was_text&&(tag=="ul"||tag=="ol")&&this.last_tag&&!this.last_tag_opened&&this.last_tag=="li"){if(this._lastTagRemoved){this._insideTagToRemove=true;this._removedTagStackIndex=this._tag_stack.length-1}else if(!this._shouldRemoveTag(tag,attributes)){this.output=this.output.replace(/<\/li>\s*$/,"");this.insertContentAfterClosingTag(tag,"</li>")}}else if((tag=="ul"||tag=="ol")&&this.last_tag&&this.last_tag_opened&&(this.last_tag=="ul"||this.last_tag=="ol")){if(!this._shouldRemoveTag(tag,attributes)){this.output+=this.helper.tag("li",{},true);this.insertContentAfterClosingTag(tag,"</li>")}this._last_node_was_text=false}else if(tag=="li"){if(this._tag_stack.length>=2){var closestOpenTag=this._tag_stack[this._tag_stack.length-2];if(closestOpenTag=="li"&&!this._shouldRemoveTag(tag,attributes)){this._open_tags.li-=1;if(this._open_tags.li===0){this._open_tags.li=undefined}this._tag_stack.splice(this._tag_stack.length-2,1);this._last_node_was_text=false;if(!this._insideTagToRemove){this.output+="</li>"}else if(this._tag_stack.length-1===this._removedTagStackIndex){this._insideTagToRemove=false;this._lastTagRemoved=true;this._extraLIClosingTags++}}}}};WYMeditor.XhtmlSaxListener.prototype._insertContentWhenClosingTag=function(position,tag,content){if(!this["_insert_"+position+"_closing"]){this["_insert_"+position+"_closing"]=[]}if(!this["_insert_"+position+"_closing"][tag]){this["_insert_"+position+"_closing"][tag]=[]}this["_insert_"+position+"_closing"][tag].push(content)};WYMeditor.XhtmlSaxListener.prototype._getClosingTagContent=function(position,tag){if(this["_insert_"+position+"_closing"]&&this["_insert_"+position+"_closing"][tag]&&this["_insert_"+position+"_closing"][tag].length>0){return this["_insert_"+position+"_closing"][tag].pop()}return""};WYMeditor.XhtmlSaxListener.prototype._shouldRemoveTag=function(tag,attributes){if(this._isEditorOnlyTag(tag,attributes)){return true}if(this._isRootInlineTagToRemove(tag,attributes,this._tag_stack)){return true}if(this._isThirdConsecutiveBrWithNoAttributes(tag,attributes)){return true}return false};WYMeditor.XhtmlSaxListener.prototype._isEditorOnlyTag=function(tag,attributes){var classes;if(!attributes["class"]){return false}classes=attributes["class"].split(" ");if(WYMeditor.Helper.arrayContains(classes,WYMeditor.EDITOR_ONLY_CLASS)){return true}return false};WYMeditor.XhtmlSaxListener.prototype._isRootInlineTagToRemove=function(tag,attributes,currentTagStack){if(!this.isInlineTag(tag)){return false}if(currentTagStack.length>0){return false}if(WYMeditor.Helper.arrayContains(this._rootInlineTagsToRemove,tag)){return true}return false};WYMeditor.XhtmlSaxListener.prototype._isThirdConsecutiveBrWithNoAttributes=function(tag,attributes){var key;if(tag!=="br"){this._consecutive_brs=0;return false}if(this._consecutive_brs!==0&&this._last_node_was_text){this._consecutive_brs=0;return false}for(key in attributes){if(attributes.hasOwnProperty(key)){this._consecutive_brs=0;return false}}this._consecutive_brs++;if(this._consecutive_brs>2){return true}return false};WYMeditor.XhtmlValidator={_attributes:{core:{except:["base","head","html","meta","param","script","style","title"],attributes:["class","id","title","accesskey","tabindex","/^data-.*/"]},styleAttr:{except:["img"],attributes:["style"]},language:{except:["base","br","hr","iframe","param","script"],attributes:{dir:["ltr","rtl"],0:"lang",1:"xml:lang"}},keyboard:{attributes:{accesskey:/^(\w){1}$/,tabindex:/^(\d)+$/}}},_events:{window:{only:["body"],attributes:["onload","onunload"]},form:{only:["form","input","textarea","select","a","label","button"],attributes:["onchange","onsubmit","onreset","onselect","onblur","onfocus"]},keyboard:{except:["base","bdo","br","frame","frameset","head","html","iframe","meta","param","script","style","title"],attributes:["onkeydown","onkeypress","onkeyup"]},mouse:{except:["base","bdo","br","head","html","meta","param","script","style","title"],attributes:["onclick","ondblclick","onmousedown","onmousemove","onmouseover","onmouseout","onmouseup"]}},_tags:{a:{attributes:{0:"charset",1:"coords",2:"href",3:"hreflang",4:"name",5:"rel",6:"rev",shape:/^(rect|rectangle|circ|circle|poly|polygon)$/,7:"type"}},0:"abbr",1:"acronym",2:"address",area:{attributes:{0:"alt",1:"coords",2:"href",nohref:/^(true|false)$/,shape:/^(rect|rectangle|circ|circle|poly|polygon)$/},required:["alt"]},3:"b",base:{attributes:["href"],required:["href"]},bdo:{attributes:{dir:/^(ltr|rtl)$/},required:["dir"]},4:"big",blockquote:{attributes:["cite"]},5:"body",6:"br",button:{attributes:{disabled:/^(disabled)$/,type:/^(button|reset|submit)$/,0:"value"},inside:"form"},7:"caption",8:"cite",9:"code",col:{attributes:{align:/^(right|left|center|justify)$/,0:"char",1:"charoff",span:/^(\d)+$/,valign:/^(top|middle|bottom|baseline)$/,2:"width"},inside:"colgroup"},colgroup:{attributes:{align:/^(right|left|center|justify)$/,0:"char",1:"charoff",span:/^(\d)+$/,valign:/^(top|middle|bottom|baseline)$/,2:"width"}},10:"dd",del:{attributes:{0:"cite",datetime:/^([0-9]){8}/}},11:"div",12:"dfn",13:"dl",14:"dt",15:"em",fieldset:{inside:"form"},form:{attributes:{0:"action",1:"accept",2:"accept-charset",3:"enctype",method:/^(get|post)$/},required:["action"]},head:{attributes:["profile"]},16:"h1",17:"h2",18:"h3",19:"h4",20:"h5",21:"h6",22:"hr",html:{attributes:["xmlns"]},23:"i",img:{attributes:["alt","src","height","ismap","longdesc","usemap","width"],required:["alt","src"]},input:{attributes:{0:"accept",1:"alt",checked:/^(checked)$/,disabled:/^(disabled)$/,maxlength:/^(\d)+$/,2:"name",readonly:/^(readonly)$/,size:/^(\d)+$/,3:"src",type:/^(button|checkbox|file|hidden|image|password|radio|reset|submit|text)$/,4:"value"},inside:"form"},ins:{attributes:{0:"cite",datetime:/^([0-9]){8}/}},24:"kbd",label:{attributes:["for"],inside:"form"},25:"legend",26:"li",link:{attributes:{0:"charset",1:"href",2:"hreflang",media:/^(all|braille|print|projection|screen|speech|,|;| )+$/i,rel:/^(alternate|appendix|bookmark|chapter|contents|copyright|glossary|help|home|index|next|prev|section|start|stylesheet|subsection| |shortcut|icon)+$/i,rev:/^(alternate|appendix|bookmark|chapter|contents|copyright|glossary|help|home|index|next|prev|section|start|stylesheet|subsection| |shortcut|icon)+$/i,3:"type"},inside:"head"},map:{attributes:["id","name"],required:["id"]},meta:{attributes:{0:"content","http-equiv":/^(content\-type|expires|refresh|set\-cookie)$/i,1:"name",2:"scheme"},required:["content"]},27:"noscript",object:{attributes:["archive","classid","codebase","codetype","data","declare","height","name","standby","type","usemap","width"]},28:"ol",optgroup:{attributes:{0:"label",disabled:/^(disabled)$/},required:["label"]},option:{attributes:{0:"label",disabled:/^(disabled)$/,selected:/^(selected)$/,1:"value"},inside:"select"},29:"p",param:{attributes:{0:"type",valuetype:/^(data|ref|object)$/,1:"valuetype",2:"value"},required:["name"]},30:"pre",q:{attributes:["cite"]},31:"samp",script:{attributes:{type:/^(text\/ecmascript|text\/javascript|text\/jscript|text\/vbscript|text\/vbs|text\/xml)$/,0:"charset",defer:/^(defer)$/,1:"src"},required:["type"]},select:{attributes:{disabled:/^(disabled)$/,multiple:/^(multiple)$/,0:"name",1:"size"},inside:"form"},32:"small",33:"span",34:"strong",style:{attributes:{0:"type",media:/^(screen|tty|tv|projection|handheld|print|braille|aural|all)$/},required:["type"]},35:"sub",36:"sup",table:{attributes:{0:"border",1:"cellpadding",2:"cellspacing",frame:/^(void|above|below|hsides|lhs|rhs|vsides|box|border)$/,rules:/^(none|groups|rows|cols|all)$/,3:"summary",4:"width"}},tbody:{attributes:{align:/^(right|left|center|justify)$/,0:"char",1:"charoff",valign:/^(top|middle|bottom|baseline)$/}},td:{attributes:{0:"abbr",align:/^(left|right|center|justify|char)$/,1:"axis",2:"char",3:"charoff",colspan:/^(\d)+$/,4:"headers",rowspan:/^(\d)+$/,scope:/^(col|colgroup|row|rowgroup)$/,valign:/^(top|middle|bottom|baseline)$/}},textarea:{attributes:["cols","rows","disabled","name","readonly"],required:["cols","rows"],inside:"form"},tfoot:{attributes:{align:/^(right|left|center|justify)$/,0:"char",1:"charoff",valign:/^(top|middle|bottom)$/,2:"baseline"}},th:{attributes:{0:"abbr",align:/^(left|right|center|justify|char)$/,1:"axis",2:"char",3:"charoff",colspan:/^(\d)+$/,4:"headers",rowspan:/^(\d)+$/,scope:/^(col|colgroup|row|rowgroup)$/,valign:/^(top|middle|bottom|baseline)$/}},thead:{attributes:{align:/^(right|left|center|justify)$/,0:"char",1:"charoff",valign:/^(top|middle|bottom|baseline)$/}},37:"title",tr:{attributes:{align:/^(right|left|center|justify|char)$/,0:"char",1:"charoff",valign:/^(top|middle|bottom|baseline)$/}},38:"tt",39:"ul",40:"var",macro:{attributes:{0:"/.*/"}}},skiped_attributes:[],skiped_attribute_values:[],getValidTagAttributes:function(tag,attributes){var valid_attributes={};var possible_attributes=this.getPossibleTagAttributes(tag);for(var attribute in attributes){var value=attributes[attribute];attribute=attribute.toLowerCase();var h=WYMeditor.Helper;if(!h.arrayContains(this.skiped_attributes,attribute)&&!h.arrayContains(this.skiped_attribute_values,value)){if(typeof value!="function"&&h.arrayContains(possible_attributes,attribute)){if(this.doesAttributeNeedsValidation(tag,attribute)){if(this.validateAttribute(tag,attribute,value)){valid_attributes[attribute]=value}}else{valid_attributes[attribute]=value}}else{jQuery.each(possible_attributes,function(){if(this.match(/\/(.*)\//)){regex=new RegExp(this.match(/\/(.*)\//)[1]);if(regex.test(attribute)){valid_attributes[attribute]=value}}})}}}return valid_attributes},getUniqueAttributesAndEventsForTag:function(tag){var result=[];if(this._tags[tag]&&this._tags[tag].attributes){for(var k in this._tags[tag].attributes){result.push(parseInt(k,10)==k?this._tags[tag].attributes[k]:k)}}return result},getDefaultAttributesAndEventsForTags:function(){var result=[];for(var key in this._events){result.push(this._events[key])}for(key in this._attributes){result.push(this._attributes[key])}return result},isValidTag:function(tag){if(this._tags[tag]){return true}for(var key in this._tags){if(this._tags[key]==tag){return true}}return false},getDefaultAttributesAndEventsForTag:function(tag){var default_attributes=[];if(this.isValidTag(tag)){var default_attributes_and_events=this.getDefaultAttributesAndEventsForTags();for(var key in default_attributes_and_events){var defaults=default_attributes_and_events[key];if(typeof defaults=="object"){var h=WYMeditor.Helper;if(defaults["except"]&&h.arrayContains(defaults["except"],tag)||defaults["only"]&&!h.arrayContains(defaults["only"],tag)){continue}var tag_defaults=defaults["attributes"]?defaults["attributes"]:defaults["events"];for(var k in tag_defaults){default_attributes.push(typeof tag_defaults[k]!="string"?k:tag_defaults[k])}}}}return default_attributes},doesAttributeNeedsValidation:function(tag,attribute){return this._tags[tag]&&(this._tags[tag]["attributes"]&&this._tags[tag]["attributes"][attribute]||this._tags[tag]["required"]&&WYMeditor.Helper.arrayContains(this._tags[tag]["required"],attribute))},validateAttribute:function(tag,attribute,value){if(this._tags[tag]&&(this._tags[tag]["attributes"]&&this._tags[tag]["attributes"][attribute]&&value.length>0&&!value.match(this._tags[tag]["attributes"][attribute]))||this._tags[tag]&&this._tags[tag]["required"]&&WYMeditor.Helper.arrayContains(this._tags[tag]["required"],attribute)&&value.length===0){return false}return typeof this._tags[tag]!="undefined"},getPossibleTagAttributes:function(tag){if(!this._possible_tag_attributes){this._possible_tag_attributes={}}if(!this._possible_tag_attributes[tag]){this._possible_tag_attributes[tag]=this.getUniqueAttributesAndEventsForTag(tag).concat(this.getDefaultAttributesAndEventsForTag(tag))}return this._possible_tag_attributes[tag]}};WYMeditor.XmlHelper=function(){this._entitiesDiv=document.createElement("div");return this};WYMeditor.XmlHelper.prototype.tag=function(name,options,open){options=options||false;open=open||false;return"<"+name+(options?this.tagOptions(options):"")+(open?">":" />")};WYMeditor.XmlHelper.prototype.contentTag=function(name,content,options){options=options||false;return"<"+name+(options?this.tagOptions(options):"")+">"+content+"</"+name+">"};WYMeditor.XmlHelper.prototype.cdataSection=function(content){return"<![CDATA["+content+"]]>"};WYMeditor.XmlHelper.prototype.escapeOnce=function(xml){return this._fixDoubleEscape(this.escapeEntities(xml))};WYMeditor.XmlHelper.prototype._fixDoubleEscape=function(escaped){return escaped.replace(/&amp;([a-z]+|(#\d+));/gi,"&$1;")};WYMeditor.XmlHelper.prototype.tagOptions=function(options){var xml=this;xml._formated_options="";for(var key in options){var formated_options="";var value=options[key];if(typeof value!="function"&&value.length>0){if(parseInt(key,10)==key&&typeof value=="object"){key=value.shift();value=value.pop()}if(key!==""&&value!==""){xml._formated_options+=" "+key+'="'+xml.escapeOnce(value)+'"'}}}return xml._formated_options};WYMeditor.XmlHelper.prototype.escapeEntities=function(string,escape_quotes){this._entitiesDiv.innerHTML=string;this._entitiesDiv.textContent=string;var result=this._entitiesDiv.innerHTML;if(typeof escape_quotes=="undefined"){if(escape_quotes!==false)result=result.replace('"',"&quot;");if(escape_quotes===true)result=result.replace('"',"&#039;")}return result};WYMeditor.XmlHelper.prototype.parseAttributes=function(tag_attributes){var result=[];var matches=tag_attributes.split(/((=\s*")(")("))|((=\s*\')(\')(\'))|((=\s*[^>\s]*))/g);if(matches.toString()!=tag_attributes){for(var k in matches){var v=matches[k];if(typeof v!="function"&&v.length!==0){var re=new RegExp("(\\w+)\\s*"+v);var match=tag_attributes.match(re);if(match){var value=v.replace(/^[\s=]+/,"");var delimiter=value.charAt(0);delimiter=delimiter=='"'?'"':delimiter=="'"?"'":"";if(delimiter!==""){value=delimiter=='"'?value.replace(/^"|"+$/g,""):value.replace(/^'|'+$/g,"")}tag_attributes=tag_attributes.replace(match[0],"");result.push([match[1],value])}}}}return result};WYMeditor.STRINGS.bg={Strong:"ÐÐ¾Ð»ÑÑÐµÑ",Emphasis:"ÐÑÑÑÐ¸Ð²",Superscript:"ÐÐ¾ÑÐµÐ½ Ð¸Ð½Ð´ÐµÐºÑ",Subscript:"ÐÐ¾Ð»ÐµÐ½ Ð¸Ð½Ð´ÐµÐºÑ",Ordered_List:"ÐÐ¾Ð´ÑÐµÐ´ÐµÐ½ ÑÐ¿Ð¸ÑÑÐº",Unordered_List:"ÐÐµÐ¿Ð¾Ð´ÑÐµÐ´ÐµÐ½ ÑÐ¿Ð¸ÑÑÐº",Indent:"ÐÐ»Ð¾Ðº Ð½Ð°Ð²ÑÑÑÐµ",Outdent:"ÐÐ»Ð¾Ðº Ð½Ð°Ð²ÑÐ½",Undo:"Ð¡ÑÑÐ¿ÐºÐ° Ð½Ð°Ð·Ð°Ð´",Redo:"Ð¡ÑÑÐ¿ÐºÐ° Ð½Ð°Ð¿ÑÐµÐ´",Link:"Ð¡ÑÐ·Ð´Ð°Ð¹ ÑÐ¸Ð¿ÐµÑÐ²ÑÑÐ·ÐºÐ°",Unlink:"ÐÑÐµÐ¼Ð°ÑÐ½Ð¸ ÑÐ¸Ð¿ÐµÑÐ²ÑÑÐ·ÐºÐ°ÑÐ°",Image:"ÐÐ·Ð¾Ð±ÑÐ°Ð¶ÐµÐ½Ð¸Ðµ",Table:"Ð¢Ð°Ð±Ð»Ð¸ÑÐ°",HTML:"HTML",Paragraph:"ÐÐ±Ð·Ð°Ñ",Heading_1:"ÐÐ°Ð³Ð»Ð°Ð²Ð¸Ðµ 1",Heading_2:"ÐÐ°Ð³Ð»Ð°Ð²Ð¸Ðµ 2",Heading_3:"ÐÐ°Ð³Ð»Ð°Ð²Ð¸Ðµ 3",Heading_4:"ÐÐ°Ð³Ð»Ð°Ð²Ð¸Ðµ 4",Heading_5:"ÐÐ°Ð³Ð»Ð°Ð²Ð¸Ðµ 5",Heading_6:"ÐÐ°Ð³Ð»Ð°Ð²Ð¸Ðµ 6",Preformatted:"ÐÑÐµÑÐ¾ÑÐ¼Ð°ÑÐ¸ÑÐ°Ð½",Blockquote:"Ð¦Ð¸ÑÐ°Ñ",Table_Header:"ÐÐ°Ð³Ð»Ð°Ð²Ð¸Ðµ Ð½Ð° ÑÐ°Ð±Ð»Ð¸ÑÐ°ÑÐ°",URL:"URL",Title:"ÐÐ°Ð³Ð»Ð°Ð²Ð¸Ðµ",Alternative_Text:"ÐÐ»ÑÐµÑÐ½Ð°ÑÐ¸Ð²ÐµÐ½ ÑÐµÐºÑÑ",Caption:"ÐÑÐ¸ÐºÐµÑ",Summary:"ÐÐ±ÑÐ¾",Number_Of_Rows:"ÐÑÐ¾Ð¹ ÑÐµÐ´Ð¾Ð²Ðµ",Number_Of_Cols:"ÐÑÐ¾Ð¹ ÐºÐ¾Ð»Ð¾Ð½Ð¸",Submit:"ÐÐ·Ð¿ÑÐ°ÑÐ¸",Cancel:"ÐÑÐ¼ÐµÐ½Ð¸",Choose:"ÐÐ°ÑÐ²Ð¾ÑÐ¸",Preview:"ÐÑÐµÐ´Ð²Ð°ÑÐ¸ÑÐµÐ»ÐµÐ½ Ð¿ÑÐµÐ³Ð»ÐµÐ´",Paste_From_Word:"ÐÐ¼ÑÐºÐ½Ð¸ Ð¾Ñ MS WORD",Tools:"ÐÐ½ÑÑÑÑÐ¼ÐµÐ½ÑÐ¸",Containers:"ÐÐ¾Ð½ÑÐµÐ¹Ð½ÐµÑÐ¸",Classes:"ÐÐ»Ð°ÑÐ¾Ð²Ðµ",Status:"Ð¡ÑÐ°ÑÑÑ",Source_Code:"ÐÐ·ÑÐ¾ÑÐ½Ð¸Ðº, ÐºÐ¾Ð´"};WYMeditor.STRINGS.ca={Strong:"Ressaltar",Emphasis:"Emfatitzar",Superscript:"Superindex",Subscript:"Subindex",Ordered_List:"Llistat ordenat",Unordered_List:"Llistat sense ordenar",Indent:"Indentat",Outdent:"Sense indentar",Undo:"Desfer",Redo:"Refer",Link:"EnllaÃ§ar",Unlink:"Eliminar enllaÃ§",Image:"Imatge",Table:"Taula",HTML:"HTML",Paragraph:"ParÃ graf",Heading_1:"CapÃ§alera 1",Heading_2:"CapÃ§alera 2",Heading_3:"CapÃ§alera 3",Heading_4:"CapÃ§alera 4",Heading_5:"CapÃ§alera 5",Heading_6:"CapÃ§alera 6",Preformatted:"Pre-formatejat",Blockquote:"Cita",Table_Header:"CapÃ§alera de la taula",URL:"URL",Title:"TÃ­tol",Alternative_Text:"Text alternatiu",Caption:"Llegenda",Summary:"Summary",Number_Of_Rows:"Nombre de files",Number_Of_Cols:"Nombre de columnes",Submit:"Enviar",Cancel:"CancelÂ·lar",Choose:"Triar",Preview:"Vista prÃ¨via",Paste_From_Word:"Pegar des de Word",Tools:"Eines",Containers:"Contenidors",Classes:"Classes",Status:"Estat",Source_Code:"Codi font"};WYMeditor.STRINGS.cs={Strong:"TuÄnÃ©",Emphasis:"KurzÃ­va",Superscript:"HornÃ­ index",Subscript:"DolnÃ­ index",Ordered_List:"ÄÃ­slovanÃ½ seznam",Unordered_List:"NeÄÃ­slovanÃ½ seznam",Indent:"ZvÄtÅ¡it odsazenÃ­",Outdent:"ZmenÅ¡it odsazenÃ­",Undo:"ZpÄt",Redo:"Znovu",Link:"VytvoÅit odkaz",Unlink:"ZruÅ¡it odkaz",Image:"ObrÃ¡zek",Table:"Tabulka",HTML:"HTML",Paragraph:"Odstavec",Heading_1:"Nadpis 1. ÃºrovnÄ",Heading_2:"Nadpis 2. ÃºrovnÄ",Heading_3:"Nadpis 3. ÃºrovnÄ",Heading_4:"Nadpis 4. ÃºrovnÄ",Heading_5:"Nadpis 5. ÃºrovnÄ",Heading_6:"Nadpis 6. ÃºrovnÄ",Preformatted:"PÅedformÃ¡tovanÃ½ text",Blockquote:"Citace",Table_Header:"HlaviÄkovÃ¡ buÅka tabulky",URL:"Adresa",Title:"Text po najetÃ­ myÅ¡Ã­",Alternative_Text:"Text pro pÅÃ­pad nezobrazenÃ­ obrÃ¡zku",Caption:"Titulek tabulky",Summary:"ShrnutÃ­ obsahu",Number_Of_Rows:"PoÄet ÅÃ¡dek",Number_Of_Cols:"PoÄet sloupcÅ¯",Submit:"VytvoÅit",Cancel:"ZruÅ¡it",Choose:"Vybrat",Preview:"NÃ¡hled",Paste_From_Word:"VloÅ¾it z Wordu",Tools:"NÃ¡stroje",Containers:"Typy obsahu",Classes:"TÅÃ­dy",Status:"Stav",Source_Code:"ZdrojovÃ½ kÃ³d"};WYMeditor.STRINGS.cy={Strong:"Bras",Emphasis:"Italig",Superscript:"Uwchsgript",Subscript:"Is-sgript",Ordered_List:"Rhestr mewn Trefn",Unordered_List:"Pwyntiau Bwled",Indent:"Mewnoli",Outdent:"Alloli",Undo:"Dadwneud",Redo:"Ailwneud",Link:"Cysylltu",Unlink:"Datgysylltu",Image:"Delwedd",Table:"Tabl",HTML:"HTML",Paragraph:"Paragraff",Heading_1:"Pennawd 1",Heading_2:"Pennawd 2",Heading_3:"Pennawd 3",Heading_4:"Pennawd 4",Heading_5:"Pennawd 5",Heading_6:"Pennawd 6",Preformatted:"Rhagfformat",Blockquote:"Bloc Dyfyniad",Table_Header:"Pennyn Tabl",URL:"URL",Title:"Teitl",Alternative_Text:"Testun Amgen",Caption:"Pennawd",Summary:"Crynodeb",Number_Of_Rows:"Nifer y rhesi",Number_Of_Cols:"Nifer y colofnau",Submit:"Anfon",Cancel:"Diddymu",Choose:"Dewis",Preview:"Rhagolwg",Paste_From_Word:"Gludo o Word",Tools:"Offer",Containers:"Cynhwysyddion",Classes:"Dosbarthiadau",Status:"Statws",Source_Code:"Cod ffynhonnell"};WYMeditor.STRINGS["da"]={Strong:"Fed",Emphasis:"SkrÃ¥",Superscript:"Superscript",Subscript:"Subscript",Ordered_List:"Ordnet liste",Unordered_List:"Uordnet liste",Indent:"Indrykke",Outdent:"Udrykke",Undo:"Fortryd",Redo:"Fortryd",Link:"Link",Unlink:"Fjern link",Image:"Billede",Table:"Tabel",HTML:"HTML",Paragraph:"Paragraf",Heading_1:"Overskrift 1",Heading_2:"Overskrift 2",Heading_3:"Overskrift 3",Heading_4:"Overskrift 4",Heading_5:"Overskrift 5",Heading_6:"Overskrift 6",Preformatted:"Forudformateret",Blockquote:"Citat",Table_Header:"Tabel Overskrift",URL:"URL",Title:"Titel",Alternative_Text:"Alternativ tekst",Caption:"Billedtekst",Summary:"ResumÃ©",Number_Of_Rows:"Antal rÃ¦kker",Number_Of_Cols:"Antal kolonner",Submit:"Indsend",Cancel:"Afbryd",Choose:"VÃ¦lg",Preview:"ForhÃ¥ndsvisning",Paste_From_Word:"IndsÃ¦t fra Word",Tools:"VÃ¦rktÃ¸jer",Containers:"Containere",Classes:"Klasser",Status:"Status",Source_Code:"Kildekode"};WYMeditor.STRINGS.de={Strong:"Fett",Emphasis:"Kursiv",Superscript:"Text hochstellen",Subscript:"Text tiefstellen",Ordered_List:"Geordnete Liste einfÃ¼gen",Unordered_List:"Ungeordnete Liste einfÃ¼gen",Indent:"Einzug erhÃ¶hen",Outdent:"Einzug vermindern",Undo:"Befehle rÃ¼ckgÃ¤ngig machen",Redo:"Befehle wiederherstellen",Link:"Hyperlink einfÃ¼gen",Unlink:"Hyperlink entfernen",Image:"Bild einfÃ¼gen",Table:"Tabelle einfÃ¼gen",HTML:"HTML anzeigen/verstecken",Paragraph:"Absatz",Heading_1:"Ãberschrift 1",Heading_2:"Ãberschrift 2",Heading_3:"Ãberschrift 3",Heading_4:"Ãberschrift 4",Heading_5:"Ãberschrift 5",Heading_6:"Ãberschrift 6",Preformatted:"Vorformatiert",Blockquote:"Zitat",Table_Header:"TabellenÃ¼berschrift",URL:"URL",Title:"Titel",Alternative_Text:"Alternativer Text",Caption:"TabellenÃ¼berschrift",Summary:"Summary",Number_Of_Rows:"Anzahl Zeilen",Number_Of_Cols:"Anzahl Spalten",Submit:"Absenden",Cancel:"Abbrechen",Choose:"AuswÃ¤hlen",Preview:"Vorschau",Paste_From_Word:"Aus Word einfÃ¼gen",Tools:"Werkzeuge",Containers:"Inhaltstyp",Classes:"Klassen",Status:"Status",Source_Code:"Quellcode"};WYMeditor.STRINGS.en={Strong:"Strong",Emphasis:"Emphasis",Superscript:"Superscript",Subscript:"Subscript",Ordered_List:"Ordered List",Unordered_List:"Unordered List",Indent:"Indent",Outdent:"Outdent",Undo:"Undo",Redo:"Redo",Link:"Link",Unlink:"Unlink",Image:"Image",Table:"Table",HTML:"HTML",Paragraph:"Paragraph",Heading_1:"Heading 1",Heading_2:"Heading 2",Heading_3:"Heading 3",Heading_4:"Heading 4",Heading_5:"Heading 5",Heading_6:"Heading 6",Preformatted:"Preformatted",Blockquote:"Blockquote",Table_Header:"Table Header",URL:"URL",Title:"Title",Relationship:"Relationship",Alternative_Text:"Alternative text",Caption:"Caption",Summary:"Summary",Number_Of_Rows:"Number of rows",Number_Of_Cols:"Number of cols",Submit:"Submit",Cancel:"Cancel",Choose:"Choose",Preview:"Preview",Paste_From_Word:"Paste from Word",Tools:"Tools",Containers:"Formatting",Classes:"Style",Status:"Status",Source_Code:"Source code"};WYMeditor.STRINGS.es={Strong:"Resaltar",Emphasis:"Enfatizar",Superscript:"Superindice",Subscript:"Subindice",Ordered_List:"Lista ordenada",Unordered_List:"Lista sin ordenar",Indent:"Indentado",Outdent:"Sin indentar",Undo:"Deshacer",Redo:"Rehacer",Link:"Enlazar",Unlink:"Eliminar enlace",Image:"Imagen",Table:"Tabla",HTML:"HTML",Paragraph:"PÃ¡rrafo",Heading_1:"Cabecera 1",Heading_2:"Cabecera 2",Heading_3:"Cabecera 3",Heading_4:"Cabecera 4",Heading_5:"Cabecera 5",Heading_6:"Cabecera 6",Preformatted:"Preformateado",Blockquote:"Cita",Table_Header:"Cabecera de la tabla",URL:"URL",Title:"TÃ­tulo",Alternative_Text:"Texto alternativo",Caption:"Leyenda",Summary:"Summary",Number_Of_Rows:"NÃºmero de filas",Number_Of_Cols:"NÃºmero de columnas",Submit:"Enviar",Cancel:"Cancelar",Choose:"Seleccionar",Preview:"Vista previa",Paste_From_Word:"Pegar desde Word",Tools:"Herramientas",Containers:"Contenedores",Classes:"Clases",Status:"Estado",Source_Code:"CÃ³digo fuente"};WYMeditor.STRINGS.fa={Strong:"Ù¾Ø±Ø±ÙÚ¯",Emphasis:"Ø§ÛØªØ§ÙÛÚ©",Superscript:"Ø¨Ø§ÙØ§ÙÙÙØ³â ",Subscript:"Ø²ÙØ±ÙÙÙØ³â",Ordered_List:"ÙÛØ³Øª ÙØ±ØªØ¨",Unordered_List:"ÙÛØ³Øª ÙØ§ÙØ±ØªØ¨",Indent:"Ø§ÙØ²ÙØ¯Ù Ø¯ÙØ¯Ø§ÙÙ",Outdent:"Ú©Ø§ÙØ´ Ø¯ÙØ¯Ø§ÙÙ",Undo:"ÙØ§Ú¯Ø±Ø¯Ø§ÙÛ",Redo:"ØªÚ©Ø±Ø§Ø±",Link:"Ø³Ø§Ø®ØªÙ Ù¾ÛÙÙØ¯",Unlink:"Ø¨Ø±Ø¯Ø§Ø´ØªÙ Ù¾ÛÙÙØ¯",Image:"ØªØµÙÛØ±",Table:"Ø¬Ø¯ÙÙ",HTML:"HTML",Paragraph:"Ù¾Ø§Ø±Ø§Ú¯Ø±Ø§Ù",Heading_1:"Ø³Ø±ØªÛØªØ± Û±",Heading_2:"Ø³Ø±ØªÛØªØ± Û²",Heading_3:"Ø³Ø±ØªÛØªØ± Û³",Heading_4:"Ø³Ø±ØªÛØªØ± Û´",Heading_5:"Ø³Ø±ØªÛØªØ± Ûµ",Heading_6:"Ø³Ø±ØªÛØªØ± Û¶",Preformatted:"ÙØ§ÙØ¨ Ø¢ÙØ§Ø¯Ù",Blockquote:"ÙÙÙ ÙÙÙ",Table_Header:"Ø³Ø±Ø¬Ø¯ÙÙ",URL:"Ø¢Ø¯Ø±Ø³ Ø§ÛÙØªØ±ÙØªÛ",Title:"Ø¹ÙÙØ§Ù",Alternative_Text:"ÙØªÙ Ø¬Ø§ÛÚ¯Ø²ÛÙ",Caption:"Ø¹ÙÙØ§Ù",Summary:"Summary",Number_Of_Rows:"ØªØ¹Ø¯Ø§Ø¯ Ø³Ø·Ø±ÙØ§",Number_Of_Cols:"ØªØ¹Ø¯Ø§Ø¯ Ø³ØªÙÙâÙØ§",Submit:"ÙØ±Ø³ØªØ§Ø¯Ù",Cancel:"ÙØºÙ",Choose:"Ø§ÙØªØ®Ø§Ø¨",Preview:"Ù¾ÛØ´âÙÙØ§ÛØ´",Paste_From_Word:"Ø§ÙØªÙØ§Ù Ø§Ø² ÙØ±Ø¯",Tools:"Ø§Ø¨Ø²Ø§Ø±",Containers:"âÙØ§ÙØ¨âÙØ§",Classes:"Ú©ÙØ§Ø³âÙØ§",Status:"ÙØ¶Ø¹ÛØª",Source_Code:"Ú©Ø¯ ÙØ¨Ø¯Ø£"};WYMeditor.STRINGS.fi={Strong:"Lihavoitu",Emphasis:"Korostus",Superscript:"YlÃ¤indeksi",Subscript:"Alaindeksi",Ordered_List:"Numeroitu lista",Unordered_List:"Luettelomerkit",Indent:"Suurenna sisennystÃ¤",Outdent:"PienennÃ¤ sisennystÃ¤",Undo:"Kumoa",Redo:"Toista",Link:"LinkitÃ¤",Unlink:"Poista linkitys",Image:"Kuva",Table:"Taulukko",HTML:"HTML",Paragraph:"Kappale",Heading_1:"Otsikko 1",Heading_2:"Otsikko 2",Heading_3:"Otsikko 3",Heading_4:"Otsikko 4",Heading_5:"Otsikko 5",Heading_6:"Otsikko 6",Preformatted:"Esimuotoilu",Blockquote:"Sitaatti",Table_Header:"Taulukon otsikko",URL:"URL",Title:"Otsikko",Alternative_Text:"Vaihtoehtoinen teksti",Caption:"Kuvateksti",Summary:"Yhteenveto",Number_Of_Rows:"Rivien mÃ¤Ã¤rÃ¤",Number_Of_Cols:"Palstojen mÃ¤Ã¤rÃ¤",Submit:"LÃ¤hetÃ¤",Cancel:"Peruuta",Choose:"Valitse",Preview:"Esikatsele",Paste_From_Word:"Tuo Wordista",Tools:"TyÃ¶kalut",Containers:"Muotoilut",Classes:"Luokat",Status:"Tila",Source_Code:"LÃ¤hdekoodi"};WYMeditor.STRINGS.fr={Strong:"Mise en Ã©vidence",Emphasis:"Emphase",Superscript:"Exposant",Subscript:"Indice",Ordered_List:"Liste OrdonnÃ©e",Unordered_List:"Liste Non-OrdonnÃ©e",Indent:"ImbriquÃ©",Outdent:"Non-imbriquÃ©",Undo:"Annuler",Redo:"RÃ©tablir",Link:"Lien",Unlink:"Supprimer le Lien",Image:"Image",Table:"Tableau",HTML:"HTML",Paragraph:"Paragraphe",Heading_1:"Titre 1",Heading_2:"Titre 2",Heading_3:"Titre 3",Heading_4:"Titre 4",Heading_5:"Titre 5",Heading_6:"Titre 6",Preformatted:"PrÃ©-formattÃ©",Blockquote:"Citation",Table_Header:"Cellule de titre",URL:"URL",Title:"Titre",Alternative_Text:"Texte alternatif",Caption:"LÃ©gende",Summary:"RÃ©sumÃ©",Number_Of_Rows:"Nombre de lignes",Number_Of_Cols:"Nombre de colonnes",Submit:"Envoyer",Cancel:"Annuler",Choose:"Choisir",Preview:"PrÃ©visualisation",Paste_From_Word:"Copier depuis Word",Tools:"Outils",Containers:"Type de texte",Classes:"Type de contenu",Status:"Infos",Source_Code:"Code source"};WYMeditor.STRINGS.gl={Strong:"Moita Ã©nfase",Emphasis:"Ãnfase",Superscript:"SuperÃ­ndice",Subscript:"SubÃ­ndice",Ordered_List:"Lista ordenada",Unordered_List:"Lista sen ordenar",Indent:"AniÃ±ar",Outdent:"DesaniÃ±ar",Undo:"Desfacer",Redo:"Refacer",Link:"LigazÃ³n",Unlink:"Desligar",Image:"Imaxe",Table:"TÃ¡boa",HTML:"HTML",Paragraph:"ParÃ¡grafo",Heading_1:"TÃ­tulo 1",Heading_2:"TÃ­tulo 2",Heading_3:"TÃ­tulo 3",Heading_4:"TÃ­tulo 4",Heading_5:"TÃ­tulo 5",Heading_6:"TÃ­tulo 6",Preformatted:"Preformatado",Blockquote:"Cita en parÃ¡grafo",Table_Header:"Cabeceira da tÃ¡boa",URL:"URL",Title:"TÃ­tulo",Alternative_Text:"Texto alternativo",Caption:"TÃ­tulo",Summary:"Resumo",Number_Of_Rows:"NÃºmero de filas",Number_Of_Cols:"NÃºmero de columnas",Submit:"Enviar",Cancel:"Cancelar",Choose:"Escoller",Preview:"Previsualizar",Paste_From_Word:"Colar dende Word",Tools:"Ferramentas",Containers:"Contenedores",Classes:"Clases",Status:"Estado",Source_Code:"CÃ³digo fonte"};WYMeditor.STRINGS.he={Strong:"×××§",Emphasis:"×××××",Superscript:"××ª× ×¢×××",Subscript:"××ª× ×ª××ª×",Ordered_List:"×¨×©××× ××××¡×¤×¨×ª",Unordered_List:"×¨×©××× ×× ××××¡×¤×¨×ª",Indent:"×××× ×¤× ×××",Outdent:"×××× ××××¦×",Undo:"××× ×¤×¢×××",Redo:"××¦×¢ ××××© ×¤×¢×××",Link:"×§××©××¨",Unlink:"××× ×§××©××¨",Image:"×ª××× ×",Table:"××××",HTML:"×§×× HTML",Paragraph:"×¤×¡×§×",Heading_1:"×××ª×¨×ª 1 ; ×ª× &lt;h1&gt;",Heading_2:"×××ª×¨×ª 2 ; ×ª× &lt;h2&gt;",Heading_3:"×××ª×¨×ª 3 ; ×ª× &lt;h3&gt;",Heading_4:"×××ª×¨×ª 4 ; ×ª× &lt;h4&gt;",Heading_5:"×××ª×¨×ª 5 ; ×ª× &lt;h5&gt;",Heading_6:"×××ª×¨×ª 6 ; ×ª× &lt;h6&gt;",Preformatted:"××©××¨ ×¨×××××",Blockquote:"×¦××××",Table_Header:"×××ª×¨×ª ××××",URL:"×§××©××¨ (URL)",Title:"×××ª×¨×ª",Alternative_Text:"××§×¡× ××××¤×",Caption:"×××ª×¨×ª",Summary:"×¡××××",Number_Of_Rows:"××¡×¤×¨ ×©××¨××ª",Number_Of_Cols:"××¡×¤×¨ ×××¨××",Submit:"×©××",Cancel:"×××",Choose:"×××¨",Preview:"×ª×¦××× ××§××××",Paste_From_Word:"××¢×ª×§ ×-Word",Tools:"××××",Containers:"××××××",Classes:"××××§××ª",Status:"××¦×",Source_Code:"×§×× ××§××¨"};WYMeditor.STRINGS.hr={Strong:"Podebljano",Emphasis:"NaglaÅ¡eno",Superscript:"Iznad",Subscript:"Ispod",Ordered_List:"Pobrojana lista",Unordered_List:"Nepobrojana lista",Indent:"Uvuci",Outdent:"Izvuci",Undo:"PoniÅ¡ti promjenu",Redo:"Ponovno promjeni",Link:"Hiperveza",Unlink:"Ukloni hipervezu",Image:"Slika",Table:"Tablica",HTML:"HTML",Paragraph:"Paragraf",Heading_1:"Naslov 1",Heading_2:"Naslov 2",Heading_3:"Naslov 3",Heading_4:"Naslov 4",Heading_5:"Naslov 5",Heading_6:"Naslov 6",Preformatted:"Unaprijed formatirano",Blockquote:"Citat",Table_Header:"Zaglavlje tablice",URL:"URL",Title:"Naslov",Alternative_Text:"Alternativni tekst",Caption:"Zaglavlje",Summary:"SaÅ¾etak",Number_Of_Rows:"Broj redova",Number_Of_Cols:"Broj kolona",Submit:"Snimi",Cancel:"Odustani",Choose:"Izaberi",Preview:"Pregled",Paste_From_Word:"Zalijepi iz Word-a",Tools:"Alati",Containers:"Kontejneri",Classes:"Klase",Status:"Status",Source_Code:"Izvorni kod"};WYMeditor.STRINGS.hu={Strong:"FÃ©lkÃ¶vÃ©r",Emphasis:"Kiemelt",Superscript:"FelsÅ index",Subscript:"AlsÃ³ index",Ordered_List:"Rendezett lista",Unordered_List:"Rendezetlen lista",Indent:"BekezdÃ©s",Outdent:"BekezdÃ©s tÃ¶rlÃ©se",Undo:"Visszavon",Redo:"VisszaÃ¡llÃ­t",Link:"Link",Unlink:"Link tÃ¶rlÃ©se",Image:"KÃ©p",Table:"TÃ¡bla",HTML:"HTML",Paragraph:"BekezdÃ©s",Heading_1:"CÃ­msor 1",Heading_2:"CÃ­msor 2",Heading_3:"CÃ­msor 3",Heading_4:"CÃ­msor 4",Heading_5:"CÃ­msor 5",Heading_6:"CÃ­msor 6",Preformatted:"ElÅformÃ¡zott",Blockquote:"IdÃ©zet",Table_Header:"TÃ¡bla FejlÃ©c",URL:"WebcÃ­m",Title:"MegnevezÃ©s",Alternative_Text:"AlternatÃ­v szÃ¶veg",Caption:"FejlÃ©c",Summary:"Summary",Number_Of_Rows:"Sorok szÃ¡ma",Number_Of_Cols:"Oszlopok szÃ¡ma",Submit:"ElkÃ¼ld",Cancel:"MÃ©gsem",Choose:"VÃ¡laszt",Preview:"ElÅnÃ©zet",Paste_From_Word:"MÃ¡solÃ¡s Word-bÃ³l",Tools:"EszkÃ¶zÃ¶k",Containers:"Tartalmak",Classes:"OsztÃ¡lyok",Status:"Ãllapot",Source_Code:"ForrÃ¡skÃ³d"};WYMeditor.STRINGS.it={Strong:"Grassetto",Emphasis:"Corsetto",Superscript:"Apice",Subscript:"Pedice",Ordered_List:"Lista Ordinata",Unordered_List:"Lista Puntata",Indent:"Indenta",Outdent:"Caccia",Undo:"Indietro",Redo:"Avanti",Link:"Inserisci Link",Unlink:"Togli Link",Image:"Inserisci Immagine",Table:"Inserisci Tabella",HTML:"HTML",Paragraph:"Paragrafo",Heading_1:"Heading 1",Heading_2:"Heading 2",Heading_3:"Heading 3",Heading_4:"Heading 4",Heading_5:"Heading 5",Heading_6:"Heading 6",Preformatted:"Preformattato",Blockquote:"Blockquote",Table_Header:"Header Tabella",URL:"Indirizzo",Title:"Titolo",Alternative_Text:"Testo Alternativo",Caption:"Caption",Summary:"Summary",Number_Of_Rows:"Numero di Righe",Number_Of_Cols:"Numero di Colonne",Submit:"Invia",Cancel:"Cancella",Choose:"Scegli",Preview:"Anteprima",Paste_From_Word:"Incolla",Tools:"Tools",Containers:"Contenitori",Classes:"Classi",Status:"Stato",Source_Code:"Codice Sorgente"};WYMeditor.STRINGS.ja={Strong:"å¼·èª¿<strong>",Emphasis:"å¼·èª¿<em>",Superscript:"ä¸ä»ã",Subscript:"ä¸ä»ã",Ordered_List:"çªå·ä»ããªã¹ã",Unordered_List:"çªå·ç¡ãªã¹ã",Indent:"ã¤ã³ãã³ããå¢ãã",Outdent:"ã¤ã³ãã³ããæ¸ãã",Undo:"åã«æ»ã",Redo:"ããç´ã",Link:"ãªã³ã¯",Unlink:"ãªã³ã¯åæ¶",Image:"ç»å",Table:"ãã¼ãã«",HTML:"HTML",Paragraph:"æ®µè½",Heading_1:"è¦åºã 1",Heading_2:"è¦åºã 2",Heading_3:"è¦åºã 3",Heading_4:"è¦åºã 4",Heading_5:"è¦åºã 5",Heading_6:"è¦åºã 6",Preformatted:"æ´å½¢æ¸ã¿ãã­ã¹ã",Blockquote:"å¼ç¨æ",Table_Header:"è¡¨è¦åºã",URL:"URL",Title:"ã¿ã¤ãã«",Alternative_Text:"ä»£æ¿ãã­ã¹ã",Caption:"ã­ã£ãã·ã§ã³",Summary:"ãµããªã¼",Number_Of_Rows:"è¡æ°",Number_Of_Cols:"åæ°",Submit:"éä¿¡",Cancel:"ã­ã£ã³ã»ã«",Choose:"é¸æ",Preview:"ãã¬ãã¥ã¼",Paste_From_Word:"è²¼ãä»ã",Tools:"ãã¼ã«",Containers:"ã³ã³ãã",Classes:"ã¯ã©ã¹",Status:"ã¹ãã¼ã¿ã¹",Source_Code:"ã½ã¼ã¹ã³ã¼ã"};WYMeditor.STRINGS.lt={Strong:"Pusjuodis",Emphasis:"Kursyvas",Superscript:"VirÅ¡utinis indeksas",Subscript:"Apatinis indeksas",Ordered_List:"Numeruotas sÄraÅ¡as",Unordered_List:"SuÅ¾enklintas sÄraÅ¡as",Indent:"Padidinti Ä¯traukÄ",Outdent:"SumaÅ¾inti Ä¯traukÄ",Undo:"AtÅ¡aukti",Redo:"Atstatyti",Link:"Nuoroda",Unlink:"Panaikinti nuorodÄ",Image:"Vaizdas",Table:"LentelÄ",HTML:"HTML",Paragraph:"Paragrafas",Heading_1:"AntraÅ¡tinis 1",Heading_2:"AntraÅ¡tinis 2",Heading_3:"AntraÅ¡tinis 3",Heading_4:"AntraÅ¡tinis 4",Heading_5:"AntraÅ¡tinis 5",Heading_6:"AntraÅ¡tinis 6",Preformatted:"Formuotas",Blockquote:"Citata",Table_Header:"LentelÄs antraÅ¡tÄ",URL:"URL",Title:"AntraÅ¡tinis tekstas",Relationship:"SÄryÅ¡is",Alternative_Text:"Alternatyvus tekstas",Caption:"AntraÅ¡tÄ",Summary:"Santrauka",Number_Of_Rows:"EiluÄiÅ³ skaiÄius",Number_Of_Cols:"StulpeliÅ³ skaiÄius",Submit:"IÅ¡saugoti",Cancel:"Nutraukti",Choose:"Rinktis",Preview:"PerÅ¾iÅ«ra",Paste_From_Word:"Ä®kelti iÅ¡ MS Word",Tools:"Ä®rankiai",Containers:"Stiliai",Classes:"KlasÄs",Status:"Statusas",Source_Code:"IÅ¡eities tekstas"};WYMeditor.STRINGS.nb={Strong:"Fet",Emphasis:"Uthevet",Superscript:"OpphÃ¸yet",Subscript:"Nedsenket",Ordered_List:"Nummerert liste",Unordered_List:"Punktliste",Indent:"Rykk inn",Outdent:"Rykk ut",Undo:"Angre",Redo:"Gjenta",Link:"Lenke",Unlink:"Ta bort lenken",Image:"Bilde",Table:"Tabell",HTML:"HTML",Paragraph:"Avsnitt",Heading_1:"Overskrift 1",Heading_2:"Overskrift 2",Heading_3:"Overskrift 3",Heading_4:"Overskrift 4",Heading_5:"Overskrift 5",Heading_6:"Overskrift 6",Preformatted:"Preformatert",Blockquote:"Sitat",Table_Header:"Tabelloverskrift",URL:"URL",Title:"Tittel",Alternative_Text:"Alternativ tekst",Caption:"Overskrift",Summary:"Sammendrag",Number_Of_Rows:"Antall rader",Number_Of_Cols:"Antall kolonner",Submit:"Ok",Cancel:"Avbryt",Choose:"Velg",Preview:"ForhÃ¥ndsvis",Paste_From_Word:"Lim inn fra Word",Tools:"VerktÃ¸y",Containers:"Formatering",Classes:"Klasser",Status:"Status",Source_Code:"Kildekode"};WYMeditor.STRINGS.nl={Strong:"Sterk benadrukken",Emphasis:"Benadrukken",Superscript:"Bovenschrift",Subscript:"Onderschrift",Ordered_List:"Geordende lijst",Unordered_List:"Ongeordende lijst",Indent:"Inspringen",Outdent:"Terugspringen",Undo:"Ongedaan maken",Redo:"Opnieuw uitvoeren",Link:"Linken",Unlink:"Ontlinken",Image:"Afbeelding",Table:"Tabel",HTML:"HTML",Paragraph:"Paragraaf",Heading_1:"Kop 1",Heading_2:"Kop 2",Heading_3:"Kop 3",Heading_4:"Kop 4",Heading_5:"Kop 5",Heading_6:"Kop 6",Preformatted:"Voorgeformatteerd",Blockquote:"Citaat",Table_Header:"Tabel-kop",URL:"URL",Title:"Titel",Relationship:"Relatie",Alternative_Text:"Alternatieve tekst",Caption:"Bijschrift",Summary:"Summary",Number_Of_Rows:"Aantal rijen",Number_Of_Cols:"Aantal kolommen",Submit:"Versturen",Cancel:"Annuleren",Choose:"Kiezen",Preview:"Voorbeeld bekijken",Paste_From_Word:"Plakken uit Word",Tools:"Hulpmiddelen",Containers:"Teksttypes",Classes:"Klassen",Status:"Status",Source_Code:"Broncode"};WYMeditor.STRINGS.nn={Strong:"Feit",Emphasis:"Utheva",Superscript:"OpphÃ¸gd",Subscript:"Nedsenka",Ordered_List:"Nummerert liste",Unordered_List:"Punktliste",Indent:"Rykk inn",Outdent:"Rykk ut",Undo:"Angre",Redo:"Gjentaka",Link:"Lenkje",Unlink:"Ta bort lenkja",Image:"Bilete",Table:"Tabell",HTML:"HTML",Paragraph:"Avsnitt",Heading_1:"Overskrift 1",Heading_2:"Overskrift 2",Heading_3:"Overskrift 3",Heading_4:"Overskrift 4",Heading_5:"Overskrift 5",Heading_6:"Overskrift 6",Preformatted:"Preformatert",Blockquote:"Sitat",Table_Header:"Tabelloverskrift",URL:"URL",Title:"Tittel",Alternative_Text:"Alternativ tekst",Caption:"Overskrift",Summary:"Samandrag",Number_Of_Rows:"Tal pÃ¥ rader",Number_Of_Cols:"Tal pÃ¥ kolonnar",Submit:"Ok",Cancel:"Avbryt",Choose:"Vel",Preview:"FÃ¸rehandsvis",Paste_From_Word:"Lim inn frÃ¥ Word",Tools:"Verkty",Containers:"Formatering",Classes:"Klassar",Status:"Status",Source_Code:"Kjeldekode"};WYMeditor.STRINGS.pl={Strong:"Nacisk",Emphasis:"Emfaza",Superscript:"Indeks gÃ³rny",Subscript:"Indeks dolny",Ordered_List:"Lista numerowana",Unordered_List:"Lista wypunktowana",Indent:"ZwiÄksz wciÄcie",Outdent:"Zmniejsz wciÄcie",Undo:"Cofnij",Redo:"PonÃ³w",Link:"Wstaw link",Unlink:"UsuÅ link",Image:"Obraz",Table:"Tabela",HTML:"Å¹rÃ³dÅo HTML",Paragraph:"Akapit",Heading_1:"NagÅÃ³wek 1",Heading_2:"NagÅÃ³wek 2",Heading_3:"NagÅÃ³wek 3",Heading_4:"NagÅÃ³wek 4",Heading_5:"NagÅÃ³wek 5",Heading_6:"NagÅÃ³wek 6",Preformatted:"Preformatowany",Blockquote:"Cytat blokowy",Table_Header:"NagÅÃ³wek tabeli",URL:"URL",Title:"TytuÅ",Alternative_Text:"Tekst alternatywny",Caption:"TytuÅ tabeli",Summary:"Summary",Number_Of_Rows:"Liczba wierszy",Number_Of_Cols:"Liczba kolumn",Submit:"WyÅlij",Cancel:"Anuluj",Choose:"Wybierz",Preview:"PodglÄd",Paste_From_Word:"Wklej z Worda",Tools:"NarzÄdzia",Containers:"Format",Classes:"Styl",Status:"Status",Source_Code:"Kod ÅºrÃ³dÅowy"};WYMeditor.STRINGS["pt-br"]={Strong:"Resaltar",Emphasis:"Enfatizar",Superscript:"Sobre escrito",Subscript:"Sub escrito ",Ordered_List:"Lista ordenada",Unordered_List:"Lista desordenada",Indent:"Indentado",Outdent:"Desidentar",Undo:"Desfazer",Redo:"Refazer",Link:"Link",Unlink:"Remover Link",Image:"Imagem",Table:"Tabela",HTML:"HTML",Paragraph:"ParÃ¡grafo",Heading_1:"TÃ­tulo 1",Heading_2:"TÃ­tulo 2",Heading_3:"TÃ­tulo 3",Heading_4:"TÃ­tulo 4",Heading_5:"TÃ­tulo 5",Heading_6:"TÃ­tulo 6",Preformatted:"Preformatado",Blockquote:"CitaÃ§Ã£o",Table_Header:"TÃ­tulo de tabela",URL:"URL",Title:"TÃ­tulo",Alternative_Text:"Texto alternativo",Caption:"Legenda",Summary:"Summary",Number_Of_Rows:"NÃºmero de linhas",Number_Of_Cols:"NÃºmero de colunas",Submit:"Enviar",Cancel:"Cancelar",Choose:"Selecionar",Preview:"Previsualizar",Paste_From_Word:"Copiar do Word",Tools:"Ferramentas",Containers:"Conteneiners",Classes:"Classes",Status:"Estado",Source_Code:"CÃ³digo fonte"};WYMeditor.STRINGS.pt={Strong:"Negrito",Emphasis:"ItÃ¡lico",Superscript:"Sobrescrito",Subscript:"Subsescrito",Ordered_List:"Lista Numerada",Unordered_List:"Lista Marcada",Indent:"Aumentar IndentaÃ§Ã£",Outdent:"Diminuir IndentaÃ§Ã£",Undo:"Desfazer",Redo:"Restaurar",Link:"Link",Unlink:"Tirar link",Image:"Imagem",Table:"Tabela",HTML:"HTML",Paragraph:"ParÃ¡grafo",Heading_1:"TÃ­tulo 1",Heading_2:"TÃ­tulo 2",Heading_3:"TÃ­tulo 3",Heading_4:"TÃ­tulo 4",Heading_5:"TÃ­tulo 5",Heading_6:"TÃ­tulo 6",Preformatted:"PrÃ©-formatado",Blockquote:"CitaÃ§Ã£o",Table_Header:"CabeÃ§alho Tabela",URL:"URL",Title:"TÃ­tulo",Alternative_Text:"Texto Alterativo",Caption:"TÃ­tulo Tabela",Summary:"Summary",Number_Of_Rows:"NÃºmero de Linhas",Number_Of_Cols:"NÃºmero de Colunas",Submit:"Enviar",Cancel:"Cancelar",Choose:"Escolha",Preview:"Prever",Paste_From_Word:"Colar do Word",Tools:"Ferramentas",Containers:"Containers",Classes:"Classes",Status:"Status",Source_Code:"CÃ³digo Fonte"};WYMeditor.STRINGS.ru={Strong:"ÐÐ¸ÑÐ½ÑÐ¹",Emphasis:"ÐÐ°ÐºÐ»Ð¾Ð½Ð½ÑÐ¹",Superscript:"ÐÐ°Ð´ÑÑÑÐ¾ÑÐ½ÑÐ¹",Subscript:"ÐÐ¾Ð´ÑÑÑÐ¾ÑÐ½ÑÐ¹",Ordered_List:"ÐÑÐ¼ÐµÑÐ¾Ð²Ð°Ð½ÑÐ¹ ÑÐ¿Ð¸ÑÐ¾Ðº",Unordered_List:"ÐÐµÐ½ÑÐ¼ÐµÑÐ¾Ð²Ð°Ð½ÑÐ¹ ÑÐ¿Ð¸ÑÐ¾Ðº",Indent:"Ð£Ð²ÐµÐ»Ð¸ÑÐ¸ÑÑ Ð¾ÑÑÑÑÐ¿",Outdent:"Ð£Ð¼ÐµÐ½ÑÑÐ¸ÑÑ Ð¾ÑÑÑÑÐ¿",Undo:"ÐÑÐ¼ÐµÐ½Ð¸ÑÑ",Redo:"ÐÐ¾Ð²ÑÐ¾ÑÐ¸ÑÑ",Link:"Ð¡ÑÑÐ»ÐºÐ°",Unlink:"Ð£Ð´Ð°Ð»Ð¸ÑÑ ÑÑÑÐ»ÐºÑ",Image:"ÐÐ·Ð¾Ð±ÑÐ°Ð¶ÐµÐ½Ð¸Ðµ",Table:"Ð¢Ð°Ð±Ð»Ð¸ÑÐ°",HTML:"ÐÑÐ°Ð²Ð¸ÑÑ HTML",Paragraph:"ÐÐ°ÑÐ°Ð³ÑÐ°Ñ",Heading_1:"ÐÐ°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº 1",Heading_2:"ÐÐ°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº 2",Heading_3:"ÐÐ°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº 3",Heading_4:"ÐÐ°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº 4",Heading_5:"ÐÐ°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº 5",Heading_6:"ÐÐ°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº 6",Preformatted:"Preformatted",Blockquote:"Ð¦Ð¸ÑÐ°ÑÐ°",Table_Header:"ÐÐ°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº ÑÐ°Ð±Ð»Ð¸ÑÑ",URL:"URL",Title:"ÐÐ°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº",Alternative_Text:"ÐÐ»ÑÑÐµÑÐ½Ð°ÑÐ¸Ð²Ð½ÑÐ¹ ÑÐµÐºÑÑ",Caption:"ÐÐ°Ð´Ð¿Ð¸ÑÑ",Summary:"Summary",Number_Of_Rows:"ÐÐ¾Ð»-Ð²Ð¾ ÑÑÑÐ¾Ðº",Number_Of_Cols:"ÐÐ¾Ð»-Ð²Ð¾ ÑÑÐ¾Ð»Ð±ÑÐ¾Ð²",Submit:"ÐÑÐ¿ÑÐ°Ð²Ð¸ÑÑ",Cancel:"ÐÑÐ¼ÐµÐ½Ð°",Choose:"ÐÑÐ±Ð¾Ñ",Preview:"ÐÑÐ¾ÑÐ¼Ð¾ÑÑ",Paste_From_Word:"ÐÑÑÐ°Ð²Ð¸ÑÑ Ð¸Ð· Word",Tools:"ÐÐ½ÑÑÑÑÐ¼ÐµÐ½ÑÑ",Containers:"ÐÐ¾Ð½ÑÐµÐ¹Ð½ÐµÑÑ",Classes:"ÐÐ»Ð°ÑÑÑ",Status:"Ð¡ÑÐ°ÑÑÑ",Source_Code:"ÐÑÑÐ¾Ð´Ð½ÑÐ¹ ÐºÐ¾Ð´"};WYMeditor.STRINGS.sk={Strong:"TuÄnÃ©",Emphasis:"KurzÃ­va",Superscript:"HornÃ½ index",Subscript:"DolnÃ½ index",Ordered_List:"ÄÃ­slovanÃ½ zoznam",Unordered_List:"NeÄÃ­slovanÃ½ zoznam",Indent:"ZvÃ¤ÄÅ¡iÅ¥ odsadenie",Outdent:"ZmenÅ¡iÅ¥ odsadenie",Undo:"VrÃ¡tiÅ¥",Redo:"OpakovaÅ¥",Link:"VytvoriÅ¥ odkaz",Unlink:"ZruÅ¡iÅ¥ odkaz",Image:"ObrÃ¡zok",Table:"TabuÄ¾ka",HTML:"HTML",Paragraph:"Odstavec",Heading_1:"Nadpis 1. Ãºrovne",Heading_2:"Nadpis 2. Ãºrovne",Heading_3:"Nadpis 3. Ãºrovne",Heading_4:"Nadpis 4. Ãºrovne",Heading_5:"Nadpis 5. Ãºrovne",Heading_6:"Nadpis 6. Ãºrovne",Preformatted:"PredformÃ¡tovanÃ½ text",Blockquote:"CitÃ¡cia",Table_Header:"HlaviÄka tabuÄ¾ky",URL:"URL adresa",Title:"Titulok",Alternative_Text:"AlternatÃ­vny text",Caption:"Titulok tabuÄ¾ky",Summary:"Zhrnutie obsahu",Number_Of_Rows:"PoÄet riadkov",Number_Of_Cols:"PoÄet stÄºpcov",Submit:"OdoslaÅ¥",Cancel:"ZruÅ¡iÅ¥",Choose:"VybraÅ¥",Preview:"NÃ¡hÄ¾ad",Paste_From_Word:"VloÅ¾iÅ¥ z Wordu",Tools:"NÃ¡stroje",Containers:"Typy obsahu",Classes:"Triedy",Status:"Stav",Source_Code:"ZdrojovÃ½ kÃ³d"};WYMeditor.STRINGS.sv={Strong:"Viktigt",Emphasis:"Betoning",Superscript:"UpphÃ¶jt",Subscript:"NedsÃ¤nkt",Ordered_List:"Nummerlista",Unordered_List:"Punktlista",Indent:"Indrag",Outdent:"Utdrag",Undo:"Ãngra",Redo:"GÃ¶r om",Link:"LÃ¤nk",Unlink:"Ta bort lÃ¤nk",Image:"Bild",Table:"Tabell",HTML:"HTML",Paragraph:"Paragraf",Heading_1:"Rubrik 1",Heading_2:"Rubrik 2",Heading_3:"Rubrik 3",Heading_4:"Rubrik 4",Heading_5:"Rubrik 5",Heading_6:"Rubrik 6",Preformatted:"FÃ¶rformaterad",Blockquote:"Blockcitat",Table_Header:"Tabellrubrik",URL:"URL",Title:"Titel",Relationship:"Relation",Alternative_Text:"Alternativ text",Caption:"Ãverskrift",Summary:"Summary",Number_Of_Rows:"Antal rader",Number_Of_Cols:"Antal kolumner",Submit:"Skicka",Cancel:"Avbryt",Choose:"VÃ¤lj",Preview:"FÃ¶rhandsgranska",Paste_From_Word:"Klistra in frÃ¥n Word",Tools:"Verktyg",Containers:"Formatering",Classes:"Klasser",Status:"Status",Source_Code:"KÃ¤llkod"};WYMeditor.STRINGS.tr={Strong:"KalÄ±n",Emphasis:"Vurgu",Superscript:"Ãstsimge",Subscript:"Altsimge",Ordered_List:"SÄ±ralÄ± List",Unordered_List:"SÄ±rasÄ±z List",Indent:"Girintile",Outdent:"ÃÄ±kÄ±ntÄ±la",Undo:"Geri Al",Redo:"Yinele",Link:"BaÄlantÄ±",Unlink:"BaÄlantÄ±yÄ± KaldÄ±r",Image:"Resim",Table:"Tablo",HTML:"HTML",Paragraph:"ParaÄraf",Heading_1:"BaÅlÄ±k 1",Heading_2:"BaÅlÄ±k 2",Heading_3:"BaÅlÄ±k 3",Heading_4:"BaÅlÄ±k 4",Heading_5:"BaÅlÄ±k 5",Heading_6:"BaÅlÄ±k 6",Preformatted:"Ãnceden FormatlÄ±",Blockquote:"AlÄ±ntÄ±",Table_Header:"Tablo BaÅlÄ±ÄÄ±",URL:"URL",Title:"BaÅlÄ±k",Alternative_Text:"Alternatif Metin",Caption:"Etiket",Summary:"Ãzet",Number_Of_Rows:"SatÄ±r sayÄ±sÄ±",Number_Of_Cols:"SÃ¼tun sayÄ±sÄ±",Submit:"GÃ¶nder",Cancel:"Ä°ptal",Choose:"SeÃ§",Preview:"Ãnizleme",Paste_From_Word:"Word'den yapÄ±ÅtÄ±r",Tools:"AraÃ§lar",Containers:"KapsayÄ±cÄ±lar",Classes:"SÄ±nÄ±flar",Status:"Durum",Source_Code:"Kaynak Kodu"};WYMeditor.STRINGS.zh_cn={Strong:"å ç²",Emphasis:"æä½",Superscript:"ä¸æ ",Subscript:"ä¸æ ",Ordered_List:"æåºåè¡¨",Unordered_List:"æ åºåè¡¨",Indent:"å¢å ç¼©è¿",Outdent:"åå°ç¼©è¿",Undo:"æ¤æ¶",Redo:"éå",Link:"é¾æ¥",Unlink:"åæ¶é¾æ¥",Image:"å¾ç",Table:"è¡¨æ ¼",HTML:"HTMLæºä»£ç ",Paragraph:"æ®µè½",Heading_1:"æ é¢ 1",Heading_2:"æ é¢ 2",Heading_3:"æ é¢ 3",Heading_4:"æ é¢ 4",Heading_5:"æ é¢ 5",Heading_6:"æ é¢ 6",Preformatted:"åå§ææ¬",Blockquote:"å¼è¯­",Table_Header:"è¡¨å¤´",URL:"å°å",Title:"æç¤ºæå­",Alternative_Text:"å¤±ææå­",Caption:"æ é¢",Summary:"Summary",Number_Of_Rows:"è¡æ°",Number_Of_Cols:"åæ°",Submit:"æäº¤",Cancel:"æ¾å¼",Choose:"éæ©",Preview:"é¢è§",Paste_From_Word:"ä»Wordç²è´´çº¯ææ¬",Tools:"å·¥å·",Containers:"å®¹å¨",Classes:"é¢å®ä¹æ ·å¼",Status:"ç¶æ",Source_Code:"æºä»£ç ",Attachment:"éä»¶",NewParagraph:"æ°æ®µè½"};WYMeditor.STRINGS.zh_tw={Strong:"å ç²",Emphasis:"æé«",Superscript:"ä¸æ¨",Subscript:"ä¸æ¨",Ordered_List:"æåºåè¡¨",Unordered_List:"ç¡åºåè¡¨",Indent:"å¢å ç¸®æ",Outdent:"æ¸å°ç¸®æ",Undo:"åæ¶",Redo:"éå",Link:"éçµ",Unlink:"åæ¶éçµ",Image:"åç",Table:"è¡¨æ ¼",HTML:"HTML æºä»£ç¢¼",Paragraph:"æ®µè½",Heading_1:"æ¨é¡ 1",Heading_2:"æ¨é¡ 2",Heading_3:"æ¨é¡ 3",Heading_4:"æ¨é¡ 4",Heading_5:"æ¨é¡ 5",Heading_6:"æ¨é¡ 6",Preformatted:"åå§ææ¬",Blockquote:"å¼èª",Table_Header:"è¡¨æ ¼é é¨",URL:"å°å",Title:"æç¤ºæå­",Alternative_Text:"å¤±ææå­",Caption:"ä¸»é¡",Summary:"å¤§ç¶±",Number_Of_Rows:"è¡æ¸",Number_Of_Cols:"åæ¸",Submit:"æäº¤",Cancel:"æ¾æ£",Choose:"é¸æ",Preview:"é è¦½",Paste_From_Word:"å¾Wordè¤å¶ç´ææ¬",Tools:"å·¥å·",Containers:"å®¹å¨",Classes:"é å®ç¾©æ¨£å¼",Status:"çæ",Source_Code:"æºä»£ç¢¼",Attachment:"éä»¶",NewParagraph:"æ°æ®µè½"};window["rangy"]=function(){var OBJECT="object",FUNCTION="function",UNDEFINED="undefined";var domRangeProperties=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"];var domRangeMethods=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"];var textRangeProperties=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"];var textRangeMethods=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint","getBoundingClientRect"];function isHostMethod(o,p){var t=typeof o[p];return t==FUNCTION||!!(t==OBJECT&&o[p])||t=="unknown"}function isHostObject(o,p){return!!(typeof o[p]==OBJECT&&o[p])}function isHostProperty(o,p){return typeof o[p]!=UNDEFINED}function createMultiplePropertyTest(testFunc){return function(o,props){var i=props.length;while(i--){if(!testFunc(o,props[i])){return false}}return true}}var areHostMethods=createMultiplePropertyTest(isHostMethod);var areHostObjects=createMultiplePropertyTest(isHostObject);var areHostProperties=createMultiplePropertyTest(isHostProperty);function isTextRange(range){return range&&areHostMethods(range,textRangeMethods)&&areHostProperties(range,textRangeProperties)}var api={version:"1.2.2",initialized:false,supported:true,util:{isHostMethod:isHostMethod,isHostObject:isHostObject,isHostProperty:isHostProperty,areHostMethods:areHostMethods,areHostObjects:areHostObjects,areHostProperties:areHostProperties,isTextRange:isTextRange},features:{},modules:{},config:{alertOnWarn:false,preferTextRange:false}};function fail(reason){window.alert("Rangy not supported in your browser. Reason: "+reason);api.initialized=true;api.supported=false}api.fail=fail;function warn(msg){var warningMessage="Rangy warning: "+msg;if(api.config.alertOnWarn){window.alert(warningMessage)}else if(typeof window.console!=UNDEFINED&&typeof window.console.log!=UNDEFINED){window.console.log(warningMessage)}}api.warn=warn;if({}.hasOwnProperty){api.util.extend=function(o,props){for(var i in props){if(props.hasOwnProperty(i)){o[i]=props[i]}}}}else{fail("hasOwnProperty not supported")}var initListeners=[];var moduleInitializers=[];function init(){if(api.initialized){return}var testRange;var implementsDomRange=false,implementsTextRange=false;if(isHostMethod(document,"createRange")){testRange=document.createRange();if(areHostMethods(testRange,domRangeMethods)&&areHostProperties(testRange,domRangeProperties)){implementsDomRange=true}testRange.detach()}var body=isHostObject(document,"body")?document.body:document.getElementsByTagName("body")[0];if(body&&isHostMethod(body,"createTextRange")){testRange=body.createTextRange();if(isTextRange(testRange)){implementsTextRange=true}}if(!implementsDomRange&&!implementsTextRange){fail("Neither Range nor TextRange are implemented")}api.initialized=true;api.features={implementsDomRange:implementsDomRange,implementsTextRange:implementsTextRange};var allListeners=moduleInitializers.concat(initListeners);for(var i=0,len=allListeners.length;i<len;++i){try{allListeners[i](api)}catch(ex){if(isHostObject(window,"console")&&isHostMethod(window.console,"log")){window.console.log("Init listener threw an exception. Continuing.",ex)}}}}api.init=init;api.addInitListener=function(listener){if(api.initialized){listener(api)}else{initListeners.push(listener)}};var createMissingNativeApiListeners=[];api.addCreateMissingNativeApiListener=function(listener){createMissingNativeApiListeners.push(listener)};function createMissingNativeApi(win){win=win||window;init();for(var i=0,len=createMissingNativeApiListeners.length;i<len;++i){createMissingNativeApiListeners[i](win)}}api.createMissingNativeApi=createMissingNativeApi;function Module(name){this.name=name;this.initialized=false;this.supported=false}Module.prototype.fail=function(reason){this.initialized=true;this.supported=false;throw new Error("Module '"+this.name+"' failed to load: "+reason)};Module.prototype.warn=function(msg){api.warn("Module "+this.name+": "+msg)};Module.prototype.createError=function(msg){return new Error("Error in Rangy "+this.name+" module: "+msg)};api.createModule=function(name,initFunc){var module=new Module(name);api.modules[name]=module;moduleInitializers.push(function(api){initFunc(api,module);module.initialized=true;module.supported=true})};api.requireModules=function(modules){for(var i=0,len=modules.length,module,moduleName;i<len;++i){moduleName=modules[i];module=api.modules[moduleName];if(!module||!(module instanceof Module)){throw new Error("Module '"+moduleName+"' not found")}if(!module.supported){throw new Error("Module '"+moduleName+"' not supported")}}};var docReady=false;var loadHandler=function(e){if(!docReady){docReady=true;if(!api.initialized){init()}}};if(typeof window==UNDEFINED){fail("No window found");return}if(typeof document==UNDEFINED){fail("No document found");return}if(isHostMethod(document,"addEventListener")){document.addEventListener("DOMContentLoaded",loadHandler,false)}if(isHostMethod(window,"addEventListener")){window.addEventListener("load",loadHandler,false)}else if(isHostMethod(window,"attachEvent")){window.attachEvent("onload",loadHandler)}else{fail("Window does not have required addEventListener or attachEvent method")}return api}();rangy.createModule("DomUtil",function(api,module){var UNDEF="undefined";var util=api.util;if(!util.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])){module.fail("document missing a Node creation method")}if(!util.isHostMethod(document,"getElementsByTagName")){module.fail("document missing getElementsByTagName method")}var el=document.createElement("div");if(!util.areHostMethods(el,["insertBefore","appendChild","cloneNode"]||!util.areHostObjects(el,["previousSibling","nextSibling","childNodes","parentNode"]))){module.fail("Incomplete Element implementation")}if(!util.isHostProperty(el,"innerHTML")){module.fail("Element is missing innerHTML property")}var textNode=document.createTextNode("test");if(!util.areHostMethods(textNode,["splitText","deleteData","insertData","appendData","cloneNode"]||!util.areHostObjects(el,["previousSibling","nextSibling","childNodes","parentNode"])||!util.areHostProperties(textNode,["data"]))){module.fail("Incomplete Text Node implementation")}var arrayContains=function(arr,val){var i=arr.length;while(i--){if(arr[i]===val){return true}}return false};function isHtmlNamespace(node){var ns;return typeof node.namespaceURI==UNDEF||((ns=node.namespaceURI)===null||ns=="http://www.w3.org/1999/xhtml")}function parentElement(node){var parent=node.parentNode;return parent.nodeType==1?parent:null}function getNodeIndex(node){var i=0;while(node=node.previousSibling){i++}return i}function getNodeLength(node){var childNodes;return isCharacterDataNode(node)?node.length:(childNodes=node.childNodes)?childNodes.length:0}function getCommonAncestor(node1,node2){var ancestors=[],n;for(n=node1;n;n=n.parentNode){ancestors.push(n)}for(n=node2;n;n=n.parentNode){if(arrayContains(ancestors,n)){return n}}return null}function isAncestorOf(ancestor,descendant,selfIsAncestor){var n=selfIsAncestor?descendant:descendant.parentNode;while(n){if(n===ancestor){return true}else{n=n.parentNode}}return false}function getClosestAncestorIn(node,ancestor,selfIsAncestor){var p,n=selfIsAncestor?node:node.parentNode;while(n){p=n.parentNode;if(p===ancestor){return n}n=p}return null}function isCharacterDataNode(node){var t=node.nodeType;return t==3||t==4||t==8}function insertAfter(node,precedingNode){var nextNode=precedingNode.nextSibling,parent=precedingNode.parentNode;if(nextNode){parent.insertBefore(node,nextNode)}else{parent.appendChild(node)}return node}function splitDataNode(node,index){var newNode=node.cloneNode(false);newNode.deleteData(0,index);node.deleteData(index,node.length-index);insertAfter(newNode,node);return newNode}function getDocument(node){if(node.nodeType==9){return node}else if(typeof node.ownerDocument!=UNDEF){return node.ownerDocument}else if(typeof node.document!=UNDEF){return node.document}else if(node.parentNode){return getDocument(node.parentNode)}else{throw new Error("getDocument: no document found for node")}}function getWindow(node){var doc=getDocument(node);if(typeof doc.defaultView!=UNDEF){return doc.defaultView}else if(typeof doc.parentWindow!=UNDEF){return doc.parentWindow}else{throw new Error("Cannot get a window object for node")}}function getIframeDocument(iframeEl){if(typeof iframeEl.contentDocument!=UNDEF){return iframeEl.contentDocument}else if(typeof iframeEl.contentWindow!=UNDEF){return iframeEl.contentWindow.document}else{throw new Error("getIframeWindow: No Document object found for iframe element")}}function getIframeWindow(iframeEl){if(typeof iframeEl.contentWindow!=UNDEF){return iframeEl.contentWindow}else if(typeof iframeEl.contentDocument!=UNDEF){return iframeEl.contentDocument.defaultView}else{throw new Error("getIframeWindow: No Window object found for iframe element")}}function getBody(doc){return util.isHostObject(doc,"body")?doc.body:doc.getElementsByTagName("body")[0]}function getRootContainer(node){var parent;while(parent=node.parentNode){node=parent}return node}function comparePoints(nodeA,offsetA,nodeB,offsetB){var nodeC,root,childA,childB,n;if(nodeA==nodeB){return offsetA===offsetB?0:offsetA<offsetB?-1:1}else if(nodeC=getClosestAncestorIn(nodeB,nodeA,true)){return offsetA<=getNodeIndex(nodeC)?-1:1}else if(nodeC=getClosestAncestorIn(nodeA,nodeB,true)){return getNodeIndex(nodeC)<offsetB?-1:1}else{root=getCommonAncestor(nodeA,nodeB);childA=nodeA===root?root:getClosestAncestorIn(nodeA,root,true);childB=nodeB===root?root:getClosestAncestorIn(nodeB,root,true);if(childA===childB){throw new Error("comparePoints got to case 4 and childA and childB are the same!")}else{n=root.firstChild;while(n){if(n===childA){return-1}else if(n===childB){return 1}n=n.nextSibling}throw new Error("Should not be here!")}}}function fragmentFromNodeChildren(node){var fragment=getDocument(node).createDocumentFragment(),child;while(child=node.firstChild){fragment.appendChild(child)}return fragment}function inspectNode(node){if(!node){return"[No node]"}if(isCharacterDataNode(node)){return'"'+node.data+'"'}else if(node.nodeType==1){var idAttr=node.id?' id="'+node.id+'"':"";return"<"+node.nodeName+idAttr+">["+node.childNodes.length+"]"}else{return node.nodeName}}function NodeIterator(root){this.root=root;this._next=root}NodeIterator.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var n=this._current=this._next;var child,next;if(this._current){child=n.firstChild;if(child){this._next=child}else{next=null;while(n!==this.root&&!(next=n.nextSibling)){n=n.parentNode}this._next=next}}return this._current},detach:function(){this._current=this._next=this.root=null}};function createIterator(root){return new NodeIterator(root)}function DomPosition(node,offset){this.node=node;this.offset=offset}DomPosition.prototype={equals:function(pos){return this.node===pos.node&this.offset==pos.offset},inspect:function(){return"[DomPosition("+inspectNode(this.node)+":"+this.offset+")]"}};function DOMException(codeName){this.code=this[codeName];this.codeName=codeName;this.message="DOMException: "+this.codeName}DOMException.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11};DOMException.prototype.toString=function(){return this.message};api.dom={arrayContains:arrayContains,isHtmlNamespace:isHtmlNamespace,parentElement:parentElement,getNodeIndex:getNodeIndex,getNodeLength:getNodeLength,getCommonAncestor:getCommonAncestor,isAncestorOf:isAncestorOf,getClosestAncestorIn:getClosestAncestorIn,isCharacterDataNode:isCharacterDataNode,insertAfter:insertAfter,splitDataNode:splitDataNode,getDocument:getDocument,getWindow:getWindow,getIframeWindow:getIframeWindow,getIframeDocument:getIframeDocument,getBody:getBody,getRootContainer:getRootContainer,comparePoints:comparePoints,inspectNode:inspectNode,fragmentFromNodeChildren:fragmentFromNodeChildren,createIterator:createIterator,DomPosition:DomPosition};api.DOMException=DOMException});rangy.createModule("DomRange",function(api,module){api.requireModules(["DomUtil"]);var dom=api.dom;var DomPosition=dom.DomPosition;var DOMException=api.DOMException;function isNonTextPartiallySelected(node,range){return node.nodeType!=3&&(dom.isAncestorOf(node,range.startContainer,true)||dom.isAncestorOf(node,range.endContainer,true))}function getRangeDocument(range){return dom.getDocument(range.startContainer)}function dispatchEvent(range,type,args){var listeners=range._listeners[type];if(listeners){for(var i=0,len=listeners.length;i<len;++i){listeners[i].call(range,{target:range,args:args})}}}function getBoundaryBeforeNode(node){return new DomPosition(node.parentNode,dom.getNodeIndex(node))}function getBoundaryAfterNode(node){return new DomPosition(node.parentNode,dom.getNodeIndex(node)+1)}function insertNodeAtPosition(node,n,o){var firstNodeInserted=node.nodeType==11?node.firstChild:node;if(dom.isCharacterDataNode(n)){if(o==n.length){dom.insertAfter(node,n)}else{n.parentNode.insertBefore(node,o==0?n:dom.splitDataNode(n,o))}}else if(o>=n.childNodes.length){n.appendChild(node)}else{n.insertBefore(node,n.childNodes[o])}return firstNodeInserted}function cloneSubtree(iterator){var partiallySelected;for(var node,frag=getRangeDocument(iterator.range).createDocumentFragment(),subIterator;node=iterator.next();){partiallySelected=iterator.isPartiallySelectedSubtree();node=node.cloneNode(!partiallySelected);if(partiallySelected){subIterator=iterator.getSubtreeIterator();node.appendChild(cloneSubtree(subIterator));subIterator.detach(true)}if(node.nodeType==10){throw new DOMException("HIERARCHY_REQUEST_ERR")}frag.appendChild(node)}return frag}function iterateSubtree(rangeIterator,func,iteratorState){var it,n;iteratorState=iteratorState||{stop:false};for(var node,subRangeIterator;node=rangeIterator.next();){if(rangeIterator.isPartiallySelectedSubtree()){if(func(node)===false){iteratorState.stop=true;return}else{subRangeIterator=rangeIterator.getSubtreeIterator();iterateSubtree(subRangeIterator,func,iteratorState);subRangeIterator.detach(true);if(iteratorState.stop){return}}}else{it=dom.createIterator(node);while(n=it.next()){if(func(n)===false){iteratorState.stop=true;return}}}}}function deleteSubtree(iterator){var subIterator;while(iterator.next()){if(iterator.isPartiallySelectedSubtree()){subIterator=iterator.getSubtreeIterator();deleteSubtree(subIterator);subIterator.detach(true)}else{iterator.remove()}}}function extractSubtree(iterator){for(var node,frag=getRangeDocument(iterator.range).createDocumentFragment(),subIterator;node=iterator.next();){if(iterator.isPartiallySelectedSubtree()){node=node.cloneNode(false);subIterator=iterator.getSubtreeIterator();node.appendChild(extractSubtree(subIterator));subIterator.detach(true)}else{iterator.remove()}if(node.nodeType==10){throw new DOMException("HIERARCHY_REQUEST_ERR")}frag.appendChild(node)}return frag}function getNodesInRange(range,nodeTypes,filter){var filterNodeTypes=!!(nodeTypes&&nodeTypes.length),regex;var filterExists=!!filter;if(filterNodeTypes){regex=new RegExp("^("+nodeTypes.join("|")+")$")}var nodes=[];iterateSubtree(new RangeIterator(range,false),function(node){if((!filterNodeTypes||regex.test(node.nodeType))&&(!filterExists||filter(node))){nodes.push(node)}});return nodes}function inspect(range){var name=typeof range.getName=="undefined"?"Range":range.getName();return"["+name+"("+dom.inspectNode(range.startContainer)+":"+range.startOffset+", "+dom.inspectNode(range.endContainer)+":"+range.endOffset+")]"}function RangeIterator(range,clonePartiallySelectedTextNodes){this.range=range;this.clonePartiallySelectedTextNodes=clonePartiallySelectedTextNodes;if(!range.collapsed){this.sc=range.startContainer;this.so=range.startOffset;this.ec=range.endContainer;this.eo=range.endOffset;var root=range.commonAncestorContainer;if(this.sc===this.ec&&dom.isCharacterDataNode(this.sc)){this.isSingleCharacterDataNode=true;this._first=this._last=this._next=this.sc}else{this._first=this._next=this.sc===root&&!dom.isCharacterDataNode(this.sc)?this.sc.childNodes[this.so]:dom.getClosestAncestorIn(this.sc,root,true);this._last=this.ec===root&&!dom.isCharacterDataNode(this.ec)?this.ec.childNodes[this.eo-1]:dom.getClosestAncestorIn(this.ec,root,true)}}}RangeIterator.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:false,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var current=this._current=this._next;if(current){this._next=current!==this._last?current.nextSibling:null;if(dom.isCharacterDataNode(current)&&this.clonePartiallySelectedTextNodes){if(current===this.ec){(current=current.cloneNode(true)).deleteData(this.eo,current.length-this.eo)}if(this._current===this.sc){(current=current.cloneNode(true)).deleteData(0,this.so)}}}return current},remove:function(){var current=this._current,start,end;if(dom.isCharacterDataNode(current)&&(current===this.sc||current===this.ec)){start=current===this.sc?this.so:0;end=current===this.ec?this.eo:current.length;if(start!=end){current.deleteData(start,end-start)}}else{if(current.parentNode){current.parentNode.removeChild(current)}else{}}},isPartiallySelectedSubtree:function(){var current=this._current;return isNonTextPartiallySelected(current,this.range)},getSubtreeIterator:function(){var subRange;if(this.isSingleCharacterDataNode){subRange=this.range.cloneRange();subRange.collapse()}else{subRange=new Range(getRangeDocument(this.range));var current=this._current;var startContainer=current,startOffset=0,endContainer=current,endOffset=dom.getNodeLength(current);if(dom.isAncestorOf(current,this.sc,true)){startContainer=this.sc;startOffset=this.so}if(dom.isAncestorOf(current,this.ec,true)){endContainer=this.ec;endOffset=this.eo}updateBoundaries(subRange,startContainer,startOffset,endContainer,endOffset)}return new RangeIterator(subRange,this.clonePartiallySelectedTextNodes)},detach:function(detachRange){if(detachRange){this.range.detach()}this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};function RangeException(codeName){this.code=this[codeName];this.codeName=codeName;this.message="RangeException: "+this.codeName}RangeException.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2};RangeException.prototype.toString=function(){return this.message};function RangeNodeIterator(range,nodeTypes,filter){this.nodes=getNodesInRange(range,nodeTypes,filter);this._next=this.nodes[0];this._position=0}RangeNodeIterator.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){this._current=this._next;this._next=this.nodes[++this._position];return this._current},detach:function(){this._current=this._next=this.nodes=null}};var beforeAfterNodeTypes=[1,3,4,5,7,8,10];var rootContainerNodeTypes=[2,9,11];var readonlyNodeTypes=[5,6,10,12];var insertableNodeTypes=[1,3,4,5,7,8,10,11];var surroundNodeTypes=[1,3,4,5,7,8];function createAncestorFinder(nodeTypes){return function(node,selfIsAncestor){var t,n=selfIsAncestor?node:node.parentNode;while(n){t=n.nodeType;if(dom.arrayContains(nodeTypes,t)){return n}n=n.parentNode}return null}}var getRootContainer=dom.getRootContainer;var getDocumentOrFragmentContainer=createAncestorFinder([9,11]);var getReadonlyAncestor=createAncestorFinder(readonlyNodeTypes);var getDocTypeNotationEntityAncestor=createAncestorFinder([6,10,12]);function assertNoDocTypeNotationEntityAncestor(node,allowSelf){if(getDocTypeNotationEntityAncestor(node,allowSelf)){throw new RangeException("INVALID_NODE_TYPE_ERR")}}function assertNotDetached(range){if(!range.startContainer){throw new DOMException("INVALID_STATE_ERR")}}function assertValidNodeType(node,invalidTypes){if(!dom.arrayContains(invalidTypes,node.nodeType)){throw new RangeException("INVALID_NODE_TYPE_ERR")}}function assertValidOffset(node,offset){if(offset<0||offset>(dom.isCharacterDataNode(node)?node.length:node.childNodes.length)){throw new DOMException("INDEX_SIZE_ERR")}}function assertSameDocumentOrFragment(node1,node2){if(getDocumentOrFragmentContainer(node1,true)!==getDocumentOrFragmentContainer(node2,true)){throw new DOMException("WRONG_DOCUMENT_ERR")}}function assertNodeNotReadOnly(node){if(getReadonlyAncestor(node,true)){throw new DOMException("NO_MODIFICATION_ALLOWED_ERR")}}function assertNode(node,codeName){if(!node){throw new DOMException(codeName)}}function isOrphan(node){return!dom.arrayContains(rootContainerNodeTypes,node.nodeType)&&!getDocumentOrFragmentContainer(node,true)}function isValidOffset(node,offset){return offset<=(dom.isCharacterDataNode(node)?node.length:node.childNodes.length)}function assertRangeValid(range){assertNotDetached(range);if(isOrphan(range.startContainer)||isOrphan(range.endContainer)||!isValidOffset(range.startContainer,range.startOffset)||!isValidOffset(range.endContainer,range.endOffset)){throw new Error("Range error: Range is no longer valid after DOM mutation ("+range.inspect()+")")}}var styleEl=document.createElement("style");var htmlParsingConforms=false;try{styleEl.innerHTML="<b>x</b>";htmlParsingConforms=styleEl.firstChild.nodeType==3}catch(e){}api.features.htmlParsingConforms=htmlParsingConforms;var createContextualFragment=htmlParsingConforms?function(fragmentStr){var node=this.startContainer;var doc=dom.getDocument(node);if(!node){throw new DOMException("INVALID_STATE_ERR")}var el=null;if(node.nodeType==1){el=node}else if(dom.isCharacterDataNode(node)){el=dom.parentElement(node)}if(el===null||el.nodeName=="HTML"&&dom.isHtmlNamespace(dom.getDocument(el).documentElement)&&dom.isHtmlNamespace(el)){el=doc.createElement("body")}else{el=el.cloneNode(false)}el.innerHTML=fragmentStr;return dom.fragmentFromNodeChildren(el)}:function(fragmentStr){assertNotDetached(this);var doc=getRangeDocument(this);var el=doc.createElement("body");el.innerHTML=fragmentStr;return dom.fragmentFromNodeChildren(el)};var rangeProperties=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"];var s2s=0,s2e=1,e2e=2,e2s=3;var n_b=0,n_a=1,n_b_a=2,n_i=3;function RangePrototype(){}RangePrototype.prototype={attachListener:function(type,listener){this._listeners[type].push(listener)},compareBoundaryPoints:function(how,range){assertRangeValid(this);assertSameDocumentOrFragment(this.startContainer,range.startContainer);var nodeA,offsetA,nodeB,offsetB;var prefixA=how==e2s||how==s2s?"start":"end";var prefixB=how==s2e||how==s2s?"start":"end";nodeA=this[prefixA+"Container"];offsetA=this[prefixA+"Offset"];nodeB=range[prefixB+"Container"];offsetB=range[prefixB+"Offset"];return dom.comparePoints(nodeA,offsetA,nodeB,offsetB)},insertNode:function(node){assertRangeValid(this);assertValidNodeType(node,insertableNodeTypes);assertNodeNotReadOnly(this.startContainer);if(dom.isAncestorOf(node,this.startContainer,true)){throw new DOMException("HIERARCHY_REQUEST_ERR")}var firstNodeInserted=insertNodeAtPosition(node,this.startContainer,this.startOffset);this.setStartBefore(firstNodeInserted)},cloneContents:function(){assertRangeValid(this);var clone,frag;if(this.collapsed){return getRangeDocument(this).createDocumentFragment()}else{if(this.startContainer===this.endContainer&&dom.isCharacterDataNode(this.startContainer)){clone=this.startContainer.cloneNode(true);clone.data=clone.data.slice(this.startOffset,this.endOffset);frag=getRangeDocument(this).createDocumentFragment();frag.appendChild(clone);return frag}else{var iterator=new RangeIterator(this,true);clone=cloneSubtree(iterator);iterator.detach()}return clone}},canSurroundContents:function(){assertRangeValid(this);assertNodeNotReadOnly(this.startContainer);assertNodeNotReadOnly(this.endContainer);var iterator=new RangeIterator(this,true);var boundariesInvalid=iterator._first&&isNonTextPartiallySelected(iterator._first,this)||iterator._last&&isNonTextPartiallySelected(iterator._last,this);iterator.detach();return!boundariesInvalid},surroundContents:function(node){assertValidNodeType(node,surroundNodeTypes);if(!this.canSurroundContents()){throw new RangeException("BAD_BOUNDARYPOINTS_ERR")}var content=this.extractContents();if(node.hasChildNodes()){while(node.lastChild){node.removeChild(node.lastChild)}}insertNodeAtPosition(node,this.startContainer,this.startOffset);node.appendChild(content);this.selectNode(node)},cloneRange:function(){assertRangeValid(this);var range=new Range(getRangeDocument(this));var i=rangeProperties.length,prop;while(i--){prop=rangeProperties[i];range[prop]=this[prop]}return range},toString:function(){assertRangeValid(this);var sc=this.startContainer;if(sc===this.endContainer&&dom.isCharacterDataNode(sc)){return sc.nodeType==3||sc.nodeType==4?sc.data.slice(this.startOffset,this.endOffset):""}else{var textBits=[],iterator=new RangeIterator(this,true);iterateSubtree(iterator,function(node){if(node.nodeType==3||node.nodeType==4){textBits.push(node.data)}});iterator.detach();return textBits.join("")}},compareNode:function(node){assertRangeValid(this);var parent=node.parentNode;var nodeIndex=dom.getNodeIndex(node);if(!parent){throw new DOMException("NOT_FOUND_ERR")}var startComparison=this.comparePoint(parent,nodeIndex),endComparison=this.comparePoint(parent,nodeIndex+1);if(startComparison<0){return endComparison>0?n_b_a:n_b}else{return endComparison>0?n_a:n_i}},comparePoint:function(node,offset){assertRangeValid(this);assertNode(node,"HIERARCHY_REQUEST_ERR");assertSameDocumentOrFragment(node,this.startContainer);if(dom.comparePoints(node,offset,this.startContainer,this.startOffset)<0){return-1}else if(dom.comparePoints(node,offset,this.endContainer,this.endOffset)>0){return 1}return 0},createContextualFragment:createContextualFragment,toHtml:function(){assertRangeValid(this);var container=getRangeDocument(this).createElement("div");container.appendChild(this.cloneContents());return container.innerHTML},intersectsNode:function(node,touchingIsIntersecting){assertRangeValid(this);assertNode(node,"NOT_FOUND_ERR");if(dom.getDocument(node)!==getRangeDocument(this)){return false}var parent=node.parentNode,offset=dom.getNodeIndex(node);assertNode(parent,"NOT_FOUND_ERR");var startComparison=dom.comparePoints(parent,offset,this.endContainer,this.endOffset),endComparison=dom.comparePoints(parent,offset+1,this.startContainer,this.startOffset);return touchingIsIntersecting?startComparison<=0&&endComparison>=0:startComparison<0&&endComparison>0},isPointInRange:function(node,offset){assertRangeValid(this);assertNode(node,"HIERARCHY_REQUEST_ERR");assertSameDocumentOrFragment(node,this.startContainer);return dom.comparePoints(node,offset,this.startContainer,this.startOffset)>=0&&dom.comparePoints(node,offset,this.endContainer,this.endOffset)<=0},intersectsRange:function(range,touchingIsIntersecting){assertRangeValid(this);if(getRangeDocument(range)!=getRangeDocument(this)){throw new DOMException("WRONG_DOCUMENT_ERR")}var startComparison=dom.comparePoints(this.startContainer,this.startOffset,range.endContainer,range.endOffset),endComparison=dom.comparePoints(this.endContainer,this.endOffset,range.startContainer,range.startOffset);return touchingIsIntersecting?startComparison<=0&&endComparison>=0:startComparison<0&&endComparison>0},intersection:function(range){if(this.intersectsRange(range)){var startComparison=dom.comparePoints(this.startContainer,this.startOffset,range.startContainer,range.startOffset),endComparison=dom.comparePoints(this.endContainer,this.endOffset,range.endContainer,range.endOffset);var intersectionRange=this.cloneRange();if(startComparison==-1){intersectionRange.setStart(range.startContainer,range.startOffset)}if(endComparison==1){intersectionRange.setEnd(range.endContainer,range.endOffset)}return intersectionRange}return null},union:function(range){if(this.intersectsRange(range,true)){var unionRange=this.cloneRange();if(dom.comparePoints(range.startContainer,range.startOffset,this.startContainer,this.startOffset)==-1){unionRange.setStart(range.startContainer,range.startOffset)}if(dom.comparePoints(range.endContainer,range.endOffset,this.endContainer,this.endOffset)==1){unionRange.setEnd(range.endContainer,range.endOffset)}return unionRange}else{throw new RangeException("Ranges do not intersect")}},containsNode:function(node,allowPartial){if(allowPartial){return this.intersectsNode(node,false)}else{return this.compareNode(node)==n_i}},containsNodeContents:function(node){return this.comparePoint(node,0)>=0&&this.comparePoint(node,dom.getNodeLength(node))<=0},containsRange:function(range){return this.intersection(range).equals(range)},containsNodeText:function(node){var nodeRange=this.cloneRange();nodeRange.selectNode(node);var textNodes=nodeRange.getNodes([3]);if(textNodes.length>0){nodeRange.setStart(textNodes[0],0);var lastTextNode=textNodes.pop();nodeRange.setEnd(lastTextNode,lastTextNode.length);var contains=this.containsRange(nodeRange);nodeRange.detach();return contains}else{return this.containsNodeContents(node)}},createNodeIterator:function(nodeTypes,filter){assertRangeValid(this);return new RangeNodeIterator(this,nodeTypes,filter)},getNodes:function(nodeTypes,filter){assertRangeValid(this);return getNodesInRange(this,nodeTypes,filter)},getDocument:function(){return getRangeDocument(this)},collapseBefore:function(node){assertNotDetached(this);this.setEndBefore(node);this.collapse(false)},collapseAfter:function(node){assertNotDetached(this);this.setStartAfter(node);this.collapse(true)},getName:function(){return"DomRange"},equals:function(range){return Range.rangesEqual(this,range)},inspect:function(){return inspect(this)}};function copyComparisonConstantsToObject(obj){obj.START_TO_START=s2s;obj.START_TO_END=s2e;obj.END_TO_END=e2e;obj.END_TO_START=e2s;obj.NODE_BEFORE=n_b;obj.NODE_AFTER=n_a;obj.NODE_BEFORE_AND_AFTER=n_b_a;obj.NODE_INSIDE=n_i}function copyComparisonConstants(constructor){copyComparisonConstantsToObject(constructor);copyComparisonConstantsToObject(constructor.prototype)}function createRangeContentRemover(remover,boundaryUpdater){return function(){assertRangeValid(this);var sc=this.startContainer,so=this.startOffset,root=this.commonAncestorContainer;var iterator=new RangeIterator(this,true);var node,boundary;if(sc!==root){node=dom.getClosestAncestorIn(sc,root,true);boundary=getBoundaryAfterNode(node);sc=boundary.node;so=boundary.offset}iterateSubtree(iterator,assertNodeNotReadOnly);iterator.reset();var returnValue=remover(iterator);iterator.detach();boundaryUpdater(this,sc,so,sc,so);return returnValue}}function createPrototypeRange(constructor,boundaryUpdater,detacher){function createBeforeAfterNodeSetter(isBefore,isStart){return function(node){assertNotDetached(this);assertValidNodeType(node,beforeAfterNodeTypes);assertValidNodeType(getRootContainer(node),rootContainerNodeTypes);var boundary=(isBefore?getBoundaryBeforeNode:getBoundaryAfterNode)(node);(isStart?setRangeStart:setRangeEnd)(this,boundary.node,boundary.offset)}}function setRangeStart(range,node,offset){var ec=range.endContainer,eo=range.endOffset;if(node!==range.startContainer||offset!==range.startOffset){if(getRootContainer(node)!=getRootContainer(ec)||dom.comparePoints(node,offset,ec,eo)==1){ec=node;eo=offset}boundaryUpdater(range,node,offset,ec,eo)}}function setRangeEnd(range,node,offset){var sc=range.startContainer,so=range.startOffset;if(node!==range.endContainer||offset!==range.endOffset){if(getRootContainer(node)!=getRootContainer(sc)||dom.comparePoints(node,offset,sc,so)==-1){sc=node;so=offset}boundaryUpdater(range,sc,so,node,offset)}}function setRangeStartAndEnd(range,node,offset){if(node!==range.startContainer||offset!==range.startOffset||node!==range.endContainer||offset!==range.endOffset){boundaryUpdater(range,node,offset,node,offset)}}constructor.prototype=new RangePrototype;api.util.extend(constructor.prototype,{setStart:function(node,offset){assertNotDetached(this);assertNoDocTypeNotationEntityAncestor(node,true);assertValidOffset(node,offset);setRangeStart(this,node,offset)},setEnd:function(node,offset){assertNotDetached(this);assertNoDocTypeNotationEntityAncestor(node,true);assertValidOffset(node,offset);setRangeEnd(this,node,offset)},setStartBefore:createBeforeAfterNodeSetter(true,true),setStartAfter:createBeforeAfterNodeSetter(false,true),setEndBefore:createBeforeAfterNodeSetter(true,false),setEndAfter:createBeforeAfterNodeSetter(false,false),collapse:function(isStart){assertRangeValid(this);if(isStart){boundaryUpdater(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset)}else{boundaryUpdater(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)}},selectNodeContents:function(node){assertNotDetached(this);assertNoDocTypeNotationEntityAncestor(node,true);boundaryUpdater(this,node,0,node,dom.getNodeLength(node))},selectNode:function(node){assertNotDetached(this);assertNoDocTypeNotationEntityAncestor(node,false);assertValidNodeType(node,beforeAfterNodeTypes);var start=getBoundaryBeforeNode(node),end=getBoundaryAfterNode(node);boundaryUpdater(this,start.node,start.offset,end.node,end.offset)},extractContents:createRangeContentRemover(extractSubtree,boundaryUpdater),deleteContents:createRangeContentRemover(deleteSubtree,boundaryUpdater),canSurroundContents:function(){assertRangeValid(this);assertNodeNotReadOnly(this.startContainer);assertNodeNotReadOnly(this.endContainer);var iterator=new RangeIterator(this,true);var boundariesInvalid=iterator._first&&isNonTextPartiallySelected(iterator._first,this)||iterator._last&&isNonTextPartiallySelected(iterator._last,this);iterator.detach();return!boundariesInvalid},detach:function(){detacher(this)},splitBoundaries:function(){assertRangeValid(this);var sc=this.startContainer,so=this.startOffset,ec=this.endContainer,eo=this.endOffset;var startEndSame=sc===ec;if(dom.isCharacterDataNode(ec)&&eo>0&&eo<ec.length){dom.splitDataNode(ec,eo)}if(dom.isCharacterDataNode(sc)&&so>0&&so<sc.length){sc=dom.splitDataNode(sc,so);if(startEndSame){eo-=so;ec=sc}else if(ec==sc.parentNode&&eo>=dom.getNodeIndex(sc)){eo++}so=0}boundaryUpdater(this,sc,so,ec,eo)},normalizeBoundaries:function(){assertRangeValid(this);var sc=this.startContainer,so=this.startOffset,ec=this.endContainer,eo=this.endOffset;var mergeForward=function(node){var sibling=node.nextSibling;if(sibling&&sibling.nodeType==node.nodeType){ec=node;eo=node.length;node.appendData(sibling.data);sibling.parentNode.removeChild(sibling)}};var mergeBackward=function(node){var sibling=node.previousSibling;if(sibling&&sibling.nodeType==node.nodeType){sc=node;var nodeLength=node.length;so=sibling.length;node.insertData(0,sibling.data);sibling.parentNode.removeChild(sibling);if(sc==ec){eo+=so;ec=sc}else if(ec==node.parentNode){var nodeIndex=dom.getNodeIndex(node);if(eo==nodeIndex){ec=node;eo=nodeLength}else if(eo>nodeIndex){eo--}}}};var normalizeStart=true;if(dom.isCharacterDataNode(ec)){if(ec.length==eo){mergeForward(ec)}}else{if(eo>0){var endNode=ec.childNodes[eo-1];if(endNode&&dom.isCharacterDataNode(endNode)){mergeForward(endNode)}}normalizeStart=!this.collapsed}if(normalizeStart){if(dom.isCharacterDataNode(sc)){if(so==0){mergeBackward(sc)}}else{if(so<sc.childNodes.length){var startNode=sc.childNodes[so];if(startNode&&dom.isCharacterDataNode(startNode)){mergeBackward(startNode)}}}}else{sc=ec;so=eo}boundaryUpdater(this,sc,so,ec,eo)},collapseToPoint:function(node,offset){assertNotDetached(this);assertNoDocTypeNotationEntityAncestor(node,true);assertValidOffset(node,offset);setRangeStartAndEnd(this,node,offset)}});copyComparisonConstants(constructor)}function updateCollapsedAndCommonAncestor(range){range.collapsed=range.startContainer===range.endContainer&&range.startOffset===range.endOffset;range.commonAncestorContainer=range.collapsed?range.startContainer:dom.getCommonAncestor(range.startContainer,range.endContainer)}function updateBoundaries(range,startContainer,startOffset,endContainer,endOffset){var startMoved=range.startContainer!==startContainer||range.startOffset!==startOffset;var endMoved=range.endContainer!==endContainer||range.endOffset!==endOffset;range.startContainer=startContainer;range.startOffset=startOffset;range.endContainer=endContainer;range.endOffset=endOffset;updateCollapsedAndCommonAncestor(range);dispatchEvent(range,"boundarychange",{startMoved:startMoved,endMoved:endMoved})}function detach(range){assertNotDetached(range);range.startContainer=range.startOffset=range.endContainer=range.endOffset=null;range.collapsed=range.commonAncestorContainer=null;dispatchEvent(range,"detach",null);range._listeners=null}function Range(doc){this.startContainer=doc;this.startOffset=0;this.endContainer=doc;this.endOffset=0;this._listeners={boundarychange:[],detach:[]};updateCollapsedAndCommonAncestor(this)}createPrototypeRange(Range,updateBoundaries,detach);api.rangePrototype=RangePrototype.prototype;Range.rangeProperties=rangeProperties;Range.RangeIterator=RangeIterator;Range.copyComparisonConstants=copyComparisonConstants;Range.createPrototypeRange=createPrototypeRange;Range.inspect=inspect;Range.getRangeDocument=getRangeDocument;Range.rangesEqual=function(r1,r2){return r1.startContainer===r2.startContainer&&r1.startOffset===r2.startOffset&&r1.endContainer===r2.endContainer&&r1.endOffset===r2.endOffset};api.DomRange=Range;api.RangeException=RangeException});rangy.createModule("WrappedRange",function(api,module){api.requireModules(["DomUtil","DomRange"]);var WrappedRange;var dom=api.dom;var DomPosition=dom.DomPosition;var DomRange=api.DomRange;function getTextRangeContainerElement(textRange){var parentEl=textRange.parentElement();var range=textRange.duplicate();range.collapse(true);var startEl=range.parentElement();range=textRange.duplicate();range.collapse(false);var endEl=range.parentElement();var startEndContainer=startEl==endEl?startEl:dom.getCommonAncestor(startEl,endEl);return startEndContainer==parentEl?startEndContainer:dom.getCommonAncestor(parentEl,startEndContainer)}function textRangeIsCollapsed(textRange){return textRange.compareEndPoints("StartToEnd",textRange)==0}function getTextRangeBoundaryPosition(textRange,wholeRangeContainerElement,isStart,isCollapsed){var workingRange=textRange.duplicate();workingRange.collapse(isStart);var containerElement=workingRange.parentElement();if(!dom.isAncestorOf(wholeRangeContainerElement,containerElement,true)){containerElement=wholeRangeContainerElement}if(!containerElement.canHaveHTML){return new DomPosition(containerElement.parentNode,dom.getNodeIndex(containerElement))}var workingNode=dom.getDocument(containerElement).createElement("span");var comparison,workingComparisonType=isStart?"StartToStart":"StartToEnd";var previousNode,nextNode,boundaryPosition,boundaryNode;do{containerElement.insertBefore(workingNode,workingNode.previousSibling);workingRange.moveToElementText(workingNode)}while((comparison=workingRange.compareEndPoints(workingComparisonType,textRange))>0&&workingNode.previousSibling);boundaryNode=workingNode.nextSibling;if(comparison==-1&&boundaryNode&&dom.isCharacterDataNode(boundaryNode)){workingRange.setEndPoint(isStart?"EndToStart":"EndToEnd",textRange);var offset;if(/[\r\n]/.test(boundaryNode.data)){var tempRange=workingRange.duplicate();var rangeLength=tempRange.text.replace(/\r\n/g,"\r").length;offset=tempRange.moveStart("character",rangeLength);while((comparison=tempRange.compareEndPoints("StartToEnd",tempRange))==-1){offset++;tempRange.moveStart("character",1)}}else{offset=workingRange.text.length}boundaryPosition=new DomPosition(boundaryNode,offset)}else{previousNode=(isCollapsed||!isStart)&&workingNode.previousSibling;nextNode=(isCollapsed||isStart)&&workingNode.nextSibling;if(nextNode&&dom.isCharacterDataNode(nextNode)){boundaryPosition=new DomPosition(nextNode,0)}else if(previousNode&&dom.isCharacterDataNode(previousNode)){boundaryPosition=new DomPosition(previousNode,previousNode.length)}else{boundaryPosition=new DomPosition(containerElement,dom.getNodeIndex(workingNode))}}workingNode.parentNode.removeChild(workingNode);return boundaryPosition}function createBoundaryTextRange(boundaryPosition,isStart){var boundaryNode,boundaryParent,boundaryOffset=boundaryPosition.offset;var doc=dom.getDocument(boundaryPosition.node);var workingNode,childNodes,workingRange=doc.body.createTextRange();var nodeIsDataNode=dom.isCharacterDataNode(boundaryPosition.node);if(nodeIsDataNode){boundaryNode=boundaryPosition.node;boundaryParent=boundaryNode.parentNode}else{childNodes=boundaryPosition.node.childNodes;boundaryNode=boundaryOffset<childNodes.length?childNodes[boundaryOffset]:null;boundaryParent=boundaryPosition.node}workingNode=doc.createElement("span");workingNode.innerHTML="&#feff;";if(boundaryNode){boundaryParent.insertBefore(workingNode,boundaryNode)}else{boundaryParent.appendChild(workingNode)}workingRange.moveToElementText(workingNode);workingRange.collapse(!isStart);boundaryParent.removeChild(workingNode);if(nodeIsDataNode){workingRange[isStart?"moveStart":"moveEnd"]("character",boundaryOffset)}return workingRange}if(api.features.implementsDomRange&&(!api.features.implementsTextRange||!api.config.preferTextRange)){(function(){var rangeProto;var rangeProperties=DomRange.rangeProperties;var canSetRangeStartAfterEnd;function updateRangeProperties(range){var i=rangeProperties.length,prop;while(i--){prop=rangeProperties[i];range[prop]=range.nativeRange[prop]}}function updateNativeRange(range,startContainer,startOffset,endContainer,endOffset){var startMoved=range.startContainer!==startContainer||range.startOffset!=startOffset;var endMoved=range.endContainer!==endContainer||range.endOffset!=endOffset;if(startMoved||endMoved){range.setEnd(endContainer,endOffset);range.setStart(startContainer,startOffset)}}function detach(range){range.nativeRange.detach();range.detached=true;var i=rangeProperties.length,prop;while(i--){prop=rangeProperties[i];range[prop]=null}}var createBeforeAfterNodeSetter;WrappedRange=function(range){if(!range){throw new Error("Range must be specified")}this.nativeRange=range;updateRangeProperties(this)};DomRange.createPrototypeRange(WrappedRange,updateNativeRange,detach);rangeProto=WrappedRange.prototype;rangeProto.selectNode=function(node){this.nativeRange.selectNode(node);updateRangeProperties(this)};rangeProto.deleteContents=function(){this.nativeRange.deleteContents();updateRangeProperties(this)};rangeProto.extractContents=function(){var frag=this.nativeRange.extractContents();updateRangeProperties(this);return frag};rangeProto.cloneContents=function(){return this.nativeRange.cloneContents()};rangeProto.surroundContents=function(node){this.nativeRange.surroundContents(node);updateRangeProperties(this)};rangeProto.collapse=function(isStart){this.nativeRange.collapse(isStart);updateRangeProperties(this)};rangeProto.cloneRange=function(){return new WrappedRange(this.nativeRange.cloneRange())};rangeProto.refresh=function(){updateRangeProperties(this)};rangeProto.toString=function(){return this.nativeRange.toString()};var testTextNode=document.createTextNode("test");dom.getBody(document).appendChild(testTextNode);var range=document.createRange();range.setStart(testTextNode,0);range.setEnd(testTextNode,0);try{range.setStart(testTextNode,1);canSetRangeStartAfterEnd=true;rangeProto.setStart=function(node,offset){this.nativeRange.setStart(node,offset);updateRangeProperties(this)};rangeProto.setEnd=function(node,offset){this.nativeRange.setEnd(node,offset);updateRangeProperties(this)};createBeforeAfterNodeSetter=function(name){return function(node){this.nativeRange[name](node);updateRangeProperties(this)}}}catch(ex){canSetRangeStartAfterEnd=false;rangeProto.setStart=function(node,offset){try{this.nativeRange.setStart(node,offset)}catch(ex){this.nativeRange.setEnd(node,offset);this.nativeRange.setStart(node,offset)}updateRangeProperties(this)};rangeProto.setEnd=function(node,offset){try{this.nativeRange.setEnd(node,offset)}catch(ex){this.nativeRange.setStart(node,offset);this.nativeRange.setEnd(node,offset)}updateRangeProperties(this)};createBeforeAfterNodeSetter=function(name,oppositeName){return function(node){try{this.nativeRange[name](node)}catch(ex){this.nativeRange[oppositeName](node);this.nativeRange[name](node)}updateRangeProperties(this)}}}rangeProto.setStartBefore=createBeforeAfterNodeSetter("setStartBefore","setEndBefore");rangeProto.setStartAfter=createBeforeAfterNodeSetter("setStartAfter","setEndAfter");rangeProto.setEndBefore=createBeforeAfterNodeSetter("setEndBefore","setStartBefore");rangeProto.setEndAfter=createBeforeAfterNodeSetter("setEndAfter","setStartAfter");range.selectNodeContents(testTextNode);if(range.startContainer==testTextNode&&range.endContainer==testTextNode&&range.startOffset==0&&range.endOffset==testTextNode.length){rangeProto.selectNodeContents=function(node){this.nativeRange.selectNodeContents(node);updateRangeProperties(this)}}else{rangeProto.selectNodeContents=function(node){this.setStart(node,0);this.setEnd(node,DomRange.getEndOffset(node))}}range.selectNodeContents(testTextNode);range.setEnd(testTextNode,3);var range2=document.createRange();range2.selectNodeContents(testTextNode);range2.setEnd(testTextNode,4);range2.setStart(testTextNode,2);if(range.compareBoundaryPoints(range.START_TO_END,range2)==-1&range.compareBoundaryPoints(range.END_TO_START,range2)==1){rangeProto.compareBoundaryPoints=function(type,range){range=range.nativeRange||range;if(type==range.START_TO_END){type=range.END_TO_START}else if(type==range.END_TO_START){type=range.START_TO_END}return this.nativeRange.compareBoundaryPoints(type,range)}}else{rangeProto.compareBoundaryPoints=function(type,range){return this.nativeRange.compareBoundaryPoints(type,range.nativeRange||range)}}if(api.util.isHostMethod(range,"createContextualFragment")){rangeProto.createContextualFragment=function(fragmentStr){return this.nativeRange.createContextualFragment(fragmentStr)}}dom.getBody(document).removeChild(testTextNode);range.detach();range2.detach()})();api.createNativeRange=function(doc){doc=doc||document;return doc.createRange()}}else if(api.features.implementsTextRange){WrappedRange=function(textRange){this.textRange=textRange;this.refresh()};WrappedRange.prototype=new DomRange(document);WrappedRange.prototype.refresh=function(){var start,end;var rangeContainerElement=getTextRangeContainerElement(this.textRange);if(textRangeIsCollapsed(this.textRange)){end=start=getTextRangeBoundaryPosition(this.textRange,rangeContainerElement,true,true)}else{start=getTextRangeBoundaryPosition(this.textRange,rangeContainerElement,true,false);end=getTextRangeBoundaryPosition(this.textRange,rangeContainerElement,false,false)}this.setStart(start.node,start.offset);this.setEnd(end.node,end.offset)};DomRange.copyComparisonConstants(WrappedRange);var globalObj=function(){return this}();if(typeof globalObj.Range=="undefined"){globalObj.Range=WrappedRange}api.createNativeRange=function(doc){doc=doc||document;return doc.body.createTextRange()}}if(api.features.implementsTextRange){WrappedRange.rangeToTextRange=function(range){if(range.collapsed){var tr=createBoundaryTextRange(new DomPosition(range.startContainer,range.startOffset),true);return tr}else{var startRange=createBoundaryTextRange(new DomPosition(range.startContainer,range.startOffset),true);var endRange=createBoundaryTextRange(new DomPosition(range.endContainer,range.endOffset),false);var textRange=dom.getDocument(range.startContainer).body.createTextRange();textRange.setEndPoint("StartToStart",startRange);textRange.setEndPoint("EndToEnd",endRange);return textRange}}}WrappedRange.prototype.getName=function(){return"WrappedRange"};api.WrappedRange=WrappedRange;api.createRange=function(doc){doc=doc||document;return new WrappedRange(api.createNativeRange(doc))};api.createRangyRange=function(doc){doc=doc||document;return new DomRange(doc)};api.createIframeRange=function(iframeEl){return api.createRange(dom.getIframeDocument(iframeEl))};api.createIframeRangyRange=function(iframeEl){return api.createRangyRange(dom.getIframeDocument(iframeEl))};api.addCreateMissingNativeApiListener(function(win){var doc=win.document;if(typeof doc.createRange=="undefined"){doc.createRange=function(){return api.createRange(this)}}doc=win=null})});rangy.createModule("WrappedSelection",function(api,module){api.requireModules(["DomUtil","DomRange","WrappedRange"]);api.config.checkSelectionRanges=true;var BOOLEAN="boolean",windowPropertyName="_rangySelection",dom=api.dom,util=api.util,DomRange=api.DomRange,WrappedRange=api.WrappedRange,DOMException=api.DOMException,DomPosition=dom.DomPosition,getSelection,selectionIsCollapsed,CONTROL="Control";function getWinSelection(winParam){return(winParam||window).getSelection()}function getDocSelection(winParam){return(winParam||window).document.selection}var implementsWinGetSelection=api.util.isHostMethod(window,"getSelection"),implementsDocSelection=api.util.isHostObject(document,"selection");var useDocumentSelection=implementsDocSelection&&(!implementsWinGetSelection||api.config.preferTextRange);if(useDocumentSelection){getSelection=getDocSelection;api.isSelectionValid=function(winParam){var doc=(winParam||window).document,nativeSel=doc.selection;return nativeSel.type!="None"||dom.getDocument(nativeSel.createRange().parentElement())==doc}}else if(implementsWinGetSelection){getSelection=getWinSelection;api.isSelectionValid=function(){return true}}else{module.fail("Neither document.selection or window.getSelection() detected.")}api.getNativeSelection=getSelection;var testSelection=getSelection();var testRange=api.createNativeRange(document);var body=dom.getBody(document);var selectionHasAnchorAndFocus=util.areHostObjects(testSelection,["anchorNode","focusNode"]&&util.areHostProperties(testSelection,["anchorOffset","focusOffset"]));api.features.selectionHasAnchorAndFocus=selectionHasAnchorAndFocus;var selectionHasExtend=util.isHostMethod(testSelection,"extend");api.features.selectionHasExtend=selectionHasExtend;var selectionHasRangeCount=typeof testSelection.rangeCount=="number";api.features.selectionHasRangeCount=selectionHasRangeCount;var selectionSupportsMultipleRanges=false;var collapsedNonEditableSelectionsSupported=true;if(util.areHostMethods(testSelection,["addRange","getRangeAt","removeAllRanges"])&&typeof testSelection.rangeCount=="number"&&api.features.implementsDomRange){(function(){var iframe=document.createElement("iframe");body.appendChild(iframe);var iframeDoc=dom.getIframeDocument(iframe);iframeDoc.open();iframeDoc.write("<html><head></head><body>12</body></html>");iframeDoc.close();var sel=dom.getIframeWindow(iframe).getSelection();var docEl=iframeDoc.documentElement;var iframeBody=docEl.lastChild,textNode=iframeBody.firstChild;var r1=iframeDoc.createRange();r1.setStart(textNode,1);r1.collapse(true);sel.addRange(r1);collapsedNonEditableSelectionsSupported=sel.rangeCount==1;sel.removeAllRanges();var r2=r1.cloneRange();r1.setStart(textNode,0);r2.setEnd(textNode,2);sel.addRange(r1);sel.addRange(r2);selectionSupportsMultipleRanges=sel.rangeCount==2;r1.detach();r2.detach();body.removeChild(iframe)})()}api.features.selectionSupportsMultipleRanges=selectionSupportsMultipleRanges;api.features.collapsedNonEditableSelectionsSupported=collapsedNonEditableSelectionsSupported;var implementsControlRange=false,testControlRange;if(body&&util.isHostMethod(body,"createControlRange")){testControlRange=body.createControlRange();if(util.areHostProperties(testControlRange,["item","add"])){implementsControlRange=true}}api.features.implementsControlRange=implementsControlRange;if(selectionHasAnchorAndFocus){selectionIsCollapsed=function(sel){return sel.anchorNode===sel.focusNode&&sel.anchorOffset===sel.focusOffset}}else{selectionIsCollapsed=function(sel){return sel.rangeCount?sel.getRangeAt(sel.rangeCount-1).collapsed:false}}function updateAnchorAndFocusFromRange(sel,range,backwards){var anchorPrefix=backwards?"end":"start",focusPrefix=backwards?"start":"end";sel.anchorNode=range[anchorPrefix+"Container"];sel.anchorOffset=range[anchorPrefix+"Offset"];sel.focusNode=range[focusPrefix+"Container"];sel.focusOffset=range[focusPrefix+"Offset"]}function updateAnchorAndFocusFromNativeSelection(sel){var nativeSel=sel.nativeSelection;sel.anchorNode=nativeSel.anchorNode;sel.anchorOffset=nativeSel.anchorOffset;sel.focusNode=nativeSel.focusNode;sel.focusOffset=nativeSel.focusOffset}function updateEmptySelection(sel){sel.anchorNode=sel.focusNode=null;sel.anchorOffset=sel.focusOffset=0;sel.rangeCount=0;sel.isCollapsed=true;sel._ranges.length=0}function getNativeRange(range){var nativeRange;if(range instanceof DomRange){nativeRange=range._selectionNativeRange;if(!nativeRange){nativeRange=api.createNativeRange(dom.getDocument(range.startContainer));nativeRange.setEnd(range.endContainer,range.endOffset);nativeRange.setStart(range.startContainer,range.startOffset);range._selectionNativeRange=nativeRange;range.attachListener("detach",function(){this._selectionNativeRange=null})}}else if(range instanceof WrappedRange){nativeRange=range.nativeRange}else if(api.features.implementsDomRange&&range instanceof dom.getWindow(range.startContainer).Range){nativeRange=range}return nativeRange}function rangeContainsSingleElement(rangeNodes){if(!rangeNodes.length||rangeNodes[0].nodeType!=1){return false}for(var i=1,len=rangeNodes.length;i<len;++i){if(!dom.isAncestorOf(rangeNodes[0],rangeNodes[i])){return false}}return true}function getSingleElementFromRange(range){var nodes=range.getNodes();if(!rangeContainsSingleElement(nodes)){throw new Error("getSingleElementFromRange: range "+range.inspect()+" did not consist of a single element")}return nodes[0]}function isTextRange(range){return!!range&&typeof range.text!="undefined"}function updateFromTextRange(sel,range){var wrappedRange=new WrappedRange(range);sel._ranges=[wrappedRange];updateAnchorAndFocusFromRange(sel,wrappedRange,false);sel.rangeCount=1;sel.isCollapsed=wrappedRange.collapsed}function updateControlSelection(sel){sel._ranges.length=0;if(sel.docSelection.type=="None"){updateEmptySelection(sel)}else{var controlRange=sel.docSelection.createRange();if(isTextRange(controlRange)){updateFromTextRange(sel,controlRange)}else{sel.rangeCount=controlRange.length;var range,doc=dom.getDocument(controlRange.item(0));for(var i=0;i<sel.rangeCount;++i){range=api.createRange(doc);range.selectNode(controlRange.item(i));sel._ranges.push(range)}sel.isCollapsed=sel.rangeCount==1&&sel._ranges[0].collapsed;updateAnchorAndFocusFromRange(sel,sel._ranges[sel.rangeCount-1],false)}}}function addRangeToControlSelection(sel,range){var controlRange=sel.docSelection.createRange();var rangeElement=getSingleElementFromRange(range);var doc=dom.getDocument(controlRange.item(0));var newControlRange=dom.getBody(doc).createControlRange();for(var i=0,len=controlRange.length;i<len;++i){newControlRange.add(controlRange.item(i))}try{newControlRange.add(rangeElement)}catch(ex){throw new Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}newControlRange.select();updateControlSelection(sel)}var getSelectionRangeAt;if(util.isHostMethod(testSelection,"getRangeAt")){getSelectionRangeAt=function(sel,index){try{return sel.getRangeAt(index)}catch(ex){return null}}}else if(selectionHasAnchorAndFocus){getSelectionRangeAt=function(sel){var doc=dom.getDocument(sel.anchorNode);var range=api.createRange(doc);range.setStart(sel.anchorNode,sel.anchorOffset);range.setEnd(sel.focusNode,sel.focusOffset);if(range.collapsed!==this.isCollapsed){range.setStart(sel.focusNode,sel.focusOffset);range.setEnd(sel.anchorNode,sel.anchorOffset)}return range}}function WrappedSelection(selection,docSelection,win){this.nativeSelection=selection;this.docSelection=docSelection;this._ranges=[];this.win=win;this.refresh()}api.getSelection=function(win){win=win||window;var sel=win[windowPropertyName];var nativeSel=getSelection(win),docSel=implementsDocSelection?getDocSelection(win):null;if(sel){sel.nativeSelection=nativeSel;sel.docSelection=docSel;sel.refresh(win)}else{sel=new WrappedSelection(nativeSel,docSel,win);win[windowPropertyName]=sel}return sel};api.getIframeSelection=function(iframeEl){return api.getSelection(dom.getIframeWindow(iframeEl))};var selProto=WrappedSelection.prototype;function createControlSelection(sel,ranges){var doc=dom.getDocument(ranges[0].startContainer);var controlRange=dom.getBody(doc).createControlRange();for(var i=0,el;i<rangeCount;++i){el=getSingleElementFromRange(ranges[i]);try{controlRange.add(el)}catch(ex){throw new Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}controlRange.select();updateControlSelection(sel)}if(!useDocumentSelection&&selectionHasAnchorAndFocus&&util.areHostMethods(testSelection,["removeAllRanges","addRange"])){selProto.removeAllRanges=function(){this.nativeSelection.removeAllRanges();updateEmptySelection(this)};var addRangeBackwards=function(sel,range){var doc=DomRange.getRangeDocument(range);var endRange=api.createRange(doc);endRange.collapseToPoint(range.endContainer,range.endOffset);sel.nativeSelection.addRange(getNativeRange(endRange));sel.nativeSelection.extend(range.startContainer,range.startOffset);sel.refresh()};if(selectionHasRangeCount){selProto.addRange=function(range,backwards){if(implementsControlRange&&implementsDocSelection&&this.docSelection.type==CONTROL){addRangeToControlSelection(this,range)}else{if(backwards&&selectionHasExtend){addRangeBackwards(this,range)}else{var previousRangeCount;if(selectionSupportsMultipleRanges){previousRangeCount=this.rangeCount}else{this.removeAllRanges();previousRangeCount=0}this.nativeSelection.addRange(getNativeRange(range));this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==previousRangeCount+1){if(api.config.checkSelectionRanges){var nativeRange=getSelectionRangeAt(this.nativeSelection,this.rangeCount-1);if(nativeRange&&!DomRange.rangesEqual(nativeRange,range)){range=new WrappedRange(nativeRange)}}this._ranges[this.rangeCount-1]=range;updateAnchorAndFocusFromRange(this,range,selectionIsBackwards(this.nativeSelection));this.isCollapsed=selectionIsCollapsed(this)}else{this.refresh()}}}}}else{selProto.addRange=function(range,backwards){if(backwards&&selectionHasExtend){addRangeBackwards(this,range)}else{this.nativeSelection.addRange(getNativeRange(range));this.refresh()}}}selProto.setRanges=function(ranges){if(implementsControlRange&&ranges.length>1){createControlSelection(this,ranges)}else{this.removeAllRanges();for(var i=0,len=ranges.length;i<len;++i){this.addRange(ranges[i])}}}}else if(util.isHostMethod(testSelection,"empty")&&util.isHostMethod(testRange,"select")&&implementsControlRange&&useDocumentSelection){selProto.removeAllRanges=function(){try{this.docSelection.empty();if(this.docSelection.type!="None"){var doc;if(this.anchorNode){doc=dom.getDocument(this.anchorNode)}else if(this.docSelection.type==CONTROL){var controlRange=this.docSelection.createRange();if(controlRange.length){doc=dom.getDocument(controlRange.item(0)).body.createTextRange()}}if(doc){var textRange=doc.body.createTextRange();textRange.select();this.docSelection.empty()}}}catch(ex){}updateEmptySelection(this)};selProto.addRange=function(range){if(this.docSelection.type==CONTROL){addRangeToControlSelection(this,range)}else{WrappedRange.rangeToTextRange(range).select();this._ranges[0]=range;this.rangeCount=1;this.isCollapsed=this._ranges[0].collapsed;updateAnchorAndFocusFromRange(this,range,false)}};selProto.setRanges=function(ranges){this.removeAllRanges();var rangeCount=ranges.length;if(rangeCount>1){createControlSelection(this,ranges)}else if(rangeCount){this.addRange(ranges[0])}}}else{module.fail("No means of selecting a Range or TextRange was found");return false}selProto.getRangeAt=function(index){if(index<0||index>=this.rangeCount){throw new DOMException("INDEX_SIZE_ERR")}else{return this._ranges[index]}};var refreshSelection;if(useDocumentSelection){refreshSelection=function(sel){var range;if(api.isSelectionValid(sel.win)){range=sel.docSelection.createRange()}else{range=dom.getBody(sel.win.document).createTextRange();range.collapse(true)}if(sel.docSelection.type==CONTROL){updateControlSelection(sel)}else if(isTextRange(range)){updateFromTextRange(sel,range)}else{updateEmptySelection(sel)}}}else if(util.isHostMethod(testSelection,"getRangeAt")&&typeof testSelection.rangeCount=="number"){refreshSelection=function(sel){if(implementsControlRange&&implementsDocSelection&&sel.docSelection.type==CONTROL){updateControlSelection(sel)}else{sel._ranges.length=sel.rangeCount=sel.nativeSelection.rangeCount;if(sel.rangeCount){for(var i=0,len=sel.rangeCount;i<len;++i){sel._ranges[i]=new api.WrappedRange(sel.nativeSelection.getRangeAt(i))}updateAnchorAndFocusFromRange(sel,sel._ranges[sel.rangeCount-1],selectionIsBackwards(sel.nativeSelection));sel.isCollapsed=selectionIsCollapsed(sel)}else{updateEmptySelection(sel)}}}}else if(selectionHasAnchorAndFocus&&typeof testSelection.isCollapsed==BOOLEAN&&typeof testRange.collapsed==BOOLEAN&&api.features.implementsDomRange){refreshSelection=function(sel){var range,nativeSel=sel.nativeSelection;if(nativeSel.anchorNode){range=getSelectionRangeAt(nativeSel,0);sel._ranges=[range];sel.rangeCount=1;updateAnchorAndFocusFromNativeSelection(sel);sel.isCollapsed=selectionIsCollapsed(sel)}else{updateEmptySelection(sel)}}}else{module.fail("No means of obtaining a Range or TextRange from the user's selection was found");return false}selProto.refresh=function(checkForChanges){var oldRanges=checkForChanges?this._ranges.slice(0):null;refreshSelection(this);if(checkForChanges){var i=oldRanges.length;if(i!=this._ranges.length){return false}while(i--){if(!DomRange.rangesEqual(oldRanges[i],this._ranges[i])){return false}}return true}};var removeRangeManually=function(sel,range){var ranges=sel.getAllRanges(),removed=false;sel.removeAllRanges();for(var i=0,len=ranges.length;i<len;++i){if(removed||range!==ranges[i]){sel.addRange(ranges[i])}else{removed=true}}if(!sel.rangeCount){updateEmptySelection(sel)}};if(implementsControlRange){selProto.removeRange=function(range){if(this.docSelection.type==CONTROL){var controlRange=this.docSelection.createRange();var rangeElement=getSingleElementFromRange(range);var doc=dom.getDocument(controlRange.item(0));var newControlRange=dom.getBody(doc).createControlRange();var el,removed=false;for(var i=0,len=controlRange.length;i<len;++i){el=controlRange.item(i);if(el!==rangeElement||removed){newControlRange.add(controlRange.item(i))}else{removed=true}}newControlRange.select();updateControlSelection(this)}else{removeRangeManually(this,range)}}}else{selProto.removeRange=function(range){removeRangeManually(this,range)}}var selectionIsBackwards;if(!useDocumentSelection&&selectionHasAnchorAndFocus&&api.features.implementsDomRange){selectionIsBackwards=function(sel){var backwards=false;if(sel.anchorNode){backwards=dom.comparePoints(sel.anchorNode,sel.anchorOffset,sel.focusNode,sel.focusOffset)==1}return backwards};selProto.isBackwards=function(){return selectionIsBackwards(this)}}else{selectionIsBackwards=selProto.isBackwards=function(){return false}}selProto.toString=function(){var rangeTexts=[];for(var i=0,len=this.rangeCount;i<len;++i){rangeTexts[i]=""+this._ranges[i]}return rangeTexts.join("")};function assertNodeInSameDocument(sel,node){if(sel.anchorNode&&dom.getDocument(sel.anchorNode)!==dom.getDocument(node)){throw new DOMException("WRONG_DOCUMENT_ERR")}}selProto.collapse=function(node,offset){assertNodeInSameDocument(this,node);var range=api.createRange(dom.getDocument(node));range.collapseToPoint(node,offset);this.removeAllRanges();this.addRange(range);this.isCollapsed=true};selProto.collapseToStart=function(){if(this.rangeCount){var range=this._ranges[0];this.collapse(range.startContainer,range.startOffset)}else{throw new DOMException("INVALID_STATE_ERR")}};selProto.collapseToEnd=function(){if(this.rangeCount){var range=this._ranges[this.rangeCount-1];this.collapse(range.endContainer,range.endOffset)}else{throw new DOMException("INVALID_STATE_ERR")}};selProto.selectAllChildren=function(node){assertNodeInSameDocument(this,node);var range=api.createRange(dom.getDocument(node));range.selectNodeContents(node);this.removeAllRanges();this.addRange(range)};selProto.deleteFromDocument=function(){if(implementsControlRange&&implementsDocSelection&&this.docSelection.type==CONTROL){var controlRange=this.docSelection.createRange();var element;while(controlRange.length){element=controlRange.item(0);controlRange.remove(element);element.parentNode.removeChild(element)}this.refresh()}else if(this.rangeCount){var ranges=this.getAllRanges();this.removeAllRanges();for(var i=0,len=ranges.length;i<len;++i){ranges[i].deleteContents()}this.addRange(ranges[len-1])}};selProto.getAllRanges=function(){return this._ranges.slice(0)};selProto.setSingleRange=function(range){this.setRanges([range])};selProto.containsNode=function(node,allowPartial){for(var i=0,len=this._ranges.length;i<len;++i){if(this._ranges[i].containsNode(node,allowPartial)){return true}}return false};selProto.toHtml=function(){var html="";if(this.rangeCount){var container=DomRange.getRangeDocument(this._ranges[0]).createElement("div");for(var i=0,len=this._ranges.length;i<len;++i){container.appendChild(this._ranges[i].cloneContents())}html=container.innerHTML}return html};function inspect(sel){var rangeInspects=[];var anchor=new DomPosition(sel.anchorNode,sel.anchorOffset);var focus=new DomPosition(sel.focusNode,sel.focusOffset);var name=typeof sel.getName=="function"?sel.getName():"Selection";if(typeof sel.rangeCount!="undefined"){for(var i=0,len=sel.rangeCount;i<len;++i){rangeInspects[i]=DomRange.inspect(sel.getRangeAt(i))}}return"["+name+"(Ranges: "+rangeInspects.join(", ")+")(anchor: "+anchor.inspect()+", focus: "+focus.inspect()+"]"}selProto.getName=function(){return"WrappedSelection"};selProto.inspect=function(){return inspect(this)};selProto.detach=function(){this.win[windowPropertyName]=null;this.win=this.anchorNode=this.focusNode=null};WrappedSelection.inspect=inspect;api.Selection=WrappedSelection;api.selectionPrototype=selProto;api.addCreateMissingNativeApiListener(function(win){if(typeof win.getSelection=="undefined"){win.getSelection=function(){return api.getSelection(this)}}win=null})});rangy.createModule("SaveRestore",function(api,module){api.requireModules(["DomUtil","DomRange","WrappedRange"]);var dom=api.dom;var markerTextChar="\ufeff";function gEBI(id,doc){return(doc||document).getElementById(id)}function insertRangeBoundaryMarker(range,atStart){var markerId="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2);var markerEl;var doc=dom.getDocument(range.startContainer);var boundaryRange=range.cloneRange();boundaryRange.collapse(atStart);markerEl=doc.createElement("span");markerEl.id=markerId;markerEl.style.lineHeight="0";markerEl.style.display="none";markerEl.className="rangySelectionBoundary";markerEl.appendChild(doc.createTextNode(markerTextChar));boundaryRange.insertNode(markerEl);boundaryRange.detach();return markerEl}function setRangeBoundary(doc,range,markerId,atStart){var markerEl=gEBI(markerId,doc);if(markerEl){range[atStart?"setStartBefore":"setEndBefore"](markerEl);markerEl.parentNode.removeChild(markerEl)}else{module.warn("Marker element has been removed. Cannot restore selection.")}}function compareRanges(r1,r2){return r2.compareBoundaryPoints(r1.START_TO_START,r1)}function saveSelection(win){win=win||window;var doc=win.document;if(!api.isSelectionValid(win)){module.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus.");return}var sel=api.getSelection(win);var ranges=sel.getAllRanges();var rangeInfos=[],startEl,endEl,range;ranges.sort(compareRanges);for(var i=0,len=ranges.length;i<len;++i){range=ranges[i];if(range.collapsed){endEl=insertRangeBoundaryMarker(range,false);rangeInfos.push({markerId:endEl.id,collapsed:true})}else{endEl=insertRangeBoundaryMarker(range,false);startEl=insertRangeBoundaryMarker(range,true);rangeInfos[i]={startMarkerId:startEl.id,endMarkerId:endEl.id,collapsed:false,backwards:ranges.length==1&&sel.isBackwards()}}}for(i=len-1;i>=0;--i){range=ranges[i];if(range.collapsed){range.collapseBefore(gEBI(rangeInfos[i].markerId,doc))}else{range.setEndBefore(gEBI(rangeInfos[i].endMarkerId,doc));range.setStartAfter(gEBI(rangeInfos[i].startMarkerId,doc))}}sel.setRanges(ranges);return{win:win,doc:doc,rangeInfos:rangeInfos,restored:false}}function restoreSelection(savedSelection,preserveDirection){if(!savedSelection.restored){var rangeInfos=savedSelection.rangeInfos;var sel=api.getSelection(savedSelection.win);var ranges=[];for(var len=rangeInfos.length,i=len-1,rangeInfo,range;i>=0;--i){rangeInfo=rangeInfos[i];range=api.createRange(savedSelection.doc);if(rangeInfo.collapsed){var markerEl=gEBI(rangeInfo.markerId,savedSelection.doc);if(markerEl){markerEl.style.display="inline";var previousNode=markerEl.previousSibling;if(previousNode&&previousNode.nodeType==3){markerEl.parentNode.removeChild(markerEl);range.collapseToPoint(previousNode,previousNode.length)}else{range.collapseBefore(markerEl);markerEl.parentNode.removeChild(markerEl)}}else{module.warn("Marker element has been removed. Cannot restore selection.")}}else{setRangeBoundary(savedSelection.doc,range,rangeInfo.startMarkerId,true);setRangeBoundary(savedSelection.doc,range,rangeInfo.endMarkerId,false)}if(len==1){range.normalizeBoundaries()}ranges[i]=range}if(len==1&&preserveDirection&&api.features.selectionHasExtend&&rangeInfos[0].backwards){sel.removeAllRanges();sel.addRange(ranges[0],true)}else{sel.setRanges(ranges)}savedSelection.restored=true}}function removeMarkerElement(doc,markerId){var markerEl=gEBI(markerId,doc);if(markerEl){markerEl.parentNode.removeChild(markerEl)}}function removeMarkers(savedSelection){var rangeInfos=savedSelection.rangeInfos;for(var i=0,len=rangeInfos.length,rangeInfo;i<len;++i){rangeInfo=rangeInfos[i];if(rangeInfo.collapsed){removeMarkerElement(savedSelection.doc,rangeInfo.markerId)}else{removeMarkerElement(savedSelection.doc,rangeInfo.startMarkerId);removeMarkerElement(savedSelection.doc,rangeInfo.endMarkerId)}}}api.saveSelection=saveSelection;api.restoreSelection=restoreSelection;api.removeMarkerElement=removeMarkerElement;api.removeMarkers=removeMarkers});"use strict";WYMeditor.SKINS.compact={init:function(wym){jQuery(wym._options.containersSelector+", "+wym._options.classesSelector,wym._box).appendTo(jQuery("div.wym_area_top",wym._box)).addClass("wym_dropdown").css({"margin-right":"10px",width:"120px",float:"left"});jQuery(wym._options.toolsSelector,wym._box).addClass("wym_buttons").css({"margin-right":"10px",float:"left"});jQuery(".wym_section",wym._box).hover(function(){jQuery(this).addClass("hover")},function(){jQuery(this).removeClass("hover")});var postInit=wym._options.postInit;wym._options.postInit=function(wym){if(postInit){postInit.call(wym,wym)}wym.$body().css("background-color","#f0f0f0")}}};"use strict";WYMeditor.SKINS["default"]={init:function(wym){jQuery(wym._box).find(wym._options.classesSelector).addClass("wym_panel");jQuery(wym._box).find(wym._options.toolsSelector).addClass("wym_buttons");jQuery(wym._box).find(wym._options.containersSelector).addClass("wym_dropdown").find(WYMeditor.H2).append("<span> ></span>");jQuery(wym._box).find("div.wym_area_right ul").parents("div.wym_area_right").show().parents(wym._options.boxSelector).find("div.wym_area_main").css({"margin-right":"155px"});jQuery(wym._box).find("div.wym_area_left ul").parents("div.wym_area_left").show().parents(wym._options.boxSelector).find("div.wym_area_main").css({"margin-left":"155px"});jQuery(wym._box).find(".wym_section").hover(function(){jQuery(this).addClass("hover")},function(){jQuery(this).removeClass("hover")})}};"use strict";WYMeditor.SKINS.legacy={init:function(wym){jQuery(wym._box).find(wym._options.classesSelector).addClass("wym_panel");jQuery(wym._box).find(wym._options.toolsSelector).addClass("wym_buttons");jQuery(wym._box).find(wym._options.containersSelector).addClass("wym_dropdown").find(WYMeditor.H2).append("<span> ></span>");jQuery(wym._box).find("div.wym_area_right ul").parents("div.wym_area_right").show().parents(wym._options.boxSelector).find("div.wym_area_main").css({"margin-right":"155px"});jQuery(wym._box).find("div.wym_area_left ul").parents("div.wym_area_left").show().parents(wym._options.boxSelector).find("div.wym_area_main").css({"margin-left":"155px"});jQuery(wym._box).find(".wym_section").hover(function(){jQuery(this).addClass("hover")},function(){jQuery(this).removeClass("hover")})}};jQuery.fn.selectify=function(){var $elements=this;return $elements.each(function(){var element=this;jQuery(element).hover(function(){var element=this;jQuery("h2",element).css("background-position","0px -18px");jQuery("ul",element).fadeIn("fast")},function(){var element=this;jQuery("h2",element).css("background-position","");jQuery("ul",element).fadeOut("fast")})})};WYMeditor.SKINS.minimal={init:function(wym){jQuery(wym._box).find(wym._options.toolsSelector+", "+wym._options.containersSelector+", "+wym._options.classesSelector).addClass("wym_dropdown").selectify()}};"use strict";(function($){var Affix=function(element,options){this.options=$.extend({},$.fn.wymAffix.defaults,options);this.$window=$(window);this.$window.bind("scroll.affix.data-api",$.proxy(this.checkPosition,this));this.$window.bind("click.affix.data-api",$.proxy(function(){setTimeout($.proxy(this.checkPosition,this),1)},this));this.$element=$(element);this.checkPosition()};Affix.prototype.checkPosition=function(){var scrollTop=this.$window.scrollTop(),offset=this.options.offset,offsetBottom=offset.bottom,offsetTop=offset.top,reset="affix affix-top affix-bottom",desiredAffixType,isBelowTop=true,isAboveBottom=true;if(typeof offset!=="object"){offsetBottom=offsetTop=offset}if(typeof offsetTop==="function"){offsetTop=offset.top()}if(typeof offsetBottom==="function"){offsetBottom=offset.bottom()}if(offsetTop!==null){isBelowTop=scrollTop>offsetTop}if(offsetBottom!==null){isAboveBottom=scrollTop+this.$element.height()<offsetBottom}if(isBelowTop&&isAboveBottom){desiredAffixType="affix"}else if(isAboveBottom===false){desiredAffixType="affix-bottom"}else{desiredAffixType="affix-top"}if(this.currentAffixType===desiredAffixType){return}this.$element.removeClass(reset).addClass(desiredAffixType);this.currentAffixType=desiredAffixType};$.fn.wymAffix=function(option){var $elements=this;return $elements.each(function(){var element=this,$element=$(element),data=$element.data("affix"),options=typeof option==="object"&&option;if(!data){$element.data("affix",data=new Affix(element,options))}if(typeof option==="string"){data[option]()}})};$.fn.wymAffix.Constructor=Affix;$.fn.wymAffix.defaults={offset:0}})(jQuery);WYMeditor.SKINS.seamless={OPTS:{iframeHtml:["",'<div class="wym_iframe wym_section">','<iframe src="'+WYMeditor.IFRAME_BASE_PATH+'wymiframe.html" ','frameborder="0" ','border="0" ','scrolling="no" ','marginheight="0px" ','marginwidth="0px" ',">","</iframe>","</div>"].join(""),initIframeCheckFrequency:50,imagesLoadedCheckFrequency:300,imagesLoadedCheckTimeout:5e3},init:function(wym){var This=WYMeditor.SKINS.seamless;if(!Date.now){Date.now=function now(){return(new Date).getTime()}}wym.seamlessSkinOpts=jQuery.extend(This.OPTS,{initialIframeResizeTimer:null,resizeAfterImagesLoadTimer:null,_imagesLoadedCheckStartedTime:0,minimumHeight:jQuery(wym.element).height()});This.initUIChrome(wym);jQuery(wym.element).bind(WYMeditor.EVENTS.postIframeInitialization,This.postIframeInit)},postIframeInit:function(e,wym){var This=WYMeditor.SKINS.seamless;This.resizeIframeOnceBodyExists(wym);jQuery(wym.element).bind(WYMeditor.EVENTS.postBlockMaybeCreated,function(){This.resizeAndScrollIfNeeded(wym)})},initUIChrome:function(wym){var This=WYMeditor.SKINS.seamless,$dropdowns=jQuery([wym._options.containersSelector,wym._options.classesSelector].join(", "),wym._box),$toolbar,$areaTop;$areaTop=jQuery("div.wym_area_top",wym._box);$dropdowns.appendTo($areaTop);$dropdowns.addClass("wym_dropdown");jQuery(".wym_dropdown",wym._box).click(function(){var dropDown=this;jQuery(dropDown).toggleClass("hover")});$toolbar=jQuery(wym._options.toolsSelector,wym._box);$toolbar.addClass("wym_buttons");This.affixTopControls(wym)},affixTopControls:function(wym){var $areaTop,$offsetWrapper,earlyScrollPixels=5,usePlaceholderWidth,$placeholder;$areaTop=jQuery("div.wym_area_top",wym._box);$offsetWrapper=jQuery('<div class="wym_skin_seamless wym_area_top_wrapper">');$areaTop.wrap($offsetWrapper);$offsetWrapper=$areaTop.parent();$offsetWrapper.wrap('<div class="wym_area_top_affix_placeholder">');$placeholder=$offsetWrapper.parent();$placeholder.height($areaTop.height());usePlaceholderWidth=function(){$offsetWrapper.width($placeholder.width())};usePlaceholderWidth();jQuery(window).resize(usePlaceholderWidth);$offsetWrapper.wymAffix({offset:{top:function(){return $placeholder.offset().top-earlyScrollPixels},bottom:function(){return $placeholder.offset().top+wym.seamlessSkinIframeHeight}}})},resizeIframeOnceBodyExists:function(wym){var This=WYMeditor.SKINS.seamless,scrollHeightCalcFix;if(wym.seamlessSkinOpts.initialIframeResizeTimer){window.clearTimeout(wym.seamlessSkinOpts.initialIframeResizeTimer);wym.seamlessSkinOpts.initialIframeResizeTimer=null}if(typeof wym._doc.body==="undefined"||wym._doc.body===null){wym.seamlessSkinOpts.initialIframeResizeTimer=window.setTimeout(function(){This.resizeIframeOnceBodyExists(wym)},wym.seamlessSkinOpts.initIframeCheckFrequency);return}scrollHeightCalcFix=wym._doc.body.scrollHeight;This.resizeIframe(wym);This.resizeIframeOnceImagesLoaded(wym)},resizeIframeOnceImagesLoaded:function(wym){var This=WYMeditor.SKINS.seamless,images,imagesLength,i=0,allImagesLoaded=true,skinOpts=wym.seamlessSkinOpts,timeWaited;if(typeof skinOpts._imagesLoadedCheckStartedTime==="undefined"||skinOpts._imagesLoadedCheckStartedTime===0){skinOpts._imagesLoadedCheckStartedTime=Date.now()}if(skinOpts.resizeAfterImagesLoadTimer!==null){window.clearTimeout(skinOpts.resizeAfterImagesLoadTimer);skinOpts.resizeAfterImagesLoadTimer=null}images=wym.$body().find("img");imagesLength=images.length;if(imagesLength===0){return}for(i=0;i<imagesLength;i+=1){if(!This._imageIsLoaded(images[i])){allImagesLoaded=false;break}}This.resizeAndScrollIfNeeded(wym);if(allImagesLoaded===true){skinOpts._imagesLoadedCheckStartedTime=0;return}timeWaited=Date.now()-skinOpts._imagesLoadedCheckStartedTime;if(timeWaited>skinOpts.imagesLoadedCheckTimeout){skinOpts._imagesLoadedCheckStartedTime=0;return}skinOpts.resizeAfterImagesLoadTimer=window.setTimeout(function(){This.resizeIframeOnceImagesLoaded(wym)},skinOpts.imagesLoadedCheckFrequency)},_imageIsLoaded:function(img){if(img.complete!==true){return false}if(typeof img.naturalWidth!=="undefined"&&img.naturalWidth===0){return false}return true},_getIframeHeightStrategy:function(wym){var bodyScrollHeight,$htmlElement,htmlElementHeight,htmlElementScrollHeight,heightStrategy;$htmlElement=jQuery(wym._doc).children().eq(0);bodyScrollHeight=wym._doc.body.scrollHeight;htmlElementHeight=$htmlElement.height();htmlElementScrollHeight=$htmlElement[0].scrollHeight;if(WYMeditor.isInternetExplorerPre11()){heightStrategy=function(wym){var $htmlElement=jQuery(wym._doc).children().eq(0),htmlElementScrollHeight=$htmlElement[0].scrollHeight;return htmlElementScrollHeight-10};return heightStrategy}else if(htmlElementHeight>=bodyScrollHeight){heightStrategy=function(wym){var $htmlElement=jQuery(wym._doc).children().eq(0),htmlElementHeight=$htmlElement.height();return htmlElementHeight};return heightStrategy}else if(bodyScrollHeight>htmlElementScrollHeight){heightStrategy=function(wym){return wym._doc.body.scrollHeight};return heightStrategy}else{throw new Error("unsupported browser")}},resizeIframe:function(wym){var This=WYMeditor.SKINS.seamless,desiredHeight,$iframe=jQuery(wym._iframe),currentHeight=$iframe.height();if(typeof WYMeditor.IFRAME_HEIGHT_GETTER==="undefined"){WYMeditor.IFRAME_HEIGHT_GETTER=This._getIframeHeightStrategy(wym)}desiredHeight=WYMeditor.IFRAME_HEIGHT_GETTER(wym);if(desiredHeight<wym.seamlessSkinOpts.minimumHeight){desiredHeight=wym.seamlessSkinOpts.minimumHeight}if(currentHeight!==desiredHeight){$iframe.height(desiredHeight);wym.seamlessSkinIframeHeight=desiredHeight;return true}return false},scrollIfNeeded:function(wym){var iframeOffset=jQuery(wym._iframe).offset(),iframeOffsetTop=iframeOffset.top,$container=jQuery(wym.selectedContainer()),containerOffset=$container.offset(),viewportLowestY,containerLowestY,newScrollTop,extraScroll=20,scrollDiff,$window=jQuery(window),$body=jQuery(document.body);if($container.length===0){return}containerLowestY=iframeOffsetTop+containerOffset.top;containerLowestY+=$container.outerHeight();viewportLowestY=$window.scrollTop()+$window.height();scrollDiff=containerLowestY-viewportLowestY;if(scrollDiff>0){newScrollTop=$body.scrollTop()+scrollDiff+extraScroll;$body.scrollTop(newScrollTop)}},resizeAndScrollIfNeeded:function(wym){var This=WYMeditor.SKINS.seamless,resizeOccurred=This.resizeIframe(wym);if(resizeOccurred!==true){return}This.scrollIfNeeded(wym)}};jQuery.fn.selectify=function(){var $elements=this;return $elements.each(function(){var element=this;jQuery(element).hover(function(){var element=this;jQuery("h2",element).css("background-position","0px -18px");jQuery("ul",element).fadeIn("fast")},function(){var element=this;jQuery("h2",element).css("background-position","");jQuery("ul",element).fadeOut("fast")})})};WYMeditor.SKINS.silver={init:function(wym){jQuery(wym._box).append('<div class="clear"></div>').wrapInner('<div class="wym_inner"></div>');jQuery(wym._box).find(wym._options.classesSelector).addClass("wym_panel");jQuery(wym._box).find(wym._options.toolsSelector).addClass("wym_buttons");jQuery(wym._box).find(wym._options.containersSelector).addClass("wym_dropdown").selectify();jQuery(wym._box).find("div.wym_area_right ul").parents("div.wym_area_right").show().parents(wym._options.boxSelector).find("div.wym_area_main").css({"margin-right":"155px"});jQuery(wym._box).find("div.wym_area_left ul").parents("div.wym_area_left").show().parents(wym._options.boxSelector).find("div.wym_area_main").css({"margin-left":"155px"});jQuery(wym._box).find(".wym_section").hover(function(){var section=this;jQuery(section).addClass("hover")},function(){var section=this;jQuery(section).removeClass("hover")})}};WYMeditor.SKINS.twopanels={init:function(wym){jQuery(wym._box).find(wym._options.containersSelector).appendTo("div.wym_area_left");jQuery(wym._box).find(wym._options.classesSelector+", "+wym._options.containersSelector).addClass("wym_panel");jQuery(wym._box).find(wym._options.toolsSelector).addClass("wym_buttons");jQuery(wym._box).find("div.wym_area_right ul").parents("div.wym_area_right").show().parents(wym._options.boxSelector).find("div.wym_area_main").css({"margin-right":"155px"});jQuery(wym._box).find("div.wym_area_left ul").parents("div.wym_area_left").show().parents(wym._options.boxSelector).find("div.wym_area_main").css({"margin-left":"115px"});jQuery(wym._box).find(".wym_section").hover(function(){jQuery(this).addClass("hover")},function(){jQuery(this).removeClass("hover")})}};
